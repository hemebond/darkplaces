<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DarkPlaces: crypto.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-customisations.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="darkplaces48x48.png"/></td>
  <td id="projectalign">
   <div id="projectname">DarkPlaces
   </div>
   <div id="projectbrief">Game engine based on the Quake 1 engine by id Software, developed by LadyHavoc</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('crypto_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">crypto.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &quot;<a class="el" href="qtypes_8h_source.html">qtypes.h</a>&quot;</code><br />
</div>
<p><a href="crypto_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__t.html">crypto_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae8ba301eab3a8d66c5585d59d03229cc" id="r_ae8ba301eab3a8d66c5585d59d03229cc"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ae8ba301eab3a8d66c5585d59d03229cc">ENCRYPTION_REQUIRED</a>&#160;&#160;&#160;(crypto_aeslevel.integer &gt;= 3)</td></tr>
<tr class="separator:ae8ba301eab3a8d66c5585d59d03229cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243fd02f64d57160121c22fabedaac9d" id="r_a243fd02f64d57160121c22fabedaac9d"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a243fd02f64d57160121c22fabedaac9d">CRYPTO_HEADERSIZE</a>&#160;&#160;&#160;31</td></tr>
<tr class="separator:a243fd02f64d57160121c22fabedaac9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b284ff4c80ff5aa9f0b4ee842a33d44" id="r_a5b284ff4c80ff5aa9f0b4ee842a33d44"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>&#160;&#160;&#160;44</td></tr>
<tr class="separator:a5b284ff4c80ff5aa9f0b4ee842a33d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9de82069262439e7e921069abb457c1" id="r_ad9de82069262439e7e921069abb457c1"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ad9de82069262439e7e921069abb457c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c7ff8f693d7a32873476640d01ecef3" id="r_a8c7ff8f693d7a32873476640d01ecef3"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a8c7ff8f693d7a32873476640d01ecef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd8c06f696b570063fbead2f98c7c2c" id="r_a4bd8c06f696b570063fbead2f98c7c2c"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a4bd8c06f696b570063fbead2f98c7c2c">CRYPTO_MATCH</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a4bd8c06f696b570063fbead2f98c7c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1efd20cc345410a8f68978ece41aac10" id="r_a1efd20cc345410a8f68978ece41aac10"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a1efd20cc345410a8f68978ece41aac10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d9f8e2afed02501c245a07309bd656c" id="r_a6d9f8e2afed02501c245a07309bd656c"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a6d9f8e2afed02501c245a07309bd656c">CRYPTO_REPLACE</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a6d9f8e2afed02501c245a07309bd656c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac8e05ee4f38d1d5a579abfe2980e370f" id="r_ac8e05ee4f38d1d5a579abfe2980e370f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac8e05ee4f38d1d5a579abfe2980e370f">Crypto_Init</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:ac8e05ee4f38d1d5a579abfe2980e370f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc22d3a48652b22d43fb40e750e4cd4" id="r_a2dc22d3a48652b22d43fb40e750e4cd4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a2dc22d3a48652b22d43fb40e750e4cd4">Crypto_Init_Commands</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a2dc22d3a48652b22d43fb40e750e4cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6cc26fc4d71eacae07453774cf06de" id="r_a1e6cc26fc4d71eacae07453774cf06de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a1e6cc26fc4d71eacae07453774cf06de">Crypto_LoadKeys</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a1e6cc26fc4d71eacae07453774cf06de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55a704ba907e52ab40b463e8dcdee49" id="r_aa55a704ba907e52ab40b463e8dcdee49"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aa55a704ba907e52ab40b463e8dcdee49">Crypto_Shutdown</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:aa55a704ba907e52ab40b463e8dcdee49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1846f2fe5c20c0a720498ab004a620b" id="r_af1846f2fe5c20c0a720498ab004a620b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af1846f2fe5c20c0a720498ab004a620b">Crypto_Available</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:af1846f2fe5c20c0a720498ab004a620b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61b0d8e49d857cf554e5db8c601c2be4" id="r_a61b0d8e49d857cf554e5db8c601c2be4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a61b0d8e49d857cf554e5db8c601c2be4">sha256</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *in, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>)</td></tr>
<tr class="separator:a61b0d8e49d857cf554e5db8c601c2be4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f0f56ef0e8867e2bae48ad0c12eb7c" id="r_a31f0f56ef0e8867e2bae48ad0c12eb7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a31f0f56ef0e8867e2bae48ad0c12eb7c">Crypto_EncryptPacket</a> (<a class="el" href="structcrypto__t.html">crypto_t</a> *crypto, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:a31f0f56ef0e8867e2bae48ad0c12eb7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5edc59e776eb84e8d80fd7a1c83e7973" id="r_a5edc59e776eb84e8d80fd7a1c83e7973"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5edc59e776eb84e8d80fd7a1c83e7973">Crypto_DecryptPacket</a> (<a class="el" href="structcrypto__t.html">crypto_t</a> *crypto, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:a5edc59e776eb84e8d80fd7a1c83e7973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b4969371415991b42f94cc5c82838a" id="r_a29b4969371415991b42f94cc5c82838a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a29b4969371415991b42f94cc5c82838a">Crypto_ClientParsePacket</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">peeraddressstring</a>)</td></tr>
<tr class="separator:a29b4969371415991b42f94cc5c82838a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace1b41f4cd5100f173da25da7f726a8f" id="r_ace1b41f4cd5100f173da25da7f726a8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ace1b41f4cd5100f173da25da7f726a8f">Crypto_ServerParsePacket</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress)</td></tr>
<tr class="separator:ace1b41f4cd5100f173da25da7f726a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a993fe4230d29c0de65f62c472d679cd0" id="r_a993fe4230d29c0de65f62c472d679cd0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a993fe4230d29c0de65f62c472d679cd0">Crypto_ServerAppendToChallenge</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxlen</a>)</td></tr>
<tr class="separator:a993fe4230d29c0de65f62c472d679cd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141f05b8ac8247937791bff8aa8ccd37" id="r_a141f05b8ac8247937791bff8aa8ccd37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a141f05b8ac8247937791bff8aa8ccd37">Crypto_ServerGetInstance</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lhnetaddress_s</a> *peeraddress)</td></tr>
<tr class="separator:a141f05b8ac8247937791bff8aa8ccd37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92f36accfee208af75781980dea33821" id="r_a92f36accfee208af75781980dea33821"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a92f36accfee208af75781980dea33821">Crypto_FinishInstance</a> (<a class="el" href="structcrypto__t.html">crypto_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, <a class="el" href="structcrypto__t.html">crypto_t</a> *in)</td></tr>
<tr class="separator:a92f36accfee208af75781980dea33821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a13832c196fc6cb7e25fd6f55aa489" id="r_ae0a13832c196fc6cb7e25fd6f55aa489"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ae0a13832c196fc6cb7e25fd6f55aa489">Crypto_GetInfoResponseDataString</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:ae0a13832c196fc6cb7e25fd6f55aa489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adce90efb7c4830b9935bb56bef65b877" id="r_adce90efb7c4830b9935bb56bef65b877"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#adce90efb7c4830b9935bb56bef65b877">Crypto_RetrieveHostKey</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lhnetaddress_s</a> *peeraddress, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *keyid, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfplen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *idfp, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idfplen</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *aeslevel, <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> *issigned)</td></tr>
<tr class="separator:adce90efb7c4830b9935bb56bef65b877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530db18ab03fe35200fa035277bc9b03" id="r_a530db18ab03fe35200fa035277bc9b03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a530db18ab03fe35200fa035277bc9b03">Crypto_RetrieveLocalKey</a> (<a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> keyid, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfplen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *idfp, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idfplen</a>, <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> *issigned)</td></tr>
<tr class="separator:a530db18ab03fe35200fa035277bc9b03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6808cc09c495f2c6eb4bdf1eedbd68" id="r_a3f6808cc09c495f2c6eb4bdf1eedbd68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a3f6808cc09c495f2c6eb4bdf1eedbd68">Crypto_SignData</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">datasize</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> keyid, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>)</td></tr>
<tr class="separator:a3f6808cc09c495f2c6eb4bdf1eedbd68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad247271fff8b625706df45f83222d8ba" id="r_ad247271fff8b625706df45f83222d8ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ad247271fff8b625706df45f83222d8ba">Crypto_SignDataDetached</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">datasize</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> keyid, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>)</td></tr>
<tr class="separator:ad247271fff8b625706df45f83222d8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afb9c67c616e7381a63de5023be2b9fc0" id="r_afb9c67c616e7381a63de5023be2b9fc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cvar_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#afb9c67c616e7381a63de5023be2b9fc0">crypto_developer</a></td></tr>
<tr class="separator:afb9c67c616e7381a63de5023be2b9fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9838f94945170d03aedfdcff10395f5" id="r_af9838f94945170d03aedfdcff10395f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cvar_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af9838f94945170d03aedfdcff10395f5">crypto_aeslevel</a></td></tr>
<tr class="separator:af9838f94945170d03aedfdcff10395f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28bce26dd18684379882653e173b0188" id="r_a28bce26dd18684379882653e173b0188"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a></td></tr>
<tr class="separator:a28bce26dd18684379882653e173b0188"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1efd20cc345410a8f68978ece41aac10" name="a1efd20cc345410a8f68978ece41aac10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1efd20cc345410a8f68978ece41aac10">&#9670;&#160;</a></span>CRYPTO_DISCARD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTO_DISCARD&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00066">66</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a243fd02f64d57160121c22fabedaac9d" name="a243fd02f64d57160121c22fabedaac9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a243fd02f64d57160121c22fabedaac9d">&#9670;&#160;</a></span>CRYPTO_HEADERSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTO_HEADERSIZE&#160;&#160;&#160;31</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00034">34</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a4bd8c06f696b570063fbead2f98c7c2c" name="a4bd8c06f696b570063fbead2f98c7c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bd8c06f696b570063fbead2f98c7c2c">&#9670;&#160;</a></span>CRYPTO_MATCH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTO_MATCH&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00065">65</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a8c7ff8f693d7a32873476640d01ecef3" name="a8c7ff8f693d7a32873476640d01ecef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c7ff8f693d7a32873476640d01ecef3">&#9670;&#160;</a></span>CRYPTO_NOMATCH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTO_NOMATCH&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00064">64</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a6d9f8e2afed02501c245a07309bd656c" name="a6d9f8e2afed02501c245a07309bd656c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d9f8e2afed02501c245a07309bd656c">&#9670;&#160;</a></span>CRYPTO_REPLACE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTO_REPLACE&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00067">67</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="ad9de82069262439e7e921069abb457c1" name="ad9de82069262439e7e921069abb457c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9de82069262439e7e921069abb457c1">&#9670;&#160;</a></span>DHKEY_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> DHKEY_SIZE&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00039">39</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="ae8ba301eab3a8d66c5585d59d03229cc" name="ae8ba301eab3a8d66c5585d59d03229cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8ba301eab3a8d66c5585d59d03229cc">&#9670;&#160;</a></span>ENCRYPTION_REQUIRED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> ENCRYPTION_REQUIRED&#160;&#160;&#160;(crypto_aeslevel.integer &gt;= 3)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00030">30</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a5b284ff4c80ff5aa9f0b4ee842a33d44" name="a5b284ff4c80ff5aa9f0b4ee842a33d44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b284ff4c80ff5aa9f0b4ee842a33d44">&#9670;&#160;</a></span>FP64_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FP64_SIZE&#160;&#160;&#160;44</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00038">38</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="af1846f2fe5c20c0a720498ab004a620b" name="af1846f2fe5c20c0a720498ab004a620b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1846f2fe5c20c0a720498ab004a620b">&#9670;&#160;</a></span>Crypto_Available()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_Available </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01097">1097</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1098</span>{</div>
<div class="line"><span class="lineno"> 1099</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1100</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1101</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1102</span>}</div>
<div class="ttc" id="acrypto_8c_html_a630ddbca1d559d1a461a73a5cf7851e0"><div class="ttname"><a href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a></div><div class="ttdeci">static dllhandle_t d0_blind_id_dll</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00282">crypto.c:282</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="prvm__cmds_8c_source.html#l00323">checkextension()</a>, and <a class="el" href="prvm__cmds_8c_source.html#l05193">VM_digest_hex()</a>.</p>

</div>
</div>
<a id="a29b4969371415991b42f94cc5c82838a" name="a29b4969371415991b42f94cc5c82838a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29b4969371415991b42f94cc5c82838a">&#9670;&#160;</a></span>Crypto_ClientParsePacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_ClientParsePacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>peeraddressstring</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02107">2107</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2108</span>{</div>
<div class="line"><span class="lineno"> 2109</span>    <a class="code hl_struct" href="structcrypto__t.html">crypto_t</a> *crypto = &amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a6b1b21c226c99c9d1e972dc080ee1855">crypto</a>;</div>
<div class="line"><span class="lineno"> 2110</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>;</div>
<div class="line"><span class="lineno"> 2111</span>    <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a>;</div>
<div class="line"><span class="lineno"> 2112</span>    <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2113</span>    <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno"> 2114</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>[<a class="code hl_define" href="qdefs_8h.html#a119f8457078d7390fb45ea0838adb806">MAX_INPUTLINE</a>];</div>
<div class="line"><span class="lineno"> 2115</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno"> 2116</span> </div>
<div class="line"><span class="lineno"> 2117</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 2118</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>; <span class="comment">// no support</span></div>
<div class="line"><span class="lineno"> 2119</span> </div>
<div class="line"><span class="lineno"> 2120</span>    <span class="comment">// if &quot;challenge&quot;: verify challenge, and discard message, send next crypto protocol message instead</span></div>
<div class="line"><span class="lineno"> 2121</span>    <span class="comment">// otherwise, just handle actual protocol messages</span></div>
<div class="line"><span class="lineno"> 2122</span> </div>
<div class="line"><span class="lineno"> 2123</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> == 6 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;accept&quot;</span>, 6) &amp;&amp; <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">connect_trying</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>)</div>
<div class="line"><span class="lineno"> 2124</span>    {</div>
<div class="line"><span class="lineno"> 2125</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> = -1;</div>
<div class="line"><span class="lineno"> 2126</span>        <a class="code hl_function" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2127</span>        <span class="keywordflow">if</span>(!crypto || !crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a>) <span class="comment">// we ALSO get here if we are using an encrypted connection, so let&#39;s rule this out</span></div>
<div class="line"><span class="lineno"> 2128</span>        {</div>
<div class="line"><span class="lineno"> 2129</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2130</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though a host key is present&quot;</span>);</div>
<div class="line"><span class="lineno"> 2131</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2132</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2133</span>        }</div>
<div class="line"><span class="lineno"> 2134</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2135</span>    }</div>
<div class="line"><span class="lineno"> 2136</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 1 &amp;&amp; <span class="keywordtype">string</span>[0] == <span class="charliteral">&#39;j&#39;</span> &amp;&amp; <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">connect_trying</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>)</div>
<div class="line"><span class="lineno"> 2137</span>    {</div>
<div class="line"><span class="lineno"> 2138</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> = -1;</div>
<div class="line"><span class="lineno"> 2139</span>        <a class="code hl_function" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2140</span>        <span class="comment">//if(!crypto || !crypto-&gt;authenticated)</span></div>
<div class="line"><span class="lineno"> 2141</span>        {</div>
<div class="line"><span class="lineno"> 2142</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2143</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though a host key is present&quot;</span>);</div>
<div class="line"><span class="lineno"> 2144</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2145</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2146</span>        }</div>
<div class="line"><span class="lineno"> 2147</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2148</span>    }</div>
<div class="line"><span class="lineno"> 2149</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 5 &amp;&amp; <a class="code hl_function" href="com__msg_8c.html#a9375c7a4c8e2a5785acd5a71078378bb">BuffLittleLong</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="keywordtype">string</span>) == ((<span class="keywordtype">int</span>)<a class="code hl_define" href="netconn_8h.html#a292ee6efb14953f64ea03ddd1988b202">NETFLAG_CTL</a> | (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>))</div>
<div class="line"><span class="lineno"> 2150</span>    {</div>
<div class="line"><span class="lineno"> 2151</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> = -1;</div>
<div class="line"><span class="lineno"> 2152</span> </div>
<div class="line"><span class="lineno"> 2153</span>        <span class="comment">// these three are harmless</span></div>
<div class="line"><span class="lineno"> 2154</span>        <span class="keywordflow">if</span>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <span class="keywordtype">string</span>[4] == <a class="code hl_define" href="netconn_8h.html#a06ea659d8515a7837b0d743942d5b2ca">CCREP_SERVER_INFO</a>)</div>
<div class="line"><span class="lineno"> 2155</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2156</span>        <span class="keywordflow">if</span>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <span class="keywordtype">string</span>[4] == <a class="code hl_define" href="netconn_8h.html#a3bf085f22c8f4adbf3c06885f528ea82">CCREP_PLAYER_INFO</a>)</div>
<div class="line"><span class="lineno"> 2157</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2158</span>        <span class="keywordflow">if</span>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <span class="keywordtype">string</span>[4] == <a class="code hl_define" href="netconn_8h.html#aa34599ce347c884f29a05f2040fcab24">CCREP_RULE_INFO</a>)</div>
<div class="line"><span class="lineno"> 2159</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2160</span> </div>
<div class="line"><span class="lineno"> 2161</span>        <a class="code hl_function" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2162</span>        <span class="comment">//if(!crypto || !crypto-&gt;authenticated)</span></div>
<div class="line"><span class="lineno"> 2163</span>        {</div>
<div class="line"><span class="lineno"> 2164</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2165</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though a host key is present&quot;</span>);</div>
<div class="line"><span class="lineno"> 2166</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2167</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2168</span>        }</div>
<div class="line"><span class="lineno"> 2169</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2170</span>    }</div>
<div class="line"><span class="lineno"> 2171</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 13 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;infoResponse\x0A&quot;</span>, 13))</div>
<div class="line"><span class="lineno"> 2172</span>    {</div>
<div class="line"><span class="lineno"> 2173</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 13, <span class="stringliteral">&quot;d0_blind_id&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 2174</span>            <a class="code hl_function" href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a>(peeraddress, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2175</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2176</span>    }</div>
<div class="line"><span class="lineno"> 2177</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 15 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;statusResponse\x0A&quot;</span>, 15))</div>
<div class="line"><span class="lineno"> 2178</span>    {</div>
<div class="line"><span class="lineno"> 2179</span>        <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">save</a> = 0;</div>
<div class="line"><span class="lineno"> 2180</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"><span class="lineno"> 2181</span>        p = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strchr</a>(<span class="keywordtype">string</span> + 15, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><span class="lineno"> 2182</span>        <span class="keywordflow">if</span>(p)</div>
<div class="line"><span class="lineno"> 2183</span>        {</div>
<div class="line"><span class="lineno"> 2184</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">save</a> = *p;</div>
<div class="line"><span class="lineno"> 2185</span>            * (<span class="keywordtype">char</span> *) p = 0; <span class="comment">// cut off the string there</span></div>
<div class="line"><span class="lineno"> 2186</span>        }</div>
<div class="line"><span class="lineno"> 2187</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 15, <span class="stringliteral">&quot;d0_blind_id&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 2188</span>            <a class="code hl_function" href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a>(peeraddress, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2189</span>        <span class="keywordflow">if</span>(p)</div>
<div class="line"><span class="lineno"> 2190</span>        {</div>
<div class="line"><span class="lineno"> 2191</span>            * (<span class="keywordtype">char</span> *) p = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">save</a>;</div>
<div class="line"><span class="lineno"> 2192</span>            <span class="comment">// invoking those nasal demons again (do not run this on the DS9k)</span></div>
<div class="line"><span class="lineno"> 2193</span>        }</div>
<div class="line"><span class="lineno"> 2194</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2195</span>    }</div>
<div class="line"><span class="lineno"> 2196</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt; 10 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;challenge &quot;</span>, 10) &amp;&amp; <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">connect_trying</a>)</div>
<div class="line"><span class="lineno"> 2197</span>    {</div>
<div class="line"><span class="lineno"> 2198</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vlen_blind_id_ptr</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 2199</span>        <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_blind_id_ptr</a> = 0;</div>
<div class="line"><span class="lineno"> 2200</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>, <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>;</div>
<div class="line"><span class="lineno"> 2201</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *challenge = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> + 10;</div>
<div class="line"><span class="lineno"> 2202</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"><span class="lineno"> 2203</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 2204</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> = -1, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> = -1, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> = -1;</div>
<div class="line"><span class="lineno"> 2205</span>        <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">server_can_auth</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2206</span>        <span class="keywordtype">char</span> wantserver_idfp[<a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1];</div>
<div class="line"><span class="lineno"> 2207</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> = 0;</div>
<div class="line"><span class="lineno"> 2208</span>        <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> wantserver_issigned = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2209</span> </div>
<div class="line"><span class="lineno"> 2210</span>        <span class="comment">// Must check the source IP here, if we want to prevent other servers&#39; replies from falsely advancing the crypto state, preventing successful connect to the real server.</span></div>
<div class="line"><span class="lineno"> 2211</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="crypto_8c.html#ae5918471d5570f5ecf0da17ecf0a253b">net_sourceaddresscheck</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &amp;&amp; <a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(peeraddress, &amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>))</div>
<div class="line"><span class="lineno"> 2212</span>        {</div>
<div class="line"><span class="lineno"> 2213</span>            <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>[128];</div>
<div class="line"><span class="lineno"> 2214</span> </div>
<div class="line"><span class="lineno"> 2215</span>            <a class="code hl_function" href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>), <span class="stringliteral">&quot;ignoring challenge message from wrong server %s&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">peeraddressstring</a>);</div>
<div class="line"><span class="lineno"> 2216</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>);</div>
<div class="line"><span class="lineno"> 2217</span>        }</div>
<div class="line"><span class="lineno"> 2218</span> </div>
<div class="line"><span class="lineno"> 2219</span>        <span class="comment">// if we have a stored host key for the server, assume serverid to already be selected!</span></div>
<div class="line"><span class="lineno"> 2220</span>        <span class="comment">// (the loop will refuse to overwrite this one then)</span></div>
<div class="line"><span class="lineno"> 2221</span>        wantserver_idfp[0] = 0;</div>
<div class="line"><span class="lineno"> 2222</span>        <a class="code hl_function" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, wantserver_idfp, <span class="keyword">sizeof</span>(wantserver_idfp), &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a>, &amp;wantserver_issigned);</div>
<div class="line"><span class="lineno"> 2223</span>        <span class="comment">// requirement: wantserver_idfp is a full ID if wantserverid set</span></div>
<div class="line"><span class="lineno"> 2224</span> </div>
<div class="line"><span class="lineno"> 2225</span>        <span class="comment">// if we leave, we have to consider the connection</span></div>
<div class="line"><span class="lineno"> 2226</span>        <span class="comment">// unauthenticated; NOTE: this may be faked by a clever</span></div>
<div class="line"><span class="lineno"> 2227</span>        <span class="comment">// attacker to force an unauthenticated connection; so we have</span></div>
<div class="line"><span class="lineno"> 2228</span>        <span class="comment">// a safeguard check in place when encryption is required too</span></div>
<div class="line"><span class="lineno"> 2229</span>        <span class="comment">// in place, or when authentication is required by the server</span></div>
<div class="line"><span class="lineno"> 2230</span>        crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2231</span> </div>
<div class="line"><span class="lineno"> 2232</span>        <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 2233</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>)</div>
<div class="line"><span class="lineno"> 2234</span>            <span class="keywordflow">return</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though a host key is present&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2235</span>                (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.integer &gt;= 3) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2236</span>                <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2237</span> </div>
<div class="line"><span class="lineno"> 2238</span>        <span class="comment">// FTEQW extension protocol</span></div>
<div class="line"><span class="lineno"> 2239</span>        <span class="keywordflow">while</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 8)</div>
<div class="line"><span class="lineno"> 2240</span>        {</div>
<div class="line"><span class="lineno"> 2241</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a> = <a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>);</div>
<div class="line"><span class="lineno"> 2242</span>            <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a> = <a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> + 4);</div>
<div class="line"><span class="lineno"> 2243</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> += 8;</div>
<div class="line"><span class="lineno"> 2244</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> -= 8;</div>
<div class="line"><span class="lineno"> 2245</span>            <span class="keywordflow">switch</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>)</div>
<div class="line"><span class="lineno"> 2246</span>            {</div>
<div class="line"><span class="lineno"> 2247</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="crypto_8c.html#a2ba1c091c9f8d31b8761c8c6c8e12a74">PROTOCOL_VLEN</a>:</div>
<div class="line"><span class="lineno"> 2248</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 4 + <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>)</div>
<div class="line"><span class="lineno"> 2249</span>                    {</div>
<div class="line"><span class="lineno"> 2250</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a> = <a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>);</div>
<div class="line"><span class="lineno"> 2251</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> += 4;</div>
<div class="line"><span class="lineno"> 2252</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> -= 4;</div>
<div class="line"><span class="lineno"> 2253</span>                        <span class="keywordflow">switch</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>)</div>
<div class="line"><span class="lineno"> 2254</span>                        {</div>
<div class="line"><span class="lineno"> 2255</span>                            <span class="keywordflow">case</span> <a class="code hl_define" href="crypto_8c.html#a415708eb37a2ec762abe53d4dac87ac0">PROTOCOL_D0_BLIND_ID</a>:</div>
<div class="line"><span class="lineno"> 2256</span>                                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vlen_blind_id_ptr</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>;</div>
<div class="line"><span class="lineno"> 2257</span>                                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_blind_id_ptr</a> = <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>;</div>
<div class="line"><span class="lineno"> 2258</span>                                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2259</span>                        }</div>
<div class="line"><span class="lineno"> 2260</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> += <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>;</div>
<div class="line"><span class="lineno"> 2261</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> -= <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>;</div>
<div class="line"><span class="lineno"> 2262</span>                    }</div>
<div class="line"><span class="lineno"> 2263</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2264</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2265</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2266</span>            }</div>
<div class="line"><span class="lineno"> 2267</span>        }</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vlen_blind_id_ptr</a>)</div>
<div class="line"><span class="lineno"> 2270</span>            <span class="keywordflow">return</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though authentication is required&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2271</span>                (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.integer &gt;= 3) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2272</span>                <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2273</span> </div>
<div class="line"><span class="lineno"> 2274</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vlen_blind_id_ptr</a>;</div>
<div class="line"><span class="lineno"> 2275</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_blind_id_ptr</a>;</div>
<div class="line"><span class="lineno"> 2276</span> </div>
<div class="line"><span class="lineno"> 2277</span>        <span class="comment">// parse fingerprints</span></div>
<div class="line"><span class="lineno"> 2278</span>        <span class="comment">//   once we found a fingerprint we can auth to (ANY), select it as clientfp</span></div>
<div class="line"><span class="lineno"> 2279</span>        <span class="comment">//   once we found a fingerprint in the first list that we know, select it as serverfp</span></div>
<div class="line"><span class="lineno"> 2280</span> </div>
<div class="line"><span class="lineno"> 2281</span>        <span class="keywordflow">for</span>(;;)</div>
<div class="line"><span class="lineno"> 2282</span>        {</div>
<div class="line"><span class="lineno"> 2283</span>            p = <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 2284</span>            <span class="keywordflow">if</span>(!p)</div>
<div class="line"><span class="lineno"> 2285</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2286</span>            <span class="keywordflow">if</span>(!*p)</div>
<div class="line"><span class="lineno"> 2287</span>            {</div>
<div class="line"><span class="lineno"> 2288</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">server_can_auth</a>)</div>
<div class="line"><span class="lineno"> 2289</span>                    <span class="keywordflow">break</span>; <span class="comment">// other protocol message may follow</span></div>
<div class="line"><span class="lineno"> 2290</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">server_can_auth</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2291</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2292</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2293</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2294</span>            }</div>
<div class="line"><span class="lineno"> 2295</span>            <span class="comment">// Find the highest numbered matching key for p.</span></div>
<div class="line"><span class="lineno"> 2296</span>            <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 2297</span>            {</div>
<div class="line"><span class="lineno"> 2298</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 2299</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(p, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><span class="lineno"> 2300</span>                {</div>
<div class="line"><span class="lineno"> 2301</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 2302</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 2303</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">server_can_auth</a>)</div>
<div class="line"><span class="lineno"> 2304</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &lt; 0 || <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>)</div>
<div class="line"><span class="lineno"> 2305</span>                            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 2306</span>                }</div>
<div class="line"><span class="lineno"> 2307</span>            }</div>
<div class="line"><span class="lineno"> 2308</span>            <span class="comment">// Not breaking, as higher keys in the list always have priority.</span></div>
<div class="line"><span class="lineno"> 2309</span>        }</div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span>        <span class="comment">// if stored host key is not found:</span></div>
<div class="line"><span class="lineno"> 2312</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0 &amp;&amp; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 2313</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server CA does not match stored host key, refusing to connect&quot;</span>);</div>
<div class="line"><span class="lineno"> 2314</span> </div>
<div class="line"><span class="lineno"> 2315</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &gt;= 0 || <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2316</span>        {</div>
<div class="line"><span class="lineno"> 2317</span>            <a class="code hl_define" href="crypto_8c.html#a9e2d859ffde566232fcd3e099be1acc9">MAKE_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2318</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id = ++<a class="code hl_variable" href="crypto_8c.html#a09ddfceaa9b1578f414a3e3408ce7ea1">cdata_id</a>;</div>
<div class="line"><span class="lineno"> 2319</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a>;</div>
<div class="line"><span class="lineno"> 2320</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a>;</div>
<div class="line"><span class="lineno"> 2321</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, 0, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>));</div>
<div class="line"><span class="lineno"> 2322</span>            <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;challenge, challenge, <span class="keyword">sizeof</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;challenge));</div>
<div class="line"><span class="lineno"> 2323</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 2324</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 2325</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 2326</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 2327</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp, wantserver_idfp, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>));</div>
<div class="line"><span class="lineno"> 2328</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_issigned = wantserver_issigned;</div>
<div class="line"><span class="lineno"> 2329</span> </div>
<div class="line"><span class="lineno"> 2330</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp[0]) <span class="comment">// if we know a host key, honor its encryption setting</span></div>
<div class="line"><span class="lineno"> 2331</span>            <span class="keywordflow">switch</span>(<a class="code hl_define" href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a>(0, <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> ? <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> : 0, 3))</div>
<div class="line"><span class="lineno"> 2332</span>            {</div>
<div class="line"><span class="lineno"> 2333</span>                <span class="keywordflow">default</span>: <span class="comment">// dummy, never happens, but to make gcc happy...</span></div>
<div class="line"><span class="lineno"> 2334</span>                <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno"> 2335</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2336</span>                        <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2337</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2338</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2339</span>                <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno"> 2340</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes = (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &gt;= 2);</div>
<div class="line"><span class="lineno"> 2341</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2342</span>                <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno"> 2343</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes = (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &gt;= 1);</div>
<div class="line"><span class="lineno"> 2344</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2345</span>                <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno"> 2346</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &lt;= 0)</div>
<div class="line"><span class="lineno"> 2347</span>                        <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be supported (crypto_aeslevel &gt;= 1, and d0_rijndael library must be present)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2348</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2349</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2350</span>            }</div>
<div class="line"><span class="lineno"> 2351</span> </div>
<div class="line"><span class="lineno"> 2352</span>            <span class="comment">// build outgoing message</span></div>
<div class="line"><span class="lineno"> 2353</span>            <span class="comment">// append regular stuff</span></div>
<div class="line"><span class="lineno"> 2354</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\0\\id\\%d\\aeslevel\\%d\\challenge\\%s&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id, <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> ? <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> : 0, challenge));</div>
<div class="line"><span class="lineno"> 2355</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &gt;= 0 ? <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a>] : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2356</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &gt;= 0 ? <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a>] : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2357</span> </div>
<div class="line"><span class="lineno"> 2358</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2359</span>            {</div>
<div class="line"><span class="lineno"> 2360</span>                <span class="comment">// I am the client, and my key is ok... so let&#39;s set client_keyfp and client_idfp</span></div>
<div class="line"><span class="lineno"> 2361</span>                <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>));</div>
<div class="line"><span class="lineno"> 2362</span>                <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>));</div>
<div class="line"><span class="lineno"> 2363</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad0f40ef405fc08dcc50822d8183a6d30">client_issigned</a> = <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c];</div>
<div class="line"><span class="lineno"> 2364</span>            }</div>
<div class="line"><span class="lineno"> 2365</span> </div>
<div class="line"><span class="lineno"> 2366</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2367</span>            {</div>
<div class="line"><span class="lineno"> 2368</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 2369</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id = <a class="code hl_variable" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a>();</div>
<div class="line"><span class="lineno"> 2370</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 2371</span>                {</div>
<div class="line"><span class="lineno"> 2372</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2373</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_new failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2374</span>                }</div>
<div class="line"><span class="lineno"> 2375</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s]))</div>
<div class="line"><span class="lineno"> 2376</span>                {</div>
<div class="line"><span class="lineno"> 2377</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2378</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2379</span>                }</div>
<div class="line"><span class="lineno"> 2380</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 1;</div>
<div class="line"><span class="lineno"> 2381</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2382</span>            }</div>
<div class="line"><span class="lineno"> 2383</span>            <span class="keywordflow">else</span> <span class="comment">// if(clientid &gt;= 0) // guaranteed by condition one level outside</span></div>
<div class="line"><span class="lineno"> 2384</span>            {</div>
<div class="line"><span class="lineno"> 2385</span>                <span class="comment">// skip over server auth, perform client auth only</span></div>
<div class="line"><span class="lineno"> 2386</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 2387</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id = <a class="code hl_variable" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a>();</div>
<div class="line"><span class="lineno"> 2388</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 2389</span>                {</div>
<div class="line"><span class="lineno"> 2390</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2391</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_new failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2392</span>                }</div>
<div class="line"><span class="lineno"> 2393</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c]))</div>
<div class="line"><span class="lineno"> 2394</span>                {</div>
<div class="line"><span class="lineno"> 2395</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2396</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2397</span>                }</div>
<div class="line"><span class="lineno"> 2398</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;XONOTIC&quot;</span>, 8, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>)) <span class="comment">// len_out receives used size by this op</span></div>
<div class="line"><span class="lineno"> 2399</span>                {</div>
<div class="line"><span class="lineno"> 2400</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2401</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_start failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2402</span>                }</div>
<div class="line"><span class="lineno"> 2403</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 5;</div>
<div class="line"><span class="lineno"> 2404</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 2405</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2406</span>            }</div>
<div class="line"><span class="lineno"> 2407</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2408</span>        }</div>
<div class="line"><span class="lineno"> 2409</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2410</span>        {</div>
<div class="line"><span class="lineno"> 2411</span>            <span class="keywordflow">if</span>(wantserver_idfp[0]) <span class="comment">// if we know a host key, honor its encryption setting</span></div>
<div class="line"><span class="lineno"> 2412</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2413</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on encryption, but neither can authenticate to the other&quot;</span>);</div>
<div class="line"><span class="lineno"> 2414</span>            <span class="keywordflow">return</span> (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2415</span>                <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2416</span>        }</div>
<div class="line"><span class="lineno"> 2417</span>    }</div>
<div class="line"><span class="lineno"> 2418</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt; 5 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;d0pk\\&quot;</span>, 5) &amp;&amp; <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">connect_trying</a>)</div>
<div class="line"><span class="lineno"> 2419</span>    {</div>
<div class="line"><span class="lineno"> 2420</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>;</div>
<div class="line"><span class="lineno"> 2421</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a>;</div>
<div class="line"><span class="lineno"> 2422</span> </div>
<div class="line"><span class="lineno"> 2423</span>        <span class="comment">// Must check the source IP here, if we want to prevent other servers&#39; replies from falsely advancing the crypto state, preventing successful connect to the real server.</span></div>
<div class="line"><span class="lineno"> 2424</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="crypto_8c.html#ae5918471d5570f5ecf0da17ecf0a253b">net_sourceaddresscheck</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &amp;&amp; <a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(peeraddress, &amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>))</div>
<div class="line"><span class="lineno"> 2425</span>        {</div>
<div class="line"><span class="lineno"> 2426</span>            <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>[128];</div>
<div class="line"><span class="lineno"> 2427</span> </div>
<div class="line"><span class="lineno"> 2428</span>            <a class="code hl_function" href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>), <span class="stringliteral">&quot;ignoring d0pk\\ message from wrong server %s&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">peeraddressstring</a>);</div>
<div class="line"><span class="lineno"> 2429</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>);</div>
<div class="line"><span class="lineno"> 2430</span>        }</div>
<div class="line"><span class="lineno"> 2431</span> </div>
<div class="line"><span class="lineno"> 2432</span>        <span class="keywordtype">id</span> = (<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;id&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)) ? <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>) : -1);</div>
<div class="line"><span class="lineno"> 2433</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a> = (<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;cnt&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)) ? <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a> : <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2434</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>)</div>
<div class="line"><span class="lineno"> 2435</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0pk\\ message without cnt&quot;</span>);</div>
<div class="line"><span class="lineno"> 2436</span>        <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 2437</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>)</div>
<div class="line"><span class="lineno"> 2438</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0pk\\ message without attachment&quot;</span>);</div>
<div class="line"><span class="lineno"> 2439</span> </div>
<div class="line"><span class="lineno"> 2440</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;1&quot;</span>))</div>
<div class="line"><span class="lineno"> 2441</span>        {</div>
<div class="line"><span class="lineno"> 2442</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2443</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 2444</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2445</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 1)</div>
<div class="line"><span class="lineno"> 2446</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 2447</span> </div>
<div class="line"><span class="lineno"> 2448</span>            <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a> = <a class="code hl_define" href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a>, <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> + 1); <span class="comment">// prevent &quot;hammering&quot;</span></div>
<div class="line"><span class="lineno"> 2449</span> </div>
<div class="line"><span class="lineno"> 2450</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;aes&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 2451</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>);</div>
<div class="line"><span class="lineno"> 2452</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2453</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2454</span>            <span class="comment">// we CANNOT toggle the AES status any more!</span></div>
<div class="line"><span class="lineno"> 2455</span>            <span class="comment">// as the server already decided</span></div>
<div class="line"><span class="lineno"> 2456</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp[0]) <span class="comment">// if we know a host key, honor its encryption setting</span></div>
<div class="line"><span class="lineno"> 2457</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes)</div>
<div class="line"><span class="lineno"> 2458</span>            {</div>
<div class="line"><span class="lineno"> 2459</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2460</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Stored host key requires encryption, but server did not enable encryption&quot;</span>);</div>
<div class="line"><span class="lineno"> 2461</span>            }</div>
<div class="line"><span class="lineno"> 2462</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; (!<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> || <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &lt;= 0))</div>
<div class="line"><span class="lineno"> 2463</span>            {</div>
<div class="line"><span class="lineno"> 2464</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2465</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on encryption too hard&quot;</span>);</div>
<div class="line"><span class="lineno"> 2466</span>            }</div>
<div class="line"><span class="lineno"> 2467</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3))</div>
<div class="line"><span class="lineno"> 2468</span>            {</div>
<div class="line"><span class="lineno"> 2469</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2470</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on plaintext too hard&quot;</span>);</div>
<div class="line"><span class="lineno"> 2471</span>            }</div>
<div class="line"><span class="lineno"> 2472</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> != 0;</div>
<div class="line"><span class="lineno"> 2473</span> </div>
<div class="line"><span class="lineno"> 2474</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\2\\id\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2475</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a238db7be954a2720b4646a56f416e7a5">qd0_blind_id_authenticate_with_private_id_challenge</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno"> 2476</span>            {</div>
<div class="line"><span class="lineno"> 2477</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2478</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_challenge failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2479</span>            }</div>
<div class="line"><span class="lineno"> 2480</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 3;</div>
<div class="line"><span class="lineno"> 2481</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 2482</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2483</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2484</span>        }</div>
<div class="line"><span class="lineno"> 2485</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;3&quot;</span>))</div>
<div class="line"><span class="lineno"> 2486</span>        {</div>
<div class="line"><span class="lineno"> 2487</span>            <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>[32];</div>
<div class="line"><span class="lineno"> 2488</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuflen</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>);</div>
<div class="line"><span class="lineno"> 2489</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>;</div>
<div class="line"><span class="lineno"> 2490</span> </div>
<div class="line"><span class="lineno"> 2491</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2492</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 2493</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2494</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 3)</div>
<div class="line"><span class="lineno"> 2495</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 2496</span> </div>
<div class="line"><span class="lineno"> 2497</span>            <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a> = <a class="code hl_define" href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a>, <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> + 1); <span class="comment">// prevent &quot;hammering&quot;</span></div>
<div class="line"><span class="lineno"> 2498</span> </div>
<div class="line"><span class="lineno"> 2499</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#af57a05bc9b21589d745930acee39eb78">qd0_blind_id_authenticate_with_private_id_verify</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuflen</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno"> 2500</span>            {</div>
<div class="line"><span class="lineno"> 2501</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2502</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_verify failed (server authentication error)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2503</span>            }</div>
<div class="line"><span class="lineno"> 2504</span> </div>
<div class="line"><span class="lineno"> 2505</span>            <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>));</div>
<div class="line"><span class="lineno"> 2506</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a> &amp;&amp; <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_issigned)</div>
<div class="line"><span class="lineno"> 2507</span>            {</div>
<div class="line"><span class="lineno"> 2508</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2509</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Stored host key requires a valid signature, but server did not provide any&quot;</span>);</div>
<div class="line"><span class="lineno"> 2510</span>            }</div>
<div class="line"><span class="lineno"> 2511</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a46738359a9a1d657faa7a94313d6aa1f">server_issigned</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>, 0, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>));</div>
<div class="line"><span class="lineno"> 2514</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>;</div>
<div class="line"><span class="lineno"> 2515</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 2516</span>            {</div>
<div class="line"><span class="lineno"> 2517</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2518</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_fingerprint64_public_id failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2519</span>            }</div>
<div class="line"><span class="lineno"> 2520</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp[0])</div>
<div class="line"><span class="lineno"> 2521</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>)))</div>
<div class="line"><span class="lineno"> 2522</span>            {</div>
<div class="line"><span class="lineno"> 2523</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2524</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server ID does not match stored host key, refusing to connect&quot;</span>);</div>
<div class="line"><span class="lineno"> 2525</span>            }</div>
<div class="line"><span class="lineno"> 2526</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>;</div>
<div class="line"><span class="lineno"> 2527</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, (<span class="keywordtype">char</span> *) crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 2528</span>            {</div>
<div class="line"><span class="lineno"> 2529</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2530</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_sessionkey_public_id failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2531</span>            }</div>
<div class="line"><span class="lineno"> 2532</span> </div>
<div class="line"><span class="lineno"> 2533</span>            <span class="comment">// cache the server key</span></div>
<div class="line"><span class="lineno"> 2534</span>            <a class="code hl_function" href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%d %s@%s%s&quot;</span>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a> ? 1 : 0, crypto-&gt;server_idfp, crypto-&gt;server_issigned ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;~&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s]), <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">false</a>);</div>
<div class="line"><span class="lineno"> 2535</span> </div>
<div class="line"><span class="lineno"> 2536</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c &gt;= 0)</div>
<div class="line"><span class="lineno"> 2537</span>            {</div>
<div class="line"><span class="lineno"> 2538</span>                <span class="comment">// client will auth next</span></div>
<div class="line"><span class="lineno"> 2539</span>                <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\4\\id\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2540</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c]))</div>
<div class="line"><span class="lineno"> 2541</span>                {</div>
<div class="line"><span class="lineno"> 2542</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2543</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2544</span>                }</div>
<div class="line"><span class="lineno"> 2545</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;XONOTIC&quot;</span>, 8, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>)) <span class="comment">// len_out receives used size by this op</span></div>
<div class="line"><span class="lineno"> 2546</span>                {</div>
<div class="line"><span class="lineno"> 2547</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2548</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_start failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2549</span>                }</div>
<div class="line"><span class="lineno"> 2550</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 5;</div>
<div class="line"><span class="lineno"> 2551</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 2552</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2553</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2554</span>            }</div>
<div class="line"><span class="lineno"> 2555</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2556</span>            {</div>
<div class="line"><span class="lineno"> 2557</span>                <span class="comment">// session key is FINISHED (no server part is to be expected)! By this, all keys are set up</span></div>
<div class="line"><span class="lineno"> 2558</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2559</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 0;</div>
<div class="line"><span class="lineno"> 2560</span>                <span class="comment">// assume we got the empty challenge to finish the protocol</span></div>
<div class="line"><span class="lineno"> 2561</span>                <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;challenge &quot;</span>);</div>
<div class="line"><span class="lineno"> 2562</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2563</span>                --*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>; <span class="comment">// remove NUL terminator</span></div>
<div class="line"><span class="lineno"> 2564</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a6d9f8e2afed02501c245a07309bd656c">CRYPTO_REPLACE</a>;</div>
<div class="line"><span class="lineno"> 2565</span>            }</div>
<div class="line"><span class="lineno"> 2566</span>        }</div>
<div class="line"><span class="lineno"> 2567</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;5&quot;</span>))</div>
<div class="line"><span class="lineno"> 2568</span>        {</div>
<div class="line"><span class="lineno"> 2569</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>;</div>
<div class="line"><span class="lineno"> 2570</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dhkey[<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2571</span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 2572</span> </div>
<div class="line"><span class="lineno"> 2573</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2574</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 2575</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2576</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 5)</div>
<div class="line"><span class="lineno"> 2577</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 2578</span> </div>
<div class="line"><span class="lineno"> 2579</span>            <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a> = <a class="code hl_define" href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a>, <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> + 1); <span class="comment">// prevent &quot;hammering&quot;</span></div>
<div class="line"><span class="lineno"> 2580</span> </div>
<div class="line"><span class="lineno"> 2581</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s &lt; 0) <span class="comment">// only if server didn&#39;t auth</span></div>
<div class="line"><span class="lineno"> 2582</span>            {</div>
<div class="line"><span class="lineno"> 2583</span>                <span class="keywordflow">if</span>(<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;aes&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 2584</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>);</div>
<div class="line"><span class="lineno"> 2585</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2586</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2587</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp[0]) <span class="comment">// if we know a host key, honor its encryption setting</span></div>
<div class="line"><span class="lineno"> 2588</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes)</div>
<div class="line"><span class="lineno"> 2589</span>                {</div>
<div class="line"><span class="lineno"> 2590</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2591</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Stored host key requires encryption, but server did not enable encryption&quot;</span>);</div>
<div class="line"><span class="lineno"> 2592</span>                }</div>
<div class="line"><span class="lineno"> 2593</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; (!<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> || <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &lt;= 0))</div>
<div class="line"><span class="lineno"> 2594</span>                {</div>
<div class="line"><span class="lineno"> 2595</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2596</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on encryption too hard&quot;</span>);</div>
<div class="line"><span class="lineno"> 2597</span>                }</div>
<div class="line"><span class="lineno"> 2598</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3))</div>
<div class="line"><span class="lineno"> 2599</span>                {</div>
<div class="line"><span class="lineno"> 2600</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2601</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on plaintext too hard&quot;</span>);</div>
<div class="line"><span class="lineno"> 2602</span>                }</div>
<div class="line"><span class="lineno"> 2603</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> != 0;</div>
<div class="line"><span class="lineno"> 2604</span>            }</div>
<div class="line"><span class="lineno"> 2605</span> </div>
<div class="line"><span class="lineno"> 2606</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\6\\id\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2607</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#aaf540674cda53b14bdd104f40759c386">qd0_blind_id_authenticate_with_private_id_response</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>))</div>
<div class="line"><span class="lineno"> 2608</span>            {</div>
<div class="line"><span class="lineno"> 2609</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2610</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_response failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2611</span>            }</div>
<div class="line"><span class="lineno"> 2612</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>;</div>
<div class="line"><span class="lineno"> 2613</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, (<span class="keywordtype">char</span> *) dhkey, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 2614</span>            {</div>
<div class="line"><span class="lineno"> 2615</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2616</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_sessionkey_public_id failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2617</span>            }</div>
<div class="line"><span class="lineno"> 2618</span>            <span class="comment">// XOR the two DH keys together to make one</span></div>
<div class="line"><span class="lineno"> 2619</span>            <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 2620</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^= dhkey[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno"> 2621</span>            <span class="comment">// session key is FINISHED! By this, all keys are set up</span></div>
<div class="line"><span class="lineno"> 2622</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2623</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 0;</div>
<div class="line"><span class="lineno"> 2624</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 2625</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2626</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2627</span>        }</div>
<div class="line"><span class="lineno"> 2628</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Got unknown d0_blind_id message from server&quot;</span>);</div>
<div class="line"><span class="lineno"> 2629</span>    }</div>
<div class="line"><span class="lineno"> 2630</span> </div>
<div class="line"><span class="lineno"> 2631</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2632</span>}</div>
<div class="ttc" id="acl__main_8c_html_ab4b4e0f12a72d330ee0869bdf1b372cd"><div class="ttname"><a href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a></div><div class="ttdeci">client_static_t cls</div><div class="ttdef"><b>Definition</b> <a href="cl__main_8c_source.html#l00114">cl_main.c:114</a></div></div>
<div class="ttc" id="acom__infostring_8c_html_aa001d512a0f3228d202a4c8b47aa7984"><div class="ttname"><a href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a></div><div class="ttdeci">size_t InfoString_GetValue(const char *buffer, const char *key, char *value, size_t valuesize)</div><div class="ttdoc">Returns the number of bytes written to *value excluding the \0 terminator.</div><div class="ttdef"><b>Definition</b> <a href="com__infostring_8c_source.html#l00023">com_infostring.c:23</a></div></div>
<div class="ttc" id="acom__msg_8c_html_a9375c7a4c8e2a5785acd5a71078378bb"><div class="ttname"><a href="com__msg_8c.html#a9375c7a4c8e2a5785acd5a71078378bb">BuffLittleLong</a></div><div class="ttdeci">int BuffLittleLong(const unsigned char *buffer)</div><div class="ttdoc">Extract a little endian 32bit int from the given buffer.</div><div class="ttdef"><b>Definition</b> <a href="com__msg_8c_source.html#l00071">com_msg.c:71</a></div></div>
<div class="ttc" id="acommon_8c_html_a4a8220fa88226bf9cf39b12a051a20d7"><div class="ttname"><a href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a></div><div class="ttdeci">char * va(char *buf, size_t buflen, const char *format,...)</div><div class="ttdef"><b>Definition</b> <a href="common_8c_source.html#l00972">common.c:972</a></div></div>
<div class="ttc" id="acommon_8c_html_ae36050083f45e395189fee6aa45fbb0c"><div class="ttname"><a href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a></div><div class="ttdeci">int dpsnprintf(char *buffer, size_t buffersize, const char *format,...)</div><div class="ttdoc">Returns the number of printed characters, excluding the final '\0' or returns -1 if the buffer isn't ...</div><div class="ttdef"><b>Definition</b> <a href="common_8c_source.html#l00997">common.c:997</a></div></div>
<div class="ttc" id="acommon_8h_html_aaef80d6b72e2476c82258733a8c4eced"><div class="ttname"><a href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a></div><div class="ttdeci">#define dp_strlcpy(dst, src, dsize)</div><div class="ttdef"><b>Definition</b> <a href="common_8h_source.html#l00298">common.h:298</a></div></div>
<div class="ttc" id="acrypto_8c_html_a09ddfceaa9b1578f414a3e3408ce7ea1"><div class="ttname"><a href="crypto_8c.html#a09ddfceaa9b1578f414a3e3408ce7ea1">cdata_id</a></div><div class="ttdeci">static int cdata_id</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00509">crypto.c:509</a></div></div>
<div class="ttc" id="acrypto_8c_html_a238db7be954a2720b4646a56f416e7a5"><div class="ttname"><a href="crypto_8c.html#a238db7be954a2720b4646a56f416e7a5">qd0_blind_id_authenticate_with_private_id_challenge</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_authenticate_with_private_id_challenge)(d0_blind_id_t *ctx, D0_BOOL is_first, D0_BOOL recv_modulus, const char *inbuf, size_t inbuflen, char *outbuf, size_t *outbuflen, D0_BOOL *status)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00223">crypto.c:223</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2ba1c091c9f8d31b8761c8c6c8e12a74"><div class="ttname"><a href="crypto_8c.html#a2ba1c091c9f8d31b8761c8c6c8e12a74">PROTOCOL_VLEN</a></div><div class="ttdeci">#define PROTOCOL_VLEN</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00047">crypto.c:47</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2cc28a754edbe5c9184d04bb4a6ad76a"><div class="ttname"><a href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a></div><div class="ttdeci">#define D0_BOOL</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00187">crypto.c:187</a></div></div>
<div class="ttc" id="acrypto_8c_html_a386a69f0199d722b7886d32cafe9d7dc"><div class="ttname"><a href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT d0_blind_id_t *(* qd0_blind_id_new)(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00198">crypto.c:198</a></div></div>
<div class="ttc" id="acrypto_8c_html_a415708eb37a2ec762abe53d4dac87ac0"><div class="ttname"><a href="crypto_8c.html#a415708eb37a2ec762abe53d4dac87ac0">PROTOCOL_D0_BLIND_ID</a></div><div class="ttdeci">#define PROTOCOL_D0_BLIND_ID</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00046">crypto.c:46</a></div></div>
<div class="ttc" id="acrypto_8c_html_a48cd47ff384a225c07aae1505db8c269"><div class="ttname"><a href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a></div><div class="ttdeci">static char pubkeys_priv_fp64[MAX_PUBKEYS][FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00486">crypto.c:486</a></div></div>
<div class="ttc" id="acrypto_8c_html_a4addd0ad7e9030ba3719926ad25b11b4"><div class="ttname"><a href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a></div><div class="ttdeci">qbool Crypto_RetrieveHostKey(lhnetaddress_t *peeraddress, int *keyid, char *keyfp, size_t keyfplen, char *idfp, size_t idfplen, int *aeslevel, qbool *issigned)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00734">crypto.c:734</a></div></div>
<div class="ttc" id="acrypto_8c_html_a4cbfb270eaaeb2f550ad978be861d129"><div class="ttname"><a href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_sessionkey_public_id)(const d0_blind_id_t *ctx, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00227">crypto.c:227</a></div></div>
<div class="ttc" id="acrypto_8c_html_a57d3d64d18e1c220988f7cff0053d630"><div class="ttname"><a href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a></div><div class="ttdeci">static qbool PutWithNul(char **data, size_t *len, const char *str)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00406">crypto.c:406</a></div></div>
<div class="ttc" id="acrypto_8c_html_a72048b767e62a20b79bde41af5b4615c"><div class="ttname"><a href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a></div><div class="ttdeci">#define CDATA</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00524">crypto.c:524</a></div></div>
<div class="ttc" id="acrypto_8c_html_a81517c37964da8773c8a85b39cbe62ef"><div class="ttname"><a href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a></div><div class="ttdeci">#define MAX_PUBKEYS</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00481">crypto.c:481</a></div></div>
<div class="ttc" id="acrypto_8c_html_a85cf03eabae9c5ffb347409d468d6f9c"><div class="ttname"><a href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a></div><div class="ttdeci">static int Crypto_ClientError(char *data_out, size_t *len_out, const char *msg)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l02093">crypto.c:2093</a></div></div>
<div class="ttc" id="acrypto_8c_html_a95d40b2f3505629533c24fcfc912854c"><div class="ttname"><a href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a></div><div class="ttdeci">static qbool pubkeys_havesig[MAX_PUBKEYS]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00485">crypto.c:485</a></div></div>
<div class="ttc" id="acrypto_8c_html_a97b4731bcda09762498f4c4ab8950eee"><div class="ttname"><a href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a></div><div class="ttdeci">static qbool pubkeys_havepriv[MAX_PUBKEYS]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00484">crypto.c:484</a></div></div>
<div class="ttc" id="acrypto_8c_html_a9cb23abf4b1a78be4ffa5d5f8842faa0"><div class="ttname"><a href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_fingerprint64_public_id)(const d0_blind_id_t *ctx, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00226">crypto.c:226</a></div></div>
<div class="ttc" id="acrypto_8c_html_a9e2d859ffde566232fcd3e099be1acc9"><div class="ttname"><a href="crypto_8c.html#a9e2d859ffde566232fcd3e099be1acc9">MAKE_CDATA</a></div><div class="ttdeci">#define MAKE_CDATA</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00525">crypto.c:525</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa09cfb5d32dc22ee93c5f88bb883084e"><div class="ttname"><a href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_authenticate_with_private_id_start)(d0_blind_id_t *ctx, D0_BOOL is_first, D0_BOOL send_modulus, const char *message, size_t msglen, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00222">crypto.c:222</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa6a8e5916e25ff44b9ed67996dba0068"><div class="ttname"><a href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a></div><div class="ttdeci">cvar_t crypto_aeslevel</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00031">crypto.c:31</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa88008abe3af1f6fb6c5596928082e4e"><div class="ttname"><a href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a></div><div class="ttdeci">static char pubkeys_fp64[MAX_PUBKEYS][FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00483">crypto.c:483</a></div></div>
<div class="ttc" id="acrypto_8c_html_aaf540674cda53b14bdd104f40759c386"><div class="ttname"><a href="crypto_8c.html#aaf540674cda53b14bdd104f40759c386">qd0_blind_id_authenticate_with_private_id_response</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_authenticate_with_private_id_response)(d0_blind_id_t *ctx, const char *inbuf, size_t inbuflen, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00224">crypto.c:224</a></div></div>
<div class="ttc" id="acrypto_8c_html_aaf812a19119a94ac6d13e6c6f241e7ad"><div class="ttname"><a href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a></div><div class="ttdeci">static void Crypto_StoreHostKey(lhnetaddress_t *peeraddress, const char *keystring, qbool complain)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00635">crypto.c:635</a></div></div>
<div class="ttc" id="acrypto_8c_html_ab680491cca435a1f84b2e9fa8a973061"><div class="ttname"><a href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a></div><div class="ttdeci">static unsigned long Crypto_LittleLong(const char *data)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00059">crypto.c:59</a></div></div>
<div class="ttc" id="acrypto_8c_html_ac8f343ad0620ecc82d3eb9a52c3ecfb6"><div class="ttname"><a href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a></div><div class="ttdeci">static dllhandle_t d0_rijndael_dll</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00351">crypto.c:351</a></div></div>
<div class="ttc" id="acrypto_8c_html_aca5468ecb996a99a78f68985d23a085d"><div class="ttname"><a href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a></div><div class="ttdeci">static int Crypto_SoftClientError(char *data_out, size_t *len_out, const char *msg)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l02100">crypto.c:2100</a></div></div>
<div class="ttc" id="acrypto_8c_html_acb17359f23753e70a2d100f311c83e9b"><div class="ttname"><a href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_copy)(d0_blind_id_t *ctx, const d0_blind_id_t *src)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00201">crypto.c:201</a></div></div>
<div class="ttc" id="acrypto_8c_html_ad209fec4c56eb4b0966702b7452bd7db"><div class="ttname"><a href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a></div><div class="ttdeci">static d0_blind_id_t * pubkeys[MAX_PUBKEYS]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00482">crypto.c:482</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae0749fdaf63ce66fa265a6eb1d352a36"><div class="ttname"><a href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a></div><div class="ttdeci">#define CLEAR_CDATA</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00526">crypto.c:526</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae5918471d5570f5ecf0da17ecf0a253b"><div class="ttname"><a href="crypto_8c.html#ae5918471d5570f5ecf0da17ecf0a253b">net_sourceaddresscheck</a></div><div class="ttdeci">cvar_t net_sourceaddresscheck</div><div class="ttdef"><b>Definition</b> <a href="netconn_8c_source.html#l00083">netconn.c:83</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae86e7e74ff72144661d72e3a6d347cdc"><div class="ttname"><a href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a></div><div class="ttdeci">static const char * GetUntilNul(const char **data, size_t *len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00418">crypto.c:418</a></div></div>
<div class="ttc" id="acrypto_8c_html_af57a05bc9b21589d745930acee39eb78"><div class="ttname"><a href="crypto_8c.html#af57a05bc9b21589d745930acee39eb78">qd0_blind_id_authenticate_with_private_id_verify</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_authenticate_with_private_id_verify)(d0_blind_id_t *ctx, const char *inbuf, size_t inbuflen, char *msg, size_t *msglen, D0_BOOL *status)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00225">crypto.c:225</a></div></div>
<div class="ttc" id="acrypto_8h_html_a1efd20cc345410a8f68978ece41aac10"><div class="ttname"><a href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a></div><div class="ttdeci">#define CRYPTO_DISCARD</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00066">crypto.h:66</a></div></div>
<div class="ttc" id="acrypto_8h_html_a5b284ff4c80ff5aa9f0b4ee842a33d44"><div class="ttname"><a href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a></div><div class="ttdeci">#define FP64_SIZE</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00038">crypto.h:38</a></div></div>
<div class="ttc" id="acrypto_8h_html_a6d9f8e2afed02501c245a07309bd656c"><div class="ttname"><a href="crypto_8h.html#a6d9f8e2afed02501c245a07309bd656c">CRYPTO_REPLACE</a></div><div class="ttdeci">#define CRYPTO_REPLACE</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00067">crypto.h:67</a></div></div>
<div class="ttc" id="acrypto_8h_html_a8c7ff8f693d7a32873476640d01ecef3"><div class="ttname"><a href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a></div><div class="ttdeci">#define CRYPTO_NOMATCH</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00064">crypto.h:64</a></div></div>
<div class="ttc" id="acrypto_8h_html_ad9de82069262439e7e921069abb457c1"><div class="ttname"><a href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a></div><div class="ttdeci">#define DHKEY_SIZE</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00039">crypto.h:39</a></div></div>
<div class="ttc" id="aglquake_8h_html_a004e0b0e92ed2f6e1c9993f0271ebfb3"><div class="ttname"><a href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a></div><div class="ttdeci">GLenum GLuint id</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00656">glquake.h:656</a></div></div>
<div class="ttc" id="aglquake_8h_html_a4d1613b1e415f5e41c4651a1793b277a"><div class="ttname"><a href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a></div><div class="ttdeci">const GLdouble * v</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00761">glquake.h:761</a></div></div>
<div class="ttc" id="aglquake_8h_html_af7ca775b6d9354291c4d7d01b8b2a8bc"><div class="ttname"><a href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">index</a></div><div class="ttdeci">GLuint index</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00628">glquake.h:628</a></div></div>
<div class="ttc" id="ahost_8c_html_a18cf3cec0ecbf5cc14125f494c49023d"><div class="ttname"><a href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a></div><div class="ttdeci">host_static_t host</div><div class="ttdef"><b>Definition</b> <a href="host_8c_source.html#l00041">host.c:41</a></div></div>
<div class="ttc" id="alhnet_8c_html_afcb50bceea3f2dc4d4c1663bb6d35e9e"><div class="ttname"><a href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a></div><div class="ttdeci">int LHNETADDRESS_Compare(const lhnetaddress_t *vaddress1, const lhnetaddress_t *vaddress2)</div><div class="ttdef"><b>Definition</b> <a href="lhnet_8c_source.html#l00665">lhnet.c:665</a></div></div>
<div class="ttc" id="amathlib_8h_html_a24e753bacac6be5f30e18f8a2bdefda4"><div class="ttname"><a href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a></div><div class="ttdeci">#define max(A, B)</div><div class="ttdef"><b>Definition</b> <a href="mathlib_8h_source.html#l00038">mathlib.h:38</a></div></div>
<div class="ttc" id="amathlib_8h_html_a553641b2aac0b2a7c43f9f74f8333fd5"><div class="ttname"><a href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a></div><div class="ttdeci">#define bound(min, num, max)</div><div class="ttdef"><b>Definition</b> <a href="mathlib_8h_source.html#l00034">mathlib.h:34</a></div></div>
<div class="ttc" id="anetconn_8h_html_a06ea659d8515a7837b0d743942d5b2ca"><div class="ttname"><a href="netconn_8h.html#a06ea659d8515a7837b0d743942d5b2ca">CCREP_SERVER_INFO</a></div><div class="ttdeci">#define CCREP_SERVER_INFO</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00127">netconn.h:127</a></div></div>
<div class="ttc" id="anetconn_8h_html_a292ee6efb14953f64ea03ddd1988b202"><div class="ttname"><a href="netconn_8h.html#a292ee6efb14953f64ea03ddd1988b202">NETFLAG_CTL</a></div><div class="ttdeci">#define NETFLAG_CTL</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00044">netconn.h:44</a></div></div>
<div class="ttc" id="anetconn_8h_html_a3bf085f22c8f4adbf3c06885f528ea82"><div class="ttname"><a href="netconn_8h.html#a3bf085f22c8f4adbf3c06885f528ea82">CCREP_PLAYER_INFO</a></div><div class="ttdeci">#define CCREP_PLAYER_INFO</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00128">netconn.h:128</a></div></div>
<div class="ttc" id="anetconn_8h_html_aa34599ce347c884f29a05f2040fcab24"><div class="ttname"><a href="netconn_8h.html#aa34599ce347c884f29a05f2040fcab24">CCREP_RULE_INFO</a></div><div class="ttdeci">#define CCREP_RULE_INFO</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00129">netconn.h:129</a></div></div>
<div class="ttc" id="aprvm__execprogram_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition</b> <a href="prvm__execprogram_8h_source.html#l00002">prvm_execprogram.h:2</a></div></div>
<div class="ttc" id="aqdefs_8h_html_a119f8457078d7390fb45ea0838adb806"><div class="ttname"><a href="qdefs_8h.html#a119f8457078d7390fb45ea0838adb806">MAX_INPUTLINE</a></div><div class="ttdeci">#define MAX_INPUTLINE</div><div class="ttdoc">maximum size of console commandline, QuakeC strings, and many other text processing buffers</div><div class="ttdef"><b>Definition</b> <a href="qdefs_8h_source.html#l00094">qdefs.h:94</a></div></div>
<div class="ttc" id="aqtypes_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition</b> <a href="qtypes_8h_source.html#l00012">qtypes.h:12</a></div></div>
<div class="ttc" id="aqtypes_8h_html_aa250998bce2dc350e4f644297bb579c3"><div class="ttname"><a href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a></div><div class="ttdeci">bool qbool</div><div class="ttdef"><b>Definition</b> <a href="qtypes_8h_source.html#l00009">qtypes.h:9</a></div></div>
<div class="ttc" id="astructclient__static__t_html_a2918ef8b215b79e8f7067feb116eb6b4"><div class="ttname"><a href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">client_static_t::connect_trying</a></div><div class="ttdeci">qbool connect_trying</div><div class="ttdef"><b>Definition</b> <a href="client_8h_source.html#l00610">client.h:610</a></div></div>
<div class="ttc" id="astructclient__static__t_html_a6b1b21c226c99c9d1e972dc080ee1855"><div class="ttname"><a href="structclient__static__t.html#a6b1b21c226c99c9d1e972dc080ee1855">client_static_t::crypto</a></div><div class="ttdeci">crypto_t crypto</div><div class="ttdef"><b>Definition</b> <a href="client_8h_source.html#l00681">client.h:681</a></div></div>
<div class="ttc" id="astructclient__static__t_html_abdcdc5e6094eaabade817df1719c559a"><div class="ttname"><a href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">client_static_t::connect_nextsendtime</a></div><div class="ttdeci">double connect_nextsendtime</div><div class="ttdef"><b>Definition</b> <a href="client_8h_source.html#l00612">client.h:612</a></div></div>
<div class="ttc" id="astructclient__static__t_html_ac3fec2efadcad43aac413b686920dfb1"><div class="ttname"><a href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">client_static_t::connect_address</a></div><div class="ttdeci">lhnetaddress_t connect_address</div><div class="ttdef"><b>Definition</b> <a href="client_8h_source.html#l00614">client.h:614</a></div></div>
<div class="ttc" id="astructcrypto__t_html"><div class="ttname"><a href="structcrypto__t.html">crypto_t</a></div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00041">crypto.h:42</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a318251b45f735d3bfddd12838c89cfc4"><div class="ttname"><a href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">crypto_t::server_keyfp</a></div><div class="ttdeci">char server_keyfp[FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00048">crypto.h:48</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a46738359a9a1d657faa7a94313d6aa1f"><div class="ttname"><a href="structcrypto__t.html#a46738359a9a1d657faa7a94313d6aa1f">crypto_t::server_issigned</a></div><div class="ttdeci">qbool server_issigned</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00049">crypto.h:49</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a60ee73f814f37cb03ca6337d2c714eb2"><div class="ttname"><a href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">crypto_t::client_idfp</a></div><div class="ttdeci">char client_idfp[FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00044">crypto.h:44</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a62712966bbfd7a3b7a32b14291aaaa1c"><div class="ttname"><a href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">crypto_t::dhkey</a></div><div class="ttdeci">unsigned char dhkey[DHKEY_SIZE]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00043">crypto.h:43</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a68057f781c7ef3efbb8dd9c2a3dbd816"><div class="ttname"><a href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">crypto_t::client_keyfp</a></div><div class="ttdeci">char client_keyfp[FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00045">crypto.h:45</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a7f14ed53c5a1a67b9b2502b4662df228"><div class="ttname"><a href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">crypto_t::authenticated</a></div><div class="ttdeci">qbool authenticated</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00050">crypto.h:50</a></div></div>
<div class="ttc" id="astructcrypto__t_html_ad0f40ef405fc08dcc50822d8183a6d30"><div class="ttname"><a href="structcrypto__t.html#ad0f40ef405fc08dcc50822d8183a6d30">crypto_t::client_issigned</a></div><div class="ttdeci">qbool client_issigned</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00046">crypto.h:46</a></div></div>
<div class="ttc" id="astructcrypto__t_html_ad495ade07da51add51fdcfa3763866bd"><div class="ttname"><a href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">crypto_t::server_idfp</a></div><div class="ttdeci">char server_idfp[FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00047">crypto.h:47</a></div></div>
<div class="ttc" id="astructcrypto__t_html_affa2d958b3f1849e55ab9fd6a5f5c1b7"><div class="ttname"><a href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">crypto_t::use_aes</a></div><div class="ttdeci">qbool use_aes</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00051">crypto.h:51</a></div></div>
<div class="ttc" id="astructcvar__t_html_a376ca13f147f306d71edbe7670e138b0"><div class="ttname"><a href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">cvar_t::integer</a></div><div class="ttdeci">int integer</div><div class="ttdef"><b>Definition</b> <a href="cvar_8h_source.html#l00073">cvar.h:73</a></div></div>
<div class="ttc" id="astructhost__static__t_html_ac38d937c03a5f5f973a77641c0ae1280"><div class="ttname"><a href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">host_static_t::realtime</a></div><div class="ttdeci">double realtime</div><div class="ttdef"><b>Definition</b> <a href="host_8h_source.html#l00037">host.h:37</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l02002">NetConn_ClientParsePacket()</a>.</p>

</div>
</div>
<a id="a5edc59e776eb84e8d80fd7a1c83e7973" name="a5edc59e776eb84e8d80fd7a1c83e7973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5edc59e776eb84e8d80fd7a1c83e7973">&#9670;&#160;</a></span>Crypto_DecryptPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> * Crypto_DecryptPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td>
          <td class="paramname"><em>crypto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01584">1584</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1585</span>{</div>
<div class="line"><span class="lineno"> 1586</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> h[32];</div>
<div class="line"><span class="lineno"> 1587</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1588</span> </div>
<div class="line"><span class="lineno"> 1589</span>    <span class="comment">// silently handle non-crypto packets</span></div>
<div class="line"><span class="lineno"> 1590</span>    <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code hl_function" href="com__msg_8c.html#acd30e83205c1a8193744237c44ad0f01">BuffBigLong</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>);</div>
<div class="line"><span class="lineno"> 1591</span>    <span class="keywordflow">if</span>(</div>
<div class="line"><span class="lineno"> 1592</span>        (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0xFFFFFFFF) <span class="comment">// avoid QW control packet</span></div>
<div class="line"><span class="lineno"> 1593</span>        ||</div>
<div class="line"><span class="lineno"> 1594</span>        (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0x80000000 + (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>) <span class="comment">// avoid NQ control packet</span></div>
<div class="line"><span class="lineno"> 1595</span>    )</div>
<div class="line"><span class="lineno"> 1596</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1597</span> </div>
<div class="line"><span class="lineno"> 1598</span>    <span class="keywordflow">if</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a>)</div>
<div class="line"><span class="lineno"> 1599</span>    {</div>
<div class="line"><span class="lineno"> 1600</span>        <span class="keywordflow">if</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a>)</div>
<div class="line"><span class="lineno"> 1601</span>        {</div>
<div class="line"><span class="lineno"> 1602</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> &lt; 16 || ((<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> - 16) % 16))</div>
<div class="line"><span class="lineno"> 1603</span>            {</div>
<div class="line"><span class="lineno"> 1604</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_DecryptPacket failed (not enough space: %d bytes in, %d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1605</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1606</span>            }</div>
<div class="line"><span class="lineno"> 1607</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> - ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>)[0];</div>
<div class="line"><span class="lineno"> 1608</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len &lt; *len_dst || *len_dst &gt;</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> - 16)</div>
<div class="line"><span class="lineno"> 1609</span>            {</div>
<div class="line"><span class="lineno"> 1610</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_DecryptPacket failed (not enough space: %d bytes in, %d-&gt;%d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1611</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1612</span>            }</div>
<div class="line"><span class="lineno"> 1613</span>            <a class="code hl_function" href="crypto_8c.html#a65bcc30d6b1ebadfcec50ca06f7bfac5">seacpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, ((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>) + 16, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>);</div>
<div class="line"><span class="lineno"> 1614</span>            <span class="comment">//                    IV                          dst                         src                                      len</span></div>
<div class="line"><span class="lineno"> 1615</span>            <span class="keywordflow">if</span>(!<a class="code hl_define" href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a>(h, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, (<span class="keywordtype">int</span>)*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>))</div>
<div class="line"><span class="lineno"> 1616</span>            {</div>
<div class="line"><span class="lineno"> 1617</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC fail\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1618</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1619</span>            }</div>
<div class="line"><span class="lineno"> 1620</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>)+1, h, 15)) <span class="comment">// ignore first byte, used for length</span></div>
<div class="line"><span class="lineno"> 1621</span>            {</div>
<div class="line"><span class="lineno"> 1622</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC mismatch\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1623</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1624</span>            }</div>
<div class="line"><span class="lineno"> 1625</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="netconn_8c.html#a6ec6ab811f71ef2e66d3aa1710c0a095">developer_networking</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno"> 1626</span>            {</div>
<div class="line"><span class="lineno"> 1627</span>                <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;Decrypted:\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1628</span>                <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, (<span class="keywordtype">int</span>)*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>);</div>
<div class="line"><span class="lineno"> 1629</span>            }</div>
<div class="line"><span class="lineno"> 1630</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>; <span class="comment">// no need to copy</span></div>
<div class="line"><span class="lineno"> 1631</span>        }</div>
<div class="line"><span class="lineno"> 1632</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1633</span>        {</div>
<div class="line"><span class="lineno"> 1634</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> &lt; 16)</div>
<div class="line"><span class="lineno"> 1635</span>            {</div>
<div class="line"><span class="lineno"> 1636</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_DecryptPacket failed (not enough space: %d bytes in, %d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1637</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1638</span>            }</div>
<div class="line"><span class="lineno"> 1639</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> - 16;</div>
<div class="line"><span class="lineno"> 1640</span>            <span class="keywordflow">if</span>(len &lt; *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>)</div>
<div class="line"><span class="lineno"> 1641</span>            {</div>
<div class="line"><span class="lineno"> 1642</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_DecryptPacket failed (not enough space: %d bytes in, %d-&gt;%d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1643</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1644</span>            }</div>
<div class="line"><span class="lineno"> 1645</span>            <span class="comment">//memcpy(data_dst, data_src + 16, *len_dst);</span></div>
<div class="line"><span class="lineno"> 1646</span>            <span class="keywordflow">if</span>(!<a class="code hl_define" href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a>(h, ((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>) + 16, (<span class="keywordtype">int</span>)*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>))</div>
<div class="line"><span class="lineno"> 1647</span>            {</div>
<div class="line"><span class="lineno"> 1648</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC fail\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1649</span>                <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1650</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1651</span>            }</div>
<div class="line"><span class="lineno"> 1652</span> </div>
<div class="line"><span class="lineno"> 1653</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, h, 16)) <span class="comment">// ignore first byte, used for length</span></div>
<div class="line"><span class="lineno"> 1654</span>            {</div>
<div class="line"><span class="lineno"> 1655</span>                <span class="comment">// undo the &quot;avoid conditions&quot;</span></div>
<div class="line"><span class="lineno"> 1656</span>                <span class="keywordflow">if</span>(</div>
<div class="line"><span class="lineno"> 1657</span>                        (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0x7FFFFFFF) <span class="comment">// avoided QW control packet</span></div>
<div class="line"><span class="lineno"> 1658</span>                        ||</div>
<div class="line"><span class="lineno"> 1659</span>                        (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0x00000000 + (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>) <span class="comment">// avoided NQ control packet</span></div>
<div class="line"><span class="lineno"> 1660</span>                  )</div>
<div class="line"><span class="lineno"> 1661</span>                {</div>
<div class="line"><span class="lineno"> 1662</span>                    <span class="comment">// do the avoidance on the hash too</span></div>
<div class="line"><span class="lineno"> 1663</span>                    h[0] ^= 0x80;</div>
<div class="line"><span class="lineno"> 1664</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, h, 16)) <span class="comment">// ignore first byte, used for length</span></div>
<div class="line"><span class="lineno"> 1665</span>                    {</div>
<div class="line"><span class="lineno"> 1666</span>                        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC mismatch\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1667</span>                        <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1668</span>                        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1669</span>                    }</div>
<div class="line"><span class="lineno"> 1670</span>                }</div>
<div class="line"><span class="lineno"> 1671</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1672</span>                {</div>
<div class="line"><span class="lineno"> 1673</span>                    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC mismatch\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1674</span>                    <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1675</span>                    <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1676</span>                }</div>
<div class="line"><span class="lineno"> 1677</span>            }</div>
<div class="line"><span class="lineno"> 1678</span>            <span class="keywordflow">return</span> ((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>) + 16; <span class="comment">// no need to copy, so data_dst is not used</span></div>
<div class="line"><span class="lineno"> 1679</span>        }</div>
<div class="line"><span class="lineno"> 1680</span>    }</div>
<div class="line"><span class="lineno"> 1681</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1682</span>    {</div>
<div class="line"><span class="lineno"> 1683</span>        *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>;</div>
<div class="line"><span class="lineno"> 1684</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>;</div>
<div class="line"><span class="lineno"> 1685</span>    }</div>
<div class="line"><span class="lineno"> 1686</span>}</div>
<div class="ttc" id="acom__msg_8c_html_acd30e83205c1a8193744237c44ad0f01"><div class="ttname"><a href="com__msg_8c.html#acd30e83205c1a8193744237c44ad0f01">BuffBigLong</a></div><div class="ttdeci">int BuffBigLong(const unsigned char *buffer)</div><div class="ttdoc">Extract a big endian 32bit int from the given buffer.</div><div class="ttdef"><b>Definition</b> <a href="com__msg_8c_source.html#l00049">com_msg.c:49</a></div></div>
<div class="ttc" id="acommon_8c_html_a9913aa4c9e2d0acfc38638235bbe31ca"><div class="ttname"><a href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a></div><div class="ttdeci">void Com_HexDumpToConsole(const unsigned char *data, int size)</div><div class="ttdef"><b>Definition</b> <a href="common_8c_source.html#l00082">common.c:82</a></div></div>
<div class="ttc" id="aconsole_8c_html_a1cf9711475097b11dc41f743254ec77e"><div class="ttname"><a href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a></div><div class="ttdeci">void Con_Print(const char *msg)</div><div class="ttdoc">Prints to all appropriate console targets, and adds timestamps.</div><div class="ttdef"><b>Definition</b> <a href="console_8c_source.html#l01450">console.c:1450</a></div></div>
<div class="ttc" id="aconsole_8c_html_a49b71fe9a87e57a440e07af4a869a9f6"><div class="ttname"><a href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a></div><div class="ttdeci">void Con_Printf(const char *fmt,...)</div><div class="ttdoc">Prints to all appropriate console targets.</div><div class="ttdef"><b>Definition</b> <a href="console_8c_source.html#l01460">console.c:1460</a></div></div>
<div class="ttc" id="acrypto_8c_html_a65bcc30d6b1ebadfcec50ca06f7bfac5"><div class="ttname"><a href="crypto_8c.html#a65bcc30d6b1ebadfcec50ca06f7bfac5">seacpy</a></div><div class="ttdeci">static void seacpy(unsigned char *key, const unsigned char *iv, unsigned char *dst, const unsigned char *src, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01498">crypto.c:1498</a></div></div>
<div class="ttc" id="ahmac_8h_html_a3ea45fae63ebf2bb7feef10afe4505f2"><div class="ttname"><a href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a></div><div class="ttdeci">#define HMAC_SHA256_32BYTES(out, in, n, key, k)</div><div class="ttdef"><b>Definition</b> <a href="hmac_8h_source.html#l00015">hmac.h:15</a></div></div>
<div class="ttc" id="anetconn_8c_html_a6ec6ab811f71ef2e66d3aa1710c0a095"><div class="ttname"><a href="netconn_8c.html#a6ec6ab811f71ef2e66d3aa1710c0a095">developer_networking</a></div><div class="ttdeci">cvar_t developer_networking</div><div class="ttdef"><b>Definition</b> <a href="netconn_8c_source.html#l00085">netconn.c:85</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l01321">NetConn_ReceivedMessage()</a>.</p>

</div>
</div>
<a id="a31f0f56ef0e8867e2bae48ad0c12eb7c" name="a31f0f56ef0e8867e2bae48ad0c12eb7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31f0f56ef0e8867e2bae48ad0c12eb7c">&#9670;&#160;</a></span>Crypto_EncryptPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> * Crypto_EncryptPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td>
          <td class="paramname"><em>crypto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01527">1527</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1528</span>{</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> h[32];</div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordflow">if</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a>)</div>
<div class="line"><span class="lineno"> 1532</span>    {</div>
<div class="line"><span class="lineno"> 1533</span>        <span class="keywordflow">if</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a>)</div>
<div class="line"><span class="lineno"> 1534</span>        {</div>
<div class="line"><span class="lineno"> 1535</span>            <span class="comment">// AES packet = 1 byte length overhead, 15 bytes from HMAC-SHA-256, data, 0..15 bytes padding</span></div>
<div class="line"><span class="lineno"> 1536</span>            <span class="comment">// 15 bytes HMAC-SHA-256 (112bit) suffice as the attacker can&#39;t do more than forge a random-looking packet</span></div>
<div class="line"><span class="lineno"> 1537</span>            <span class="comment">// HMAC is needed to not leak information about packet content</span></div>
<div class="line"><span class="lineno"> 1538</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="netconn_8c.html#a6ec6ab811f71ef2e66d3aa1710c0a095">developer_networking</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno"> 1539</span>            {</div>
<div class="line"><span class="lineno"> 1540</span>                <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;To be encrypted:\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1541</span>                <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1542</span>            }</div>
<div class="line"><span class="lineno"> 1543</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> + 32 &gt; len || !<a class="code hl_define" href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a>(h, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>))</div>
<div class="line"><span class="lineno"> 1544</span>            {</div>
<div class="line"><span class="lineno"> 1545</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_EncryptPacket failed (not enough space: %d bytes in, %d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1546</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1547</span>            }</div>
<div class="line"><span class="lineno"> 1548</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = ((<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> + 15) / 16) * 16 + 16; <span class="comment">// add 16 for HMAC, then round to 16-size for AES</span></div>
<div class="line"><span class="lineno"> 1549</span>            ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>)[0] = (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>)(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1550</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>)+1, h, 15);</div>
<div class="line"><span class="lineno"> 1551</span>            <a class="code hl_function" href="crypto_8c.html#add3d6a3c0d2952e5dfdd43ad262d46dc">aescpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>) + 16, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1552</span>            <span class="comment">//                    IV                                dst                                src                               len</span></div>
<div class="line"><span class="lineno"> 1553</span>        }</div>
<div class="line"><span class="lineno"> 1554</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1555</span>        {</div>
<div class="line"><span class="lineno"> 1556</span>            <span class="comment">// HMAC packet = 16 bytes HMAC-SHA-256 (truncated to 128 bits), data</span></div>
<div class="line"><span class="lineno"> 1557</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> + 16 &gt; len || !<a class="code hl_define" href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a>(h, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>))</div>
<div class="line"><span class="lineno"> 1558</span>            {</div>
<div class="line"><span class="lineno"> 1559</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_EncryptPacket failed (not enough space: %d bytes in, %d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1560</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1561</span>            }</div>
<div class="line"><span class="lineno"> 1562</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> + 16;</div>
<div class="line"><span class="lineno"> 1563</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, h, 16);</div>
<div class="line"><span class="lineno"> 1564</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>) + 16, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1565</span> </div>
<div class="line"><span class="lineno"> 1566</span>            <span class="comment">// handle the &quot;avoid&quot; conditions:</span></div>
<div class="line"><span class="lineno"> 1567</span>            <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code hl_function" href="com__msg_8c.html#acd30e83205c1a8193744237c44ad0f01">BuffBigLong</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>);</div>
<div class="line"><span class="lineno"> 1568</span>            <span class="keywordflow">if</span>(</div>
<div class="line"><span class="lineno"> 1569</span>                (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0xFFFFFFFF) <span class="comment">// avoid QW control packet</span></div>
<div class="line"><span class="lineno"> 1570</span>                ||</div>
<div class="line"><span class="lineno"> 1571</span>                (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0x80000000 + (<span class="keywordtype">int</span>)*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>) <span class="comment">// avoid NQ control packet</span></div>
<div class="line"><span class="lineno"> 1572</span>            )</div>
<div class="line"><span class="lineno"> 1573</span>                *(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a> ^= 0x80; <span class="comment">// this will ALWAYS fix it</span></div>
<div class="line"><span class="lineno"> 1574</span>        }</div>
<div class="line"><span class="lineno"> 1575</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>;</div>
<div class="line"><span class="lineno"> 1576</span>    }</div>
<div class="line"><span class="lineno"> 1577</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1578</span>    {</div>
<div class="line"><span class="lineno"> 1579</span>        *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>;</div>
<div class="line"><span class="lineno"> 1580</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>;</div>
<div class="line"><span class="lineno"> 1581</span>    }</div>
<div class="line"><span class="lineno"> 1582</span>}</div>
<div class="ttc" id="acrypto_8c_html_add3d6a3c0d2952e5dfdd43ad262d46dc"><div class="ttname"><a href="crypto_8c.html#add3d6a3c0d2952e5dfdd43ad262d46dc">aescpy</a></div><div class="ttdeci">static void aescpy(unsigned char *key, const unsigned char *iv, unsigned char *dst, const unsigned char *src, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01472">crypto.c:1472</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l01321">NetConn_ReceivedMessage()</a>, and <a class="el" href="netconn_8c_source.html#l00834">NetConn_SendUnreliableMessage()</a>.</p>

</div>
</div>
<a id="a92f36accfee208af75781980dea33821" name="a92f36accfee208af75781980dea33821"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92f36accfee208af75781980dea33821">&#9670;&#160;</a></span>Crypto_FinishInstance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_FinishInstance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00558">558</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  559</span>{</div>
<div class="line"><span class="lineno">  560</span>    <span class="comment">// no check needed here (returned pointers are only used in prefilled fields)</span></div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordflow">if</span>(!crypto || !crypto-&gt;authenticated)</div>
<div class="line"><span class="lineno">  562</span>    {</div>
<div class="line"><span class="lineno">  563</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Passed an invalid crypto connect instance\n&quot;</span>);</div>
<div class="line"><span class="lineno">  564</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, 0, <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>));</div>
<div class="line"><span class="lineno">  565</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  566</span>    }</div>
<div class="line"><span class="lineno">  567</span>    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno">  568</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, crypto, <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>));</div>
<div class="line"><span class="lineno">  569</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(crypto, 0, <span class="keyword">sizeof</span>(*crypto));</div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  571</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l01631">NetConn_ConnectionEstablished()</a>, and <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="ae0a13832c196fc6cb7e25fd6f55aa489" name="ae0a13832c196fc6cb7e25fd6f55aa489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0a13832c196fc6cb7e25fd6f55aa489">&#9670;&#160;</a></span>Crypto_GetInfoResponseDataString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> * Crypto_GetInfoResponseDataString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01689">1689</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1690</span>{</div>
<div class="line"><span class="lineno"> 1691</span>    <a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>[0] = <span class="charliteral">&#39;0&#39;</span> + <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>;</div>
<div class="line"><span class="lineno"> 1692</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a>;</div>
<div class="line"><span class="lineno"> 1693</span>}</div>
<div class="ttc" id="acrypto_8c_html_a63426ba3da78d70b38153267dbe74ccc"><div class="ttname"><a href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a></div><div class="ttdeci">static char crypto_idstring_buf[512]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00043">crypto.c:43</a></div></div>
<div class="ttc" id="acrypto_8c_html_a9e167138d96bd0023ba86e401f27253a"><div class="ttname"><a href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a></div><div class="ttdeci">static const char * crypto_idstring</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00042">crypto.c:42</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l02706">NetConn_BuildStatusResponse()</a>.</p>

</div>
</div>
<a id="ac8e05ee4f38d1d5a579abfe2980e370f" name="ac8e05ee4f38d1d5a579abfe2980e370f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e05ee4f38d1d5a579abfe2980e370f">&#9670;&#160;</a></span>Crypto_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01072">1072</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1073</span>{</div>
<div class="line"><span class="lineno"> 1074</span>    <a class="code hl_variable" href="crypto_8c.html#a473d64350b7902deaac13e21f96f11d8">cryptomempool</a> = <a class="code hl_define" href="zone_8h.html#a7da6ffdd01b3d31cb7c89e68fad87d0d">Mem_AllocPool</a>(<span class="stringliteral">&quot;crypto&quot;</span>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1075</span> </div>
<div class="line"><span class="lineno"> 1076</span>    <span class="keywordflow">if</span>(!<a class="code hl_function" href="crypto_8c.html#a6cc7bf287af177afa9b29d2e79ef0559">Crypto_OpenLibrary</a>())</div>
<div class="line"><span class="lineno"> 1077</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>    <a class="code hl_variable" href="crypto_8c.html#a690b3fafb6357836766ea72705753a4f">qd0_blind_id_setmallocfuncs</a>(<a class="code hl_function" href="crypto_8c.html#ad3e46b0be825db44980c41f18e4a27ea">Crypto_d0_malloc</a>, <a class="code hl_function" href="crypto_8c.html#a04461f04f135ed9168b3635769dfd3fb">Crypto_d0_free</a>);</div>
<div class="line"><span class="lineno"> 1080</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="thread_8h.html#a4af21639b1ace74ffbc47e953f7a0970">Thread_HasThreads</a>())</div>
<div class="line"><span class="lineno"> 1081</span>        <a class="code hl_variable" href="crypto_8c.html#afed7aa781c8545c1333c525f437aa7fc">qd0_blind_id_setmutexfuncs</a>(<a class="code hl_function" href="crypto_8c.html#aef1ead9aff323c67f6ea971213af9b87">Crypto_d0_createmutex</a>, <a class="code hl_function" href="crypto_8c.html#a2a246f3b70ce88542638a2e60c057921">Crypto_d0_destroymutex</a>, <a class="code hl_function" href="crypto_8c.html#a451c6225535919e74dc187635381c137">Crypto_d0_lockmutex</a>, <a class="code hl_function" href="crypto_8c.html#abf9cffdca970c75960fb23d63552825b">Crypto_d0_unlockmutex</a>);</div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a769580f1e63f2603aa90bb8986ac3ef3">qd0_blind_id_INITIALIZE</a>())</div>
<div class="line"><span class="lineno"> 1084</span>    {</div>
<div class="line"><span class="lineno"> 1085</span>        <a class="code hl_function" href="crypto_8c.html#aad54f544f3250410db6aff02f795c322">Crypto_Rijndael_CloseLibrary</a>();</div>
<div class="line"><span class="lineno"> 1086</span>        <a class="code hl_function" href="crypto_8c.html#acdd38a734f1d86b5075d6d6a82c71b7b">Crypto_CloseLibrary</a>();</div>
<div class="line"><span class="lineno"> 1087</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;libd0_blind_id initialization FAILED, cryptography support has been disabled\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1088</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1089</span>    }</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>    (<a class="code hl_function" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>) <a class="code hl_function" href="crypto_8c.html#aa266b054915a179b802f7177d59e58e9">Crypto_Rijndael_OpenLibrary</a>(); <span class="comment">// if this fails, it&#39;s uncritical</span></div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    <a class="code hl_function" href="crypto_8c.html#a4c96b96431f5c4f965baa36a690a851e">Crypto_InitHostKeys</a>();</div>
<div class="line"><span class="lineno"> 1094</span>}</div>
<div class="ttc" id="acrypto_8c_html_a04461f04f135ed9168b3635769dfd3fb"><div class="ttname"><a href="crypto_8c.html#a04461f04f135ed9168b3635769dfd3fb">Crypto_d0_free</a></div><div class="ttdeci">static void Crypto_d0_free(void *p)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01015">crypto.c:1015</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2a246f3b70ce88542638a2e60c057921"><div class="ttname"><a href="crypto_8c.html#a2a246f3b70ce88542638a2e60c057921">Crypto_d0_destroymutex</a></div><div class="ttdeci">static void Crypto_d0_destroymutex(void *m)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01025">crypto.c:1025</a></div></div>
<div class="ttc" id="acrypto_8c_html_a451c6225535919e74dc187635381c137"><div class="ttname"><a href="crypto_8c.html#a451c6225535919e74dc187635381c137">Crypto_d0_lockmutex</a></div><div class="ttdeci">static int Crypto_d0_lockmutex(void *m)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01030">crypto.c:1030</a></div></div>
<div class="ttc" id="acrypto_8c_html_a473d64350b7902deaac13e21f96f11d8"><div class="ttname"><a href="crypto_8c.html#a473d64350b7902deaac13e21f96f11d8">cryptomempool</a></div><div class="ttdeci">static mempool_t * cryptomempool</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01004">crypto.c:1004</a></div></div>
<div class="ttc" id="acrypto_8c_html_a4c96b96431f5c4f965baa36a690a851e"><div class="ttname"><a href="crypto_8c.html#a4c96b96431f5c4f965baa36a690a851e">Crypto_InitHostKeys</a></div><div class="ttdeci">static void Crypto_InitHostKeys(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00591">crypto.c:591</a></div></div>
<div class="ttc" id="acrypto_8c_html_a690b3fafb6357836766ea72705753a4f"><div class="ttname"><a href="crypto_8c.html#a690b3fafb6357836766ea72705753a4f">qd0_blind_id_setmallocfuncs</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_setmallocfuncs)(d0_malloc_t *m, d0_free_t *f)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00233">crypto.c:233</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6cc7bf287af177afa9b29d2e79ef0559"><div class="ttname"><a href="crypto_8c.html#a6cc7bf287af177afa9b29d2e79ef0559">Crypto_OpenLibrary</a></div><div class="ttdeci">static qbool Crypto_OpenLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00283">crypto.c:283</a></div></div>
<div class="ttc" id="acrypto_8c_html_a769580f1e63f2603aa90bb8986ac3ef3"><div class="ttname"><a href="crypto_8c.html#a769580f1e63f2603aa90bb8986ac3ef3">qd0_blind_id_INITIALIZE</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_INITIALIZE)(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00228">crypto.c:228</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa266b054915a179b802f7177d59e58e9"><div class="ttname"><a href="crypto_8c.html#aa266b054915a179b802f7177d59e58e9">Crypto_Rijndael_OpenLibrary</a></div><div class="ttdeci">static qbool Crypto_Rijndael_OpenLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00352">crypto.c:352</a></div></div>
<div class="ttc" id="acrypto_8c_html_aad54f544f3250410db6aff02f795c322"><div class="ttname"><a href="crypto_8c.html#aad54f544f3250410db6aff02f795c322">Crypto_Rijndael_CloseLibrary</a></div><div class="ttdeci">static void Crypto_Rijndael_CloseLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00375">crypto.c:375</a></div></div>
<div class="ttc" id="acrypto_8c_html_abf9cffdca970c75960fb23d63552825b"><div class="ttname"><a href="crypto_8c.html#abf9cffdca970c75960fb23d63552825b">Crypto_d0_unlockmutex</a></div><div class="ttdeci">static int Crypto_d0_unlockmutex(void *m)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01035">crypto.c:1035</a></div></div>
<div class="ttc" id="acrypto_8c_html_acdd38a734f1d86b5075d6d6a82c71b7b"><div class="ttname"><a href="crypto_8c.html#acdd38a734f1d86b5075d6d6a82c71b7b">Crypto_CloseLibrary</a></div><div class="ttdeci">static void Crypto_CloseLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00306">crypto.c:306</a></div></div>
<div class="ttc" id="acrypto_8c_html_ad3e46b0be825db44980c41f18e4a27ea"><div class="ttname"><a href="crypto_8c.html#ad3e46b0be825db44980c41f18e4a27ea">Crypto_d0_malloc</a></div><div class="ttdeci">static void * Crypto_d0_malloc(size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01010">crypto.c:1010</a></div></div>
<div class="ttc" id="acrypto_8c_html_aef1ead9aff323c67f6ea971213af9b87"><div class="ttname"><a href="crypto_8c.html#aef1ead9aff323c67f6ea971213af9b87">Crypto_d0_createmutex</a></div><div class="ttdeci">static void * Crypto_d0_createmutex(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01020">crypto.c:1020</a></div></div>
<div class="ttc" id="acrypto_8c_html_afed7aa781c8545c1333c525f437aa7fc"><div class="ttname"><a href="crypto_8c.html#afed7aa781c8545c1333c525f437aa7fc">qd0_blind_id_setmutexfuncs</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_setmutexfuncs)(d0_createmutex_t *c, d0_destroymutex_t *d, d0_lockmutex_t *l, d0_unlockmutex_t *u)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00234">crypto.c:234</a></div></div>
<div class="ttc" id="aglquake_8h_html_afa45fc0640b31002c1792c59eb062c59"><div class="ttname"><a href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a></div><div class="ttdeci">void(GLAPIENTRY *qglActiveTexture)(GLenum texture)</div></div>
<div class="ttc" id="athread_8h_html_a4af21639b1ace74ffbc47e953f7a0970"><div class="ttname"><a href="thread_8h.html#a4af21639b1ace74ffbc47e953f7a0970">Thread_HasThreads</a></div><div class="ttdeci">qbool Thread_HasThreads(void)</div><div class="ttdef"><b>Definition</b> <a href="thread__null_8c_source.html#l00013">thread_null.c:13</a></div></div>
<div class="ttc" id="azone_8h_html_a7da6ffdd01b3d31cb7c89e68fad87d0d"><div class="ttname"><a href="zone_8h.html#a7da6ffdd01b3d31cb7c89e68fad87d0d">Mem_AllocPool</a></div><div class="ttdeci">#define Mem_AllocPool(name, flags, parent)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00104">zone.h:104</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="host_8c_source.html#l00370">Host_Init()</a>.</p>

</div>
</div>
<a id="a2dc22d3a48652b22d43fb40e750e4cd4" name="a2dc22d3a48652b22d43fb40e750e4cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc22d3a48652b22d43fb40e750e4cd4">&#9670;&#160;</a></span>Crypto_Init_Commands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Init_Commands </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01449">1449</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1450</span>{</div>
<div class="line"><span class="lineno"> 1451</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1452</span>    {</div>
<div class="line"><span class="lineno"> 1453</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_reload&quot;</span>, <a class="code hl_function" href="crypto_8c.html#a2face099d8db579f04009cc115b4b7b2">Crypto_Reload_f</a>, <span class="stringliteral">&quot;reloads cryptographic keys&quot;</span>);</div>
<div class="line"><span class="lineno"> 1454</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_keygen&quot;</span>, <a class="code hl_function" href="crypto_8c.html#ad3f9b2a112d3766361cf97490ac6fb0e">Crypto_KeyGen_f</a>, <span class="stringliteral">&quot;generates and saves a cryptographic key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1455</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_keys&quot;</span>, <a class="code hl_function" href="crypto_8c.html#ada60652b956c044bd851cbc63d2b6b2c">Crypto_Keys_f</a>, <span class="stringliteral">&quot;lists the loaded keys&quot;</span>);</div>
<div class="line"><span class="lineno"> 1456</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_hostkeys&quot;</span>, <a class="code hl_function" href="crypto_8c.html#a9fb12a2be57fc3c4742ea681e22e7708">Crypto_HostKeys_f</a>, <span class="stringliteral">&quot;lists the cached host keys&quot;</span>);</div>
<div class="line"><span class="lineno"> 1457</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_hostkey_clear&quot;</span>, <a class="code hl_function" href="crypto_8c.html#ada3befbe537d810f7aaf3d498ec6823c">Crypto_HostKey_Clear_f</a>, <span class="stringliteral">&quot;clears a cached host key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>        <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a6f3d29a8d2e8a24dc51d47cba14aef9e">crypto_developer</a>);</div>
<div class="line"><span class="lineno"> 1460</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>)</div>
<div class="line"><span class="lineno"> 1461</span>            <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>);</div>
<div class="line"><span class="lineno"> 1462</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1463</span>            <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> = 0; <span class="comment">// make sure</span></div>
<div class="line"><span class="lineno"> 1464</span>        <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a>);</div>
<div class="line"><span class="lineno"> 1465</span>        <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>);</div>
<div class="line"><span class="lineno"> 1466</span>        <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a>);</div>
<div class="line"><span class="lineno"> 1467</span>    }</div>
<div class="line"><span class="lineno"> 1468</span>}</div>
<div class="ttc" id="acmd_8c_html_a86fa905462db75436af48f27298204e5"><div class="ttname"><a href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a></div><div class="ttdeci">void Cmd_AddCommand(unsigned flags, const char *cmd_name, xcommand_t function, const char *description)</div><div class="ttdoc">called by the init functions of other parts of the program to register commands and functions to call...</div><div class="ttdef"><b>Definition</b> <a href="cmd_8c_source.html#l01754">cmd.c:1754</a></div></div>
<div class="ttc" id="acmd_8h_html_a28392de86e1ad57dd3fa7870a23367f2"><div class="ttname"><a href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a></div><div class="ttdeci">#define CF_SHARED</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00067">cmd.h:67</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2face099d8db579f04009cc115b4b7b2"><div class="ttname"><a href="crypto_8c.html#a2face099d8db579f04009cc115b4b7b2">Crypto_Reload_f</a></div><div class="ttdeci">static void Crypto_Reload_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01373">crypto.c:1373</a></div></div>
<div class="ttc" id="acrypto_8c_html_a60a6b08ba933d05ae0ba07ba429fe03e"><div class="ttname"><a href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a></div><div class="ttdeci">cvar_t crypto_servercpupercent</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00033">crypto.c:33</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6f3d29a8d2e8a24dc51d47cba14aef9e"><div class="ttname"><a href="crypto_8c.html#a6f3d29a8d2e8a24dc51d47cba14aef9e">crypto_developer</a></div><div class="ttdeci">cvar_t crypto_developer</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00030">crypto.c:30</a></div></div>
<div class="ttc" id="acrypto_8c_html_a802583bf599735ca3f90741d55954864"><div class="ttname"><a href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a></div><div class="ttdeci">cvar_t crypto_servercpumaxtime</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00034">crypto.c:34</a></div></div>
<div class="ttc" id="acrypto_8c_html_a90ed817e2c4e40c2d34af9d37e7edd64"><div class="ttname"><a href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a></div><div class="ttdeci">cvar_t crypto_servercpudebug</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00035">crypto.c:35</a></div></div>
<div class="ttc" id="acrypto_8c_html_a9fb12a2be57fc3c4742ea681e22e7708"><div class="ttname"><a href="crypto_8c.html#a9fb12a2be57fc3c4742ea681e22e7708">Crypto_HostKeys_f</a></div><div class="ttdeci">static void Crypto_HostKeys_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01403">crypto.c:1403</a></div></div>
<div class="ttc" id="acrypto_8c_html_ad3f9b2a112d3766361cf97490ac6fb0e"><div class="ttname"><a href="crypto_8c.html#ad3f9b2a112d3766361cf97490ac6fb0e">Crypto_KeyGen_f</a></div><div class="ttdeci">static void Crypto_KeyGen_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01217">crypto.c:1217</a></div></div>
<div class="ttc" id="acrypto_8c_html_ada3befbe537d810f7aaf3d498ec6823c"><div class="ttname"><a href="crypto_8c.html#ada3befbe537d810f7aaf3d498ec6823c">Crypto_HostKey_Clear_f</a></div><div class="ttdeci">static void Crypto_HostKey_Clear_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01428">crypto.c:1428</a></div></div>
<div class="ttc" id="acrypto_8c_html_ada60652b956c044bd851cbc63d2b6b2c"><div class="ttname"><a href="crypto_8c.html#ada60652b956c044bd851cbc63d2b6b2c">Crypto_Keys_f</a></div><div class="ttdeci">static void Crypto_Keys_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01380">crypto.c:1380</a></div></div>
<div class="ttc" id="acvar_8c_html_a9bd27026ed325ffe5276549c11c7379d"><div class="ttname"><a href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a></div><div class="ttdeci">void Cvar_RegisterVariable(cvar_t *variable)</div><div class="ttdoc">registers a cvar that already has the name, string, and optionally the archive elements set.</div><div class="ttdef"><b>Definition</b> <a href="cvar_8c_source.html#l00599">cvar.c:599</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="host_8c_source.html#l00370">Host_Init()</a>.</p>

</div>
</div>
<a id="a1e6cc26fc4d71eacae07453774cf06de" name="a1e6cc26fc4d71eacae07453774cf06de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6cc26fc4d71eacae07453774cf06de">&#9670;&#160;</a></span>Crypto_LoadKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_LoadKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00855">855</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  856</span>{</div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[8192];</div>
<div class="line"><span class="lineno">  858</span>    <span class="keywordtype">size_t</span> len, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a>;</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  860</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>) <span class="comment">// don&#39;t if we can&#39;t</span></div>
<div class="line"><span class="lineno">  863</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a>) <span class="comment">// already loaded? then not</span></div>
<div class="line"><span class="lineno">  866</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>    <a class="code hl_function" href="host_8c.html#a081ad1e5d6023d86cb59fe79737e16ae">Host_LockSession</a>(); <span class="comment">// we use the session ID here</span></div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>    <span class="comment">// load keys</span></div>
<div class="line"><span class="lineno">  871</span>    <span class="comment">// note: we are just a CLIENT</span></div>
<div class="line"><span class="lineno">  872</span>    <span class="comment">// so we load:</span></div>
<div class="line"><span class="lineno">  873</span>    <span class="comment">//   PUBLIC KEYS to accept (including modulus)</span></div>
<div class="line"><span class="lineno">  874</span>    <span class="comment">//   PRIVATE KEY of user</span></div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  877</span>    {</div>
<div class="line"><span class="lineno">  878</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><span class="lineno">  879</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><span class="lineno">  880</span>        <a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  881</span>        <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  882</span>        len = <a class="code hl_function" href="crypto_8c.html#a6c6ceb1adf55efb9bc29eea8ba64fdad">Crypto_LoadFile</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;key_%d.d0pk&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  883</span>        <span class="keywordflow">if</span>((<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_function" href="crypto_8c.html#a5cb4a9947263eef8d464f94959d0411d">Crypto_ReadPublicKey</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, len)))</div>
<div class="line"><span class="lineno">  884</span>        {</div>
<div class="line"><span class="lineno">  885</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a> = <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>;</div>
<div class="line"><span class="lineno">  886</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a2f64f786d757a09a4e8c73edf953a466">qd0_blind_id_fingerprint64_public_key</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a>)) <span class="comment">// keeps final NUL</span></div>
<div class="line"><span class="lineno">  887</span>            {</div>
<div class="line"><span class="lineno">  888</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Loaded public key key_%d.d0pk (fingerprint: %s)\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  889</span>                len = <a class="code hl_function" href="crypto_8c.html#a6c6ceb1adf55efb9bc29eea8ba64fdad">Crypto_LoadFile</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;key_%d.d0si%s&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>), <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  890</span>                <span class="keywordflow">if</span>(len)</div>
<div class="line"><span class="lineno">  891</span>                {</div>
<div class="line"><span class="lineno">  892</span>                    <span class="keywordflow">if</span>(<a class="code hl_function" href="crypto_8c.html#ae509f43bdccf26baf95b3ed68b24d750">Crypto_AddPrivateKey</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, len))</div>
<div class="line"><span class="lineno">  893</span>                    {</div>
<div class="line"><span class="lineno">  894</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a> = <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>;</div>
<div class="line"><span class="lineno">  895</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a>)) <span class="comment">// keeps final NUL</span></div>
<div class="line"><span class="lineno">  896</span>                        {</div>
<div class="line"><span class="lineno">  897</span>                            <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a> = 0;</div>
<div class="line"><span class="lineno">  898</span> </div>
<div class="line"><span class="lineno">  899</span>                            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Loaded private ID key_%d.d0si%s for key_%d.d0pk (public key fingerprint: %s)\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>                            <span class="comment">// verify the key we just loaded (just in case)</span></div>
<div class="line"><span class="lineno">  902</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a5d43fdd72f73796e0dbd984eae9347f4">qd0_blind_id_verify_private_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]) &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#a099d4d32154ed82ff5431ab675945965">qd0_blind_id_verify_public_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno">  903</span>                            {</div>
<div class="line"><span class="lineno">  904</span>                                <a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  905</span>                                <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>                                <span class="comment">// verify the key we just got (just in case)</span></div>
<div class="line"><span class="lineno">  908</span>                                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>)</div>
<div class="line"><span class="lineno">  909</span>                                    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;NOTE: this ID has not yet been signed!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>                                <a class="code hl_function" href="crypto_8c.html#ac8da1c183634a38674c81c765b2c8e42">Crypto_SavePubKeyTextFile</a>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><span class="lineno">  912</span>                            }</div>
<div class="line"><span class="lineno">  913</span>                            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  914</span>                            {</div>
<div class="line"><span class="lineno">  915</span>                                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_verify_private_id failed, this is not a valid key!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  916</span>                                <a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  917</span>                                <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  918</span>                            }</div>
<div class="line"><span class="lineno">  919</span>                        }</div>
<div class="line"><span class="lineno">  920</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  921</span>                        {</div>
<div class="line"><span class="lineno">  922</span>                            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_fingerprint64_public_id failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  923</span>                            <a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  924</span>                            <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  925</span>                        }</div>
<div class="line"><span class="lineno">  926</span>                    }</div>
<div class="line"><span class="lineno">  927</span>                }</div>
<div class="line"><span class="lineno">  928</span>            }</div>
<div class="line"><span class="lineno">  929</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  930</span>            {</div>
<div class="line"><span class="lineno">  931</span>                <span class="comment">// can&#39;t really happen</span></div>
<div class="line"><span class="lineno">  932</span>                <a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  933</span>                <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  934</span>            }</div>
<div class="line"><span class="lineno">  935</span>        }</div>
<div class="line"><span class="lineno">  936</span>    }</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>    <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno">  939</span>    <a class="code hl_function" href="crypto_8c.html#a7b037eca70363845b5621daa59b81f93">Crypto_BuildIdString</a>();</div>
<div class="line"><span class="lineno">  940</span>    <a class="code hl_function" href="crypto_8c.html#af4ea4fbb85d42f0fe445c6853deb27e3">Crypto_BuildChallengeAppend</a>();</div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>    <span class="comment">// find a good prefix length for all the keys we know (yes, algorithm is not perfect yet, may yield too long prefix length)</span></div>
<div class="line"><span class="lineno">  943</span>    <a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a> = 0;</div>
<div class="line"><span class="lineno">  944</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>+256, 0, <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>);</div>
<div class="line"><span class="lineno">  945</span>    <span class="keywordflow">while</span>(<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a> &lt; <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>)</div>
<div class="line"><span class="lineno">  946</span>    {</div>
<div class="line"><span class="lineno">  947</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, 0, 256);</div>
<div class="line"><span class="lineno">  948</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  949</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  950</span>            {</div>
<div class="line"><span class="lineno">  951</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  952</span>                    ++<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>) <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>]];</div>
<div class="line"><span class="lineno">  953</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  954</span>                    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  955</span>                        ++<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>) <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>]];</div>
<div class="line"><span class="lineno">  956</span>            }</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  958</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  959</span>            {</div>
<div class="line"><span class="lineno">  960</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  961</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>]] &lt; 2)</div>
<div class="line"><span class="lineno">  962</span>                        <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div>
<div class="line"><span class="lineno">  963</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  964</span>                    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  965</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>]] &lt; 2)</div>
<div class="line"><span class="lineno">  966</span>                            <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div>
<div class="line"><span class="lineno">  967</span>            }</div>
<div class="line"><span class="lineno">  968</span>        ++<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>;</div>
<div class="line"><span class="lineno">  969</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  970</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  971</span>            {</div>
<div class="line"><span class="lineno">  972</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  973</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  974</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  975</span>                    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  976</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  977</span>            }</div>
<div class="line"><span class="lineno">  978</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>)</div>
<div class="line"><span class="lineno">  979</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  980</span>    }</div>
<div class="line"><span class="lineno">  981</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a> &lt; 7)</div>
<div class="line"><span class="lineno">  982</span>        <a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a> = 7;</div>
<div class="line"><span class="lineno">  983</span>}</div>
<div class="ttc" id="acrypto_8c_html_a099d4d32154ed82ff5431ab675945965"><div class="ttname"><a href="crypto_8c.html#a099d4d32154ed82ff5431ab675945965">qd0_blind_id_verify_public_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_verify_public_id)(const d0_blind_id_t *ctx, D0_BOOL *status)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00235">crypto.c:235</a></div></div>
<div class="ttc" id="acrypto_8c_html_a28bce26dd18684379882653e173b0188"><div class="ttname"><a href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a></div><div class="ttdeci">int crypto_keyfp_recommended_length</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00041">crypto.c:41</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2f64f786d757a09a4e8c73edf953a466"><div class="ttname"><a href="crypto_8c.html#a2f64f786d757a09a4e8c73edf953a466">qd0_blind_id_fingerprint64_public_key</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_fingerprint64_public_key)(const d0_blind_id_t *ctx, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00208">crypto.c:208</a></div></div>
<div class="ttc" id="acrypto_8c_html_a5cb4a9947263eef8d464f94959d0411d"><div class="ttname"><a href="crypto_8c.html#a5cb4a9947263eef8d464f94959d0411d">Crypto_ReadPublicKey</a></div><div class="ttdeci">static d0_blind_id_t * Crypto_ReadPublicKey(char *buf, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00450">crypto.c:450</a></div></div>
<div class="ttc" id="acrypto_8c_html_a5d43fdd72f73796e0dbd984eae9347f4"><div class="ttname"><a href="crypto_8c.html#a5d43fdd72f73796e0dbd984eae9347f4">qd0_blind_id_verify_private_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_verify_private_id)(const d0_blind_id_t *ctx)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00236">crypto.c:236</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6aa92bfaaf0609b72efa4ee010523361"><div class="ttname"><a href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_free)(d0_blind_id_t *a)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00199">crypto.c:199</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6c6ceb1adf55efb9bc29eea8ba64fdad"><div class="ttname"><a href="crypto_8c.html#a6c6ceb1adf55efb9bc29eea8ba64fdad">Crypto_LoadFile</a></div><div class="ttdeci">static size_t Crypto_LoadFile(const char *path, char *buf, size_t nmax, qbool inuserdir)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00388">crypto.c:388</a></div></div>
<div class="ttc" id="acrypto_8c_html_a7b037eca70363845b5621daa59b81f93"><div class="ttname"><a href="crypto_8c.html#a7b037eca70363845b5621daa59b81f93">Crypto_BuildIdString</a></div><div class="ttdeci">static void Crypto_BuildIdString(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00842">crypto.c:842</a></div></div>
<div class="ttc" id="acrypto_8c_html_ac8da1c183634a38674c81c765b2c8e42"><div class="ttname"><a href="crypto_8c.html#ac8da1c183634a38674c81c765b2c8e42">Crypto_SavePubKeyTextFile</a></div><div class="ttdeci">static qbool Crypto_SavePubKeyTextFile(int i)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00814">crypto.c:814</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae509f43bdccf26baf95b3ed68b24d750"><div class="ttname"><a href="crypto_8c.html#ae509f43bdccf26baf95b3ed68b24d750">Crypto_AddPrivateKey</a></div><div class="ttdeci">static qbool Crypto_AddPrivateKey(d0_blind_id_t *pk, char *buf, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00469">crypto.c:469</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae660e3db5e569c5c606531a62f889148"><div class="ttname"><a href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a></div><div class="ttdeci">static int keygen_i</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00490">crypto.c:490</a></div></div>
<div class="ttc" id="acrypto_8c_html_af4ea4fbb85d42f0fe445c6853deb27e3"><div class="ttname"><a href="crypto_8c.html#af4ea4fbb85d42f0fe445c6853deb27e3">Crypto_BuildChallengeAppend</a></div><div class="ttdeci">static void Crypto_BuildChallengeAppend(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00785">crypto.c:785</a></div></div>
<div class="ttc" id="aglquake_8h_html_ac0759919bfcf4c7222738ba583673a9e"><div class="ttname"><a href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a></div><div class="ttdeci">GLenum GLuint GLenum GLsizei const GLchar * buf</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00656">glquake.h:656</a></div></div>
<div class="ttc" id="ahost_8c_html_a081ad1e5d6023d86cb59fe79737e16ae"><div class="ttname"><a href="host_8c.html#a081ad1e5d6023d86cb59fe79737e16ae">Host_LockSession</a></div><div class="ttdeci">void Host_LockSession(void)</div><div class="ttdef"><b>Definition</b> <a href="host_8c_source.html#l00323">host.c:323</a></div></div>
<div class="ttc" id="ahost_8c_html_a0ddc5c0baccb97e671b135bcf8d4e257"><div class="ttname"><a href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a></div><div class="ttdeci">cvar_t sessionid</div><div class="ttdef"><b>Definition</b> <a href="host_8c_source.html#l00059">host.c:59</a></div></div>
<div class="ttc" id="astructcvar__t_html_aa8b859b9332810d238c09b51ea54a2f4"><div class="ttname"><a href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">cvar_t::string</a></div><div class="ttdeci">const char * string</div><div class="ttdef"><b>Definition</b> <a href="cvar_8h_source.html#l00071">cvar.h:71</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01373">Crypto_Reload_f()</a>, <a class="el" href="netconn_8c_source.html#l01088">NetConn_OpenClientPorts()</a>, <a class="el" href="netconn_8c_source.html#l01158">NetConn_OpenServerPorts()</a>, and <a class="el" href="prvm__edict_8c_source.html#l02002">PRVM_Prog_Load()</a>.</p>

</div>
</div>
<a id="adce90efb7c4830b9935bb56bef65b877" name="adce90efb7c4830b9935bb56bef65b877"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adce90efb7c4830b9935bb56bef65b877">&#9670;&#160;</a></span>Crypto_RetrieveHostKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_RetrieveHostKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lhnetaddress_s</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>keyfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>keyfplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>idfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>idfplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *&#160;</td>
          <td class="paramname"><em>aeslevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> *&#160;</td>
          <td class="paramname"><em>issigned</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a530db18ab03fe35200fa035277bc9b03" name="a530db18ab03fe35200fa035277bc9b03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530db18ab03fe35200fa035277bc9b03">&#9670;&#160;</a></span>Crypto_RetrieveLocalKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_RetrieveLocalKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>keyfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>keyfplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>idfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>idfplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> *&#160;</td>
          <td class="paramname"><em>issigned</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00763">763</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  764</span>{</div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyid &lt; 0 || keyid &gt;</a>= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>)</div>
<div class="line"><span class="lineno">  766</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>)</div>
<div class="line"><span class="lineno">  768</span>        *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a> = 0;</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">if</span>(idfp)</div>
<div class="line"><span class="lineno">  770</span>        *idfp = 0;</div>
<div class="line"><span class="lineno">  771</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[keyid])</div>
<div class="line"><span class="lineno">  772</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>)</div>
<div class="line"><span class="lineno">  774</span>        <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[keyid], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfplen</a>);</div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">if</span>(idfp)</div>
<div class="line"><span class="lineno">  776</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[keyid])</div>
<div class="line"><span class="lineno">  777</span>            <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(idfp, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[keyid], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idfplen</a>);</div>
<div class="line"><span class="lineno">  778</span>    <span class="keywordflow">if</span>(issigned)</div>
<div class="line"><span class="lineno">  779</span>        *issigned = <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[keyid];</div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  781</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mvm__cmds_8c_source.html#l00896">VM_M_crypto_getmyidfp()</a>, <a class="el" href="mvm__cmds_8c_source.html#l00918">VM_M_crypto_getmyidstatus()</a>, and <a class="el" href="mvm__cmds_8c_source.html#l00874">VM_M_crypto_getmykeyfp()</a>.</p>

</div>
</div>
<a id="a993fe4230d29c0de65f62c472d679cd0" name="a993fe4230d29c0de65f62c472d679cd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a993fe4230d29c0de65f62c472d679cd0">&#9670;&#160;</a></span>Crypto_ServerAppendToChallenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_ServerAppendToChallenge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>maxlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01696">1696</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1697</span>{</div>
<div class="line"><span class="lineno"> 1698</span>    <span class="comment">// cheap op, all is precomputed</span></div>
<div class="line"><span class="lineno"> 1699</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1700</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no support</span></div>
<div class="line"><span class="lineno"> 1701</span>    <span class="comment">// append challenge</span></div>
<div class="line"><span class="lineno"> 1702</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxlen_out</a> &lt;= *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> + <a class="code hl_variable" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a>)</div>
<div class="line"><span class="lineno"> 1703</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1704</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a> + *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="crypto_8c.html#a0a7166948fbca4aa370e98c8f64d139a">challenge_append</a>, <a class="code hl_variable" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a>);</div>
<div class="line"><span class="lineno"> 1705</span>    *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> += <a class="code hl_variable" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a>;</div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1707</span>}</div>
<div class="ttc" id="acrypto_8c_html_a0a7166948fbca4aa370e98c8f64d139a"><div class="ttname"><a href="crypto_8c.html#a0a7166948fbca4aa370e98c8f64d139a">challenge_append</a></div><div class="ttdeci">static char challenge_append[1400]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00487">crypto.c:487</a></div></div>
<div class="ttc" id="acrypto_8c_html_a5d332095b22ac949589bca1293869cb2"><div class="ttname"><a href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a></div><div class="ttdeci">static size_t challenge_append_length</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00488">crypto.c:488</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a141f05b8ac8247937791bff8aa8ccd37" name="a141f05b8ac8247937791bff8aa8ccd37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a141f05b8ac8247937791bff8aa8ccd37">&#9670;&#160;</a></span>Crypto_ServerGetInstance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcrypto__t.html">crypto_t</a> * Crypto_ServerGetInstance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lhnetaddress_s</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ace1b41f4cd5100f173da25da7f726a8f" name="ace1b41f4cd5100f173da25da7f726a8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace1b41f4cd5100f173da25da7f726a8f">&#9670;&#160;</a></span>Crypto_ServerParsePacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_ServerParsePacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02036">2036</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2037</span>{</div>
<div class="line"><span class="lineno"> 2038</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="shader__glsl_8h.html#a339672ff94e6199019102f50d317c3d7">ret</a>;</div>
<div class="line"><span class="lineno"> 2039</span>    <span class="keywordtype">double</span> t = 0;</div>
<div class="line"><span class="lineno"> 2040</span>    <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">complain_time</a> = 0;</div>
<div class="line"><span class="lineno"> 2041</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>;</div>
<div class="line"><span class="lineno"> 2042</span>    <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_time</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2043</span>    <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_reject</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2044</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>[<a class="code hl_define" href="qdefs_8h.html#a119f8457078d7390fb45ea0838adb806">MAX_INPUTLINE</a>];</div>
<div class="line"><span class="lineno"> 2045</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> &gt; 0 || <a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 2046</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt; 5 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <span class="stringliteral">&quot;d0pk\\&quot;</span>, 5))</div>
<div class="line"><span class="lineno"> 2047</span>        {</div>
<div class="line"><span class="lineno"> 2048</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_time</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2049</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a> = (<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> + 4, <span class="stringliteral">&quot;cnt&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)) ? <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a> : <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2050</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>)</div>
<div class="line"><span class="lineno"> 2051</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;0&quot;</span>))</div>
<div class="line"><span class="lineno"> 2052</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_reject</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2053</span>        }</div>
<div class="line"><span class="lineno"> 2054</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_time</a>)</div>
<div class="line"><span class="lineno"> 2055</span>    {</div>
<div class="line"><span class="lineno"> 2056</span>        <span class="comment">// check if we may perform crypto...</span></div>
<div class="line"><span class="lineno"> 2057</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 2058</span>        {</div>
<div class="line"><span class="lineno"> 2059</span>            <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> += (<a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> - <a class="code hl_variable" href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a>) * <a class="code hl_variable" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> * 0.01;</div>
<div class="line"><span class="lineno"> 2060</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a>)</div>
<div class="line"><span class="lineno"> 2061</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> &gt; <a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a>)</div>
<div class="line"><span class="lineno"> 2062</span>                    <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> = <a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a>;</div>
<div class="line"><span class="lineno"> 2063</span>        }</div>
<div class="line"><span class="lineno"> 2064</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2065</span>        {</div>
<div class="line"><span class="lineno"> 2066</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 2067</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> != <a class="code hl_variable" href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a>)</div>
<div class="line"><span class="lineno"> 2068</span>                    <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> = <a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a>;</div>
<div class="line"><span class="lineno"> 2069</span>        }</div>
<div class="line"><span class="lineno"> 2070</span>        <a class="code hl_variable" href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a> = <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a>;</div>
<div class="line"><span class="lineno"> 2071</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_reject</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 2072</span>        {</div>
<div class="line"><span class="lineno"> 2073</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> &gt; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">complain_time</a> + 5)</div>
<div class="line"><span class="lineno"> 2074</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;crypto: cannot perform requested crypto operations; denial service attack or crypto_servercpupercent/crypto_servercpumaxtime are too low\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2075</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = 0;</div>
<div class="line"><span class="lineno"> 2076</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2077</span>        }</div>
<div class="line"><span class="lineno"> 2078</span>        t = <a class="code hl_function" href="sys_8h.html#aa0fbad346b8cec314ebf444c564ffa02">Sys_DirtyTime</a>();</div>
<div class="line"><span class="lineno"> 2079</span>    }</div>
<div class="line"><span class="lineno"> 2080</span>    <a class="code hl_variable" href="shader__glsl_8h.html#a339672ff94e6199019102f50d317c3d7">ret</a> = <a class="code hl_function" href="crypto_8c.html#a54bf4c38d481347e97316d106fb793f3">Crypto_ServerParsePacket_Internal</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, peeraddress);</div>
<div class="line"><span class="lineno"> 2081</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_time</a>)</div>
<div class="line"><span class="lineno"> 2082</span>    {</div>
<div class="line"><span class="lineno"> 2083</span>        t = <a class="code hl_function" href="sys_8h.html#aa0fbad346b8cec314ebf444c564ffa02">Sys_DirtyTime</a>() - t;<span class="keywordflow">if</span> (t &lt; 0.0) t = 0.0; <span class="comment">// dirtytime can step backwards</span></div>
<div class="line"><span class="lineno"> 2084</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno"> 2085</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;crypto: accumulator was %.1f ms, used %.1f ms for crypto, &quot;</span>, <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> * 1000, t * 1000);</div>
<div class="line"><span class="lineno"> 2086</span>        <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> -= t;</div>
<div class="line"><span class="lineno"> 2087</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno"> 2088</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;is %.1f ms\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> * 1000);</div>
<div class="line"><span class="lineno"> 2089</span>    }</div>
<div class="line"><span class="lineno"> 2090</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="shader__glsl_8h.html#a339672ff94e6199019102f50d317c3d7">ret</a>;</div>
<div class="line"><span class="lineno"> 2091</span>}</div>
<div class="ttc" id="acrypto_8c_html_a1310a98c3e1b982d484654a27f259671"><div class="ttname"><a href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a></div><div class="ttdeci">static double crypto_servercpu_accumulator</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00036">crypto.c:36</a></div></div>
<div class="ttc" id="acrypto_8c_html_a481f329d6a8171607db23fb324302b70"><div class="ttname"><a href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a></div><div class="ttdeci">static double crypto_servercpu_lastrealtime</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00037">crypto.c:37</a></div></div>
<div class="ttc" id="acrypto_8c_html_a54bf4c38d481347e97316d106fb793f3"><div class="ttname"><a href="crypto_8c.html#a54bf4c38d481347e97316d106fb793f3">Crypto_ServerParsePacket_Internal</a></div><div class="ttdeci">static int Crypto_ServerParsePacket_Internal(const char *data_in, size_t len_in, char *data_out, size_t *len_out, lhnetaddress_t *peeraddress)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01727">crypto.c:1727</a></div></div>
<div class="ttc" id="ashader__glsl_8h_html_a339672ff94e6199019102f50d317c3d7"><div class="ttname"><a href="shader__glsl_8h.html#a339672ff94e6199019102f50d317c3d7">ret</a></div><div class="ttdeci">return ret</div><div class="ttdef"><b>Definition</b> <a href="shader__glsl_8h_source.html#l00297">shader_glsl.h:297</a></div></div>
<div class="ttc" id="astructcvar__t_html_a305faa0167494135297f1b8e6216d469"><div class="ttname"><a href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">cvar_t::value</a></div><div class="ttdeci">float value</div><div class="ttdef"><b>Definition</b> <a href="cvar_8h_source.html#l00074">cvar.h:74</a></div></div>
<div class="ttc" id="asys_8h_html_aa0fbad346b8cec314ebf444c564ffa02"><div class="ttname"><a href="sys_8h.html#aa0fbad346b8cec314ebf444c564ffa02">Sys_DirtyTime</a></div><div class="ttdeci">double Sys_DirtyTime(void)</div><div class="ttdef"><b>Definition</b> <a href="sys__shared_8c_source.html#l00375">sys_shared.c:375</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="aa55a704ba907e52ab40b463e8dcdee49" name="aa55a704ba907e52ab40b463e8dcdee49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa55a704ba907e52ab40b463e8dcdee49">&#9670;&#160;</a></span>Crypto_Shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01043">1043</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1044</span>{</div>
<div class="line"><span class="lineno"> 1045</span>    <a class="code hl_struct" href="structcrypto__t.html">crypto_t</a> *crypto;</div>
<div class="line"><span class="lineno"> 1046</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>    <a class="code hl_function" href="crypto_8c.html#aad54f544f3250410db6aff02f795c322">Crypto_Rijndael_CloseLibrary</a>();</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1051</span>    {</div>
<div class="line"><span class="lineno"> 1052</span>        <span class="comment">// free memory</span></div>
<div class="line"><span class="lineno"> 1053</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1054</span>        {</div>
<div class="line"><span class="lineno"> 1055</span>            crypto = &amp;<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code hl_variable" href="structserver__cryptoconnect__t.html#a0619ecaf62b280776937a4125c543ad2">crypto</a>;</div>
<div class="line"><span class="lineno"> 1056</span>            <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1057</span>        }</div>
<div class="line"><span class="lineno"> 1058</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>));</div>
<div class="line"><span class="lineno"> 1059</span>        crypto = &amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a6b1b21c226c99c9d1e972dc080ee1855">crypto</a>;</div>
<div class="line"><span class="lineno"> 1060</span>        <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>        <a class="code hl_function" href="crypto_8c.html#ab82a547776a3b80b6f0a2c04b428e49b">Crypto_UnloadKeys</a>();</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>        <a class="code hl_variable" href="crypto_8c.html#a71fc08325ecf3532fc19e05a46b2d295">qd0_blind_id_SHUTDOWN</a>();</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>        <a class="code hl_function" href="crypto_8c.html#acdd38a734f1d86b5075d6d6a82c71b7b">Crypto_CloseLibrary</a>();</div>
<div class="line"><span class="lineno"> 1067</span>    }</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>    <a class="code hl_define" href="zone_8h.html#a07374e605d328a588d2d738a56608ead">Mem_FreePool</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a473d64350b7902deaac13e21f96f11d8">cryptomempool</a>);</div>
<div class="line"><span class="lineno"> 1070</span>}</div>
<div class="ttc" id="acrypto_8c_html_a0227d3cfd03cca7f1cb298e750152c61"><div class="ttname"><a href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a></div><div class="ttdeci">#define MAX_CRYPTOCONNECTS</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00493">crypto.c:493</a></div></div>
<div class="ttc" id="acrypto_8c_html_a71fc08325ecf3532fc19e05a46b2d295"><div class="ttname"><a href="crypto_8c.html#a71fc08325ecf3532fc19e05a46b2d295">qd0_blind_id_SHUTDOWN</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_SHUTDOWN)(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00229">crypto.c:229</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa4630d2842fd947361b293e0102b7205"><div class="ttname"><a href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a></div><div class="ttdeci">static server_cryptoconnect_t cryptoconnects[MAX_CRYPTOCONNECTS]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00507">crypto.c:507</a></div></div>
<div class="ttc" id="acrypto_8c_html_ab82a547776a3b80b6f0a2c04b428e49b"><div class="ttname"><a href="crypto_8c.html#ab82a547776a3b80b6f0a2c04b428e49b">Crypto_UnloadKeys</a></div><div class="ttdeci">static void Crypto_UnloadKeys(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00985">crypto.c:985</a></div></div>
<div class="ttc" id="astructserver__cryptoconnect__t_html_a0619ecaf62b280776937a4125c543ad2"><div class="ttname"><a href="structserver__cryptoconnect__t.html#a0619ecaf62b280776937a4125c543ad2">server_cryptoconnect_t::crypto</a></div><div class="ttdeci">crypto_t crypto</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00503">crypto.c:503</a></div></div>
<div class="ttc" id="azone_8h_html_a07374e605d328a588d2d738a56608ead"><div class="ttname"><a href="zone_8h.html#a07374e605d328a588d2d738a56608ead">Mem_FreePool</a></div><div class="ttdeci">#define Mem_FreePool(pool)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00105">zone.h:105</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="host_8c_source.html#l00569">Host_Shutdown()</a>.</p>

</div>
</div>
<a id="a3f6808cc09c495f2c6eb4bdf1eedbd68" name="a3f6808cc09c495f2c6eb4bdf1eedbd68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f6808cc09c495f2c6eb4bdf1eedbd68">&#9670;&#160;</a></span>Crypto_SignData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> Crypto_SignData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>datasize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>signed_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>signed_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02634">2634</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2635</span>{</div>
<div class="line"><span class="lineno"> 2636</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyid &lt; 0 || keyid &gt;</a>= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>)</div>
<div class="line"><span class="lineno"> 2637</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2638</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[keyid])</div>
<div class="line"><span class="lineno"> 2639</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2640</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a053fe3ee2c82148ddb847da9f7e20f71">qd0_blind_id_sign_with_private_id_sign</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[keyid], <span class="keyword">true</span>, <span class="keyword">false</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">datasize</a>, (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_data</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>))</div>
<div class="line"><span class="lineno"> 2641</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>;</div>
<div class="line"><span class="lineno"> 2642</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2643</span>}</div>
<div class="ttc" id="acrypto_8c_html_a053fe3ee2c82148ddb847da9f7e20f71"><div class="ttname"><a href="crypto_8c.html#a053fe3ee2c82148ddb847da9f7e20f71">qd0_blind_id_sign_with_private_id_sign</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_sign_with_private_id_sign)(d0_blind_id_t *ctx, D0_BOOL is_first, D0_BOOL send_modulus, const char *message, size_t msglen, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00231">crypto.c:231</a></div></div>
<div class="ttc" id="aglquake_8h_html_a820662f5b80a48256e2503352e9f51b9"><div class="ttname"><a href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a></div><div class="ttdeci">GLsizeiptr const GLvoid * data</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00638">glquake.h:638</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad247271fff8b625706df45f83222d8ba" name="ad247271fff8b625706df45f83222d8ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad247271fff8b625706df45f83222d8ba">&#9670;&#160;</a></span>Crypto_SignDataDetached()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> Crypto_SignDataDetached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>datasize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>signed_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>signed_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02645">2645</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2646</span>{</div>
<div class="line"><span class="lineno"> 2647</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyid &lt; 0 || keyid &gt;</a>= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>)</div>
<div class="line"><span class="lineno"> 2648</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2649</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[keyid])</div>
<div class="line"><span class="lineno"> 2650</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2651</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa7ad86a0d8f95960c08726067fe9831e">qd0_blind_id_sign_with_private_id_sign_detached</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[keyid], <span class="keyword">true</span>, <span class="keyword">false</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">datasize</a>, (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_data</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>))</div>
<div class="line"><span class="lineno"> 2652</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>;</div>
<div class="line"><span class="lineno"> 2653</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2654</span>}</div>
<div class="ttc" id="acrypto_8c_html_aa7ad86a0d8f95960c08726067fe9831e"><div class="ttname"><a href="crypto_8c.html#aa7ad86a0d8f95960c08726067fe9831e">qd0_blind_id_sign_with_private_id_sign_detached</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_sign_with_private_id_sign_detached)(d0_blind_id_t *ctx, D0_BOOL is_first, D0_BOOL send_modulus, const char *message, size_t msglen, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00232">crypto.c:232</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="prvm__cmds_8c_source.html#l05445">VM_uri_get()</a>.</p>

</div>
</div>
<a id="a61b0d8e49d857cf554e5db8c601c2be4" name="a61b0d8e49d857cf554e5db8c601c2be4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61b0d8e49d857cf554e5db8c601c2be4">&#9670;&#160;</a></span>sha256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> sha256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00383">383</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  384</span>{</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_variable" href="crypto_8c.html#a62b44899185366951da0286b16f86f43">qd0_blind_id_util_sha256</a>((<span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *) in, <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>);</div>
<div class="line"><span class="lineno">  386</span>}</div>
<div class="ttc" id="acrypto_8c_html_a62b44899185366951da0286b16f86f43"><div class="ttname"><a href="crypto_8c.html#a62b44899185366951da0286b16f86f43">qd0_blind_id_util_sha256</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_util_sha256)(char *out, const char *in, size_t n)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00230">crypto.c:230</a></div></div>
<div class="ttc" id="afractalnoise_8c_html_a86fdeed0593c5e3b95d1f2447350ca96"><div class="ttname"><a href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a></div><div class="ttdeci">#define n(x, y)</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="prvm__cmds_8c_source.html#l05193">VM_digest_hex()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af9838f94945170d03aedfdcff10395f5" name="af9838f94945170d03aedfdcff10395f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9838f94945170d03aedfdcff10395f5">&#9670;&#160;</a></span>crypto_aeslevel</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cvar_s</a> crypto_aeslevel</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00031">31</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>{<a class="code hl_define" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="code hl_define" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="code hl_define" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, <span class="stringliteral">&quot;crypto_aeslevel&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;whether to support AES encryption in authenticated connections (0 = no, 1 = supported, 2 = requested, 3 = required)&quot;</span>};</div>
<div class="ttc" id="acmd_8h_html_aadf0879ce7511e76eeea9da766b31c6b"><div class="ttname"><a href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a></div><div class="ttdeci">#define CF_SERVER</div><div class="ttdoc">cvar/command that only the server can change/execute</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00049">cmd.h:49</a></div></div>
<div class="ttc" id="acmd_8h_html_abba64dce6a45541317c5508aa83436e5"><div class="ttname"><a href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a></div><div class="ttdeci">#define CF_CLIENT</div><div class="ttdoc">cvar/command that only the client can change/execute</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00048">cmd.h:48</a></div></div>
<div class="ttc" id="acmd_8h_html_aeeecb68995736ab90434173e64fd14e5"><div class="ttname"><a href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a></div><div class="ttdeci">#define CF_ARCHIVE</div><div class="ttdoc">cvar should have its set value saved to config.cfg and persist across sessions</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00053">cmd.h:53</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01689">Crypto_GetInfoResponseDataString()</a>, <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="afb9c67c616e7381a63de5023be2b9fc0" name="afb9c67c616e7381a63de5023be2b9fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb9c67c616e7381a63de5023be2b9fc0">&#9670;&#160;</a></span>crypto_developer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cvar_s</a> crypto_developer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00030">30</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   30</span>{<a class="code hl_define" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="code hl_define" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="code hl_define" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, <span class="stringliteral">&quot;crypto_developer&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <span class="stringliteral">&quot;print extra info about crypto handshake&quot;</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, and <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a28bce26dd18684379882653e173b0188" name="a28bce26dd18684379882653e173b0188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28bce26dd18684379882653e173b0188">&#9670;&#160;</a></span>crypto_keyfp_recommended_length</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> crypto_keyfp_recommended_length</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00041">41</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01403">Crypto_HostKeys_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="netconn_8c_source.html#l01631">NetConn_ConnectionEstablished()</a>, <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>, and <a class="el" href="sv__main_8c_source.html#l00925">SV_ConnectClient()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="crypto_8h.html">crypto.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
