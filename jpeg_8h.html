<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DarkPlaces: jpeg.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-customisations.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="darkplaces48x48.png"/></td>
  <td id="projectalign">
   <div id="projectname">DarkPlaces
   </div>
   <div id="projectbrief">Game engine based on the Quake 1 engine by id Software, developed by LadyHavoc</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('jpeg_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">jpeg.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &quot;<a class="el" href="qtypes_8h_source.html">qtypes.h</a>&quot;</code><br />
</div>
<p><a href="jpeg_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa11ad53af48f7a9158cbfe2913e227d6" id="r_aa11ad53af48f7a9158cbfe2913e227d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jpeg_8h.html#aa11ad53af48f7a9158cbfe2913e227d6">JPEG_OpenLibrary</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:aa11ad53af48f7a9158cbfe2913e227d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac04bbe4602f5ed3e81bf0090f220ff" id="r_aaac04bbe4602f5ed3e81bf0090f220ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jpeg_8h.html#aaac04bbe4602f5ed3e81bf0090f220ff">JPEG_CloseLibrary</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:aaac04bbe4602f5ed3e81bf0090f220ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26b23b0df745c232193435bd9d6f81c0" id="r_a26b23b0df745c232193435bd9d6f81c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jpeg_8h.html#a26b23b0df745c232193435bd9d6f81c0">JPEG_LoadImage_BGRA</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> filesize, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *miplevel)</td></tr>
<tr class="separator:a26b23b0df745c232193435bd9d6f81c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea68e80b101f4106f1111c417299dbf" id="r_a7ea68e80b101f4106f1111c417299dbf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jpeg_8h.html#a7ea68e80b101f4106f1111c417299dbf">JPEG_SaveImage_preflipped</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *filename, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>)</td></tr>
<tr class="separator:a7ea68e80b101f4106f1111c417299dbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad22e4351f8a41a17139362ffdb9b1df7" id="r_ad22e4351f8a41a17139362ffdb9b1df7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jpeg_8h.html#ad22e4351f8a41a17139362ffdb9b1df7">JPEG_SaveImage_to_Buffer</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jpegbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jpegsize</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>)</td></tr>
<tr class="separator:ad22e4351f8a41a17139362ffdb9b1df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe05aa85ca76d206d7bf82d4f5fa3903" id="r_abe05aa85ca76d206d7bf82d4f5fa3903"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jpeg_8h.html#abe05aa85ca76d206d7bf82d4f5fa3903">Image_Compress</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *imagename, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> maxsize, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> **<a class="el" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#a0208b298f4c65e680a58434efb699fe8">size</a>)</td></tr>
<tr class="separator:abe05aa85ca76d206d7bf82d4f5fa3903"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abe05aa85ca76d206d7bf82d4f5fa3903" name="abe05aa85ca76d206d7bf82d4f5fa3903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe05aa85ca76d206d7bf82d4f5fa3903">&#9670;&#160;</a></span>Image_Compress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Image_Compress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>imagename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>maxsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> **&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jpeg_8c_source.html#l01047">1047</a> of file <a class="el" href="jpeg_8c_source.html">jpeg.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1048</span>{</div>
<div class="line"><span class="lineno"> 1049</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *imagedata, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">newimagedata</a>;</div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxPixelCount</a>;</div>
<div class="line"><span class="lineno"> 1051</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">components</a>[3] = {2, 1, 0};</div>
<div class="line"><span class="lineno"> 1052</span>    <a class="code hl_struct" href="structCompressedImageCacheItem.html">CompressedImageCacheItem</a> *<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1053</span> </div>
<div class="line"><span class="lineno"> 1054</span>    <a class="code hl_function" href="jpeg_8c.html#aa11ad53af48f7a9158cbfe2913e227d6">JPEG_OpenLibrary</a> (); <span class="comment">// for now; LH had the idea of replacing this by a better format</span></div>
<div class="line"><span class="lineno"> 1055</span>    <a class="code hl_function" href="image__png_8c.html#ab2cde959841139dac426ea8b3ad72042">PNG_OpenLibrary</a> (); <span class="comment">// for loading</span></div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>    <span class="comment">// No DLL = no JPEGs</span></div>
<div class="line"><span class="lineno"> 1058</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="jpeg_8c.html#a83d500743159436de76baa45240a5c58">jpeg_dll</a>)</div>
<div class="line"><span class="lineno"> 1059</span>    {</div>
<div class="line"><span class="lineno"> 1060</span>        <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;You need the libjpeg library to save JPEG images\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1061</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1062</span>    }</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>    <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code hl_function" href="jpeg_8c.html#adb479a7e8e66146669b2d9ba7018c165">CompressedImageCache_Find</a>(imagename, maxsize);</div>
<div class="line"><span class="lineno"> 1065</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1066</span>    {</div>
<div class="line"><span class="lineno"> 1067</span>        *<a class="code hl_variable" href="glquake_8h.html#a0208b298f4c65e680a58434efb699fe8">size</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;compressed_size;</div>
<div class="line"><span class="lineno"> 1068</span>        *<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;compressed;</div>
<div class="line"><span class="lineno"> 1069</span>        <span class="keywordflow">return</span> (*<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a> != <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1070</span>    }</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>    <span class="comment">// load the image</span></div>
<div class="line"><span class="lineno"> 1073</span>    imagedata = <a class="code hl_function" href="image_8c.html#ab57af3ee2ad65f0fd5bd6caae299c657">loadimagepixelsbgra</a>(imagename, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1074</span>    <span class="keywordflow">if</span>(!imagedata)</div>
<div class="line"><span class="lineno"> 1075</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1076</span> </div>
<div class="line"><span class="lineno"> 1077</span>    <span class="comment">// find an appropriate size for somewhat okay compression</span></div>
<div class="line"><span class="lineno"> 1078</span>    <span class="keywordflow">if</span>(maxsize &lt;= 768)</div>
<div class="line"><span class="lineno"> 1079</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxPixelCount</a> = 32 * 32;</div>
<div class="line"><span class="lineno"> 1080</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(maxsize &lt;= 1024)</div>
<div class="line"><span class="lineno"> 1081</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxPixelCount</a> = 64 * 64;</div>
<div class="line"><span class="lineno"> 1082</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(maxsize &lt;= 4096)</div>
<div class="line"><span class="lineno"> 1083</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxPixelCount</a> = 128 * 128;</div>
<div class="line"><span class="lineno"> 1084</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1085</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxPixelCount</a> = 256 * 256;</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>    <span class="keywordflow">while</span>(<a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> * <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a> &gt; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxPixelCount</a>)</div>
<div class="line"><span class="lineno"> 1088</span>    {</div>
<div class="line"><span class="lineno"> 1089</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">one</a> = 1;</div>
<div class="line"><span class="lineno"> 1090</span>        <a class="code hl_function" href="image_8c.html#a927509a9eae628b6572999c4b9898181">Image_MipReduce32</a>(imagedata, imagedata, &amp;<a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a>, &amp;<a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">one</a>, <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a>/2, <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a>/2, 1);</div>
<div class="line"><span class="lineno"> 1091</span>    }</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">newimagedata</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_define" href="zone_8h.html#a1f8b0c54fe3d32858da2b13a4f7e5783">Mem_Alloc</a>(<a class="code hl_variable" href="zone_8c.html#ac742acee1395c22ccf6d2370d465f844">tempmempool</a>, <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> * <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a> * 3);</div>
<div class="line"><span class="lineno"> 1094</span> </div>
<div class="line"><span class="lineno"> 1095</span>    <span class="comment">// convert the image from BGRA to RGB</span></div>
<div class="line"><span class="lineno"> 1096</span>    <a class="code hl_function" href="image_8c.html#ab264e6bc5c9178f4a425ab90f581325a">Image_CopyMux</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">newimagedata</a>, imagedata, <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a>, <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 3, 4, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">components</a>);</div>
<div class="line"><span class="lineno"> 1097</span>    <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a>(imagedata);</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>    <span class="comment">// try to compress it to JPEG</span></div>
<div class="line"><span class="lineno"> 1100</span>    *<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a> = <a class="code hl_define" href="zone_8h.html#a35deb8ef816a08fb1bc8feac8db020c5">Z_Malloc</a>(maxsize);</div>
<div class="line"><span class="lineno"> 1101</span>    *<a class="code hl_variable" href="glquake_8h.html#a0208b298f4c65e680a58434efb699fe8">size</a> = <a class="code hl_function" href="jpeg_8c.html#ad22e4351f8a41a17139362ffdb9b1df7">JPEG_SaveImage_to_Buffer</a>((<span class="keywordtype">char</span> *) *<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, maxsize, <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a>, <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">newimagedata</a>);</div>
<div class="line"><span class="lineno"> 1102</span>    <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">newimagedata</a>);</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span>    <span class="keywordflow">if</span>(!*<a class="code hl_variable" href="glquake_8h.html#a0208b298f4c65e680a58434efb699fe8">size</a>)</div>
<div class="line"><span class="lineno"> 1105</span>    {</div>
<div class="line"><span class="lineno"> 1106</span>        <a class="code hl_define" href="zone_8h.html#abbce8ea44a12486a6b59f31f02bab5ee">Z_Free</a>(*<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>);</div>
<div class="line"><span class="lineno"> 1107</span>        *<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1108</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;could not compress image %s to %d bytes\n&quot;</span>, imagename, (<span class="keywordtype">int</span>)maxsize);</div>
<div class="line"><span class="lineno"> 1109</span>        <span class="comment">// return false;</span></div>
<div class="line"><span class="lineno"> 1110</span>        <span class="comment">// also cache failures!</span></div>
<div class="line"><span class="lineno"> 1111</span>    }</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>    <span class="comment">// store it in the cache</span></div>
<div class="line"><span class="lineno"> 1114</span>    <a class="code hl_function" href="jpeg_8c.html#a60f343a04d078cea63d381d1130795e2">CompressedImageCache_Add</a>(imagename, maxsize, *<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, *<a class="code hl_variable" href="glquake_8h.html#a0208b298f4c65e680a58434efb699fe8">size</a>);</div>
<div class="line"><span class="lineno"> 1115</span>    <span class="keywordflow">return</span> (*<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a> != <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1116</span>}</div>
<div class="ttc" id="aconsole_8c_html_a1cf9711475097b11dc41f743254ec77e"><div class="ttname"><a href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a></div><div class="ttdeci">void Con_Print(const char *msg)</div><div class="ttdoc">Prints to all appropriate console targets, and adds timestamps.</div><div class="ttdef"><b>Definition</b> <a href="console_8c_source.html#l01450">console.c:1450</a></div></div>
<div class="ttc" id="aconsole_8c_html_a49b71fe9a87e57a440e07af4a869a9f6"><div class="ttname"><a href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a></div><div class="ttdeci">void Con_Printf(const char *fmt,...)</div><div class="ttdoc">Prints to all appropriate console targets.</div><div class="ttdef"><b>Definition</b> <a href="console_8c_source.html#l01460">console.c:1460</a></div></div>
<div class="ttc" id="aglquake_8h_html_a0208b298f4c65e680a58434efb699fe8"><div class="ttname"><a href="glquake_8h.html#a0208b298f4c65e680a58434efb699fe8">size</a></div><div class="ttdeci">GLuint GLuint GLintptr GLsizeiptr size</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00631">glquake.h:631</a></div></div>
<div class="ttc" id="aglquake_8h_html_ac0759919bfcf4c7222738ba583673a9e"><div class="ttname"><a href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a></div><div class="ttdeci">GLenum GLuint GLenum GLsizei const GLchar * buf</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00656">glquake.h:656</a></div></div>
<div class="ttc" id="aglquake_8h_html_af7ca775b6d9354291c4d7d01b8b2a8bc"><div class="ttname"><a href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">index</a></div><div class="ttdeci">GLuint index</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00628">glquake.h:628</a></div></div>
<div class="ttc" id="aimage_8c_html_a1e0e6a62a1d85a2fdf500d466ea7a33f"><div class="ttname"><a href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a></div><div class="ttdeci">int image_height</div><div class="ttdef"><b>Definition</b> <a href="image_8c_source.html#l00010">image.c:10</a></div></div>
<div class="ttc" id="aimage_8c_html_a927509a9eae628b6572999c4b9898181"><div class="ttname"><a href="image_8c.html#a927509a9eae628b6572999c4b9898181">Image_MipReduce32</a></div><div class="ttdeci">void Image_MipReduce32(const unsigned char *in, unsigned char *out, int *width, int *height, int *depth, int destwidth, int destheight, int destdepth)</div><div class="ttdef"><b>Definition</b> <a href="image_8c_source.html#l01689">image.c:1689</a></div></div>
<div class="ttc" id="aimage_8c_html_ab264e6bc5c9178f4a425ab90f581325a"><div class="ttname"><a href="image_8c.html#ab264e6bc5c9178f4a425ab90f581325a">Image_CopyMux</a></div><div class="ttdeci">void Image_CopyMux(unsigned char *outpixels, const unsigned char *inpixels, int inputwidth, int inputheight, qbool inputflipx, qbool inputflipy, qbool inputflipdiagonal, int numoutputcomponents, int numinputcomponents, int *outputinputcomponentindices)</div><div class="ttdef"><b>Definition</b> <a href="image_8c_source.html#l00024">image.c:24</a></div></div>
<div class="ttc" id="aimage_8c_html_ab57af3ee2ad65f0fd5bd6caae299c657"><div class="ttname"><a href="image_8c.html#ab57af3ee2ad65f0fd5bd6caae299c657">loadimagepixelsbgra</a></div><div class="ttdeci">unsigned char * loadimagepixelsbgra(const char *filename, qbool complain, qbool allowFixtrans, qbool convertsRGB, int *miplevel)</div><div class="ttdef"><b>Definition</b> <a href="image_8c_source.html#l01043">image.c:1043</a></div></div>
<div class="ttc" id="aimage_8c_html_adcdf062bf62cd36e741bd190386f5fdb"><div class="ttname"><a href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a></div><div class="ttdeci">int image_width</div><div class="ttdef"><b>Definition</b> <a href="image_8c_source.html#l00009">image.c:9</a></div></div>
<div class="ttc" id="aimage__png_8c_html_ab2cde959841139dac426ea8b3ad72042"><div class="ttname"><a href="image__png_8c.html#ab2cde959841139dac426ea8b3ad72042">PNG_OpenLibrary</a></div><div class="ttdeci">qbool PNG_OpenLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="image__png_8c_source.html#l00143">image_png.c:143</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a60f343a04d078cea63d381d1130795e2"><div class="ttname"><a href="jpeg_8c.html#a60f343a04d078cea63d381d1130795e2">CompressedImageCache_Add</a></div><div class="ttdeci">static void CompressedImageCache_Add(const char *imagename, size_t maxsize, void *compressed, size_t compressed_size)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l01011">jpeg.c:1011</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a83d500743159436de76baa45240a5c58"><div class="ttname"><a href="jpeg_8c.html#a83d500743159436de76baa45240a5c58">jpeg_dll</a></div><div class="ttdeci">dllhandle_t jpeg_dll</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00457">jpeg.c:457</a></div></div>
<div class="ttc" id="ajpeg_8c_html_aa11ad53af48f7a9158cbfe2913e227d6"><div class="ttname"><a href="jpeg_8c.html#aa11ad53af48f7a9158cbfe2913e227d6">JPEG_OpenLibrary</a></div><div class="ttdeci">qbool JPEG_OpenLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00492">jpeg.c:492</a></div></div>
<div class="ttc" id="ajpeg_8c_html_ad22e4351f8a41a17139362ffdb9b1df7"><div class="ttname"><a href="jpeg_8c.html#ad22e4351f8a41a17139362ffdb9b1df7">JPEG_SaveImage_to_Buffer</a></div><div class="ttdeci">size_t JPEG_SaveImage_to_Buffer(char *jpegbuf, size_t jpegsize, int width, int height, unsigned char *data)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00931">jpeg.c:931</a></div></div>
<div class="ttc" id="ajpeg_8c_html_adb479a7e8e66146669b2d9ba7018c165"><div class="ttname"><a href="jpeg_8c.html#adb479a7e8e66146669b2d9ba7018c165">CompressedImageCache_Find</a></div><div class="ttdeci">static CompressedImageCacheItem * CompressedImageCache_Find(const char *imagename, size_t maxsize)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l01030">jpeg.c:1030</a></div></div>
<div class="ttc" id="aprvm__execprogram_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition</b> <a href="prvm__execprogram_8h_source.html#l00002">prvm_execprogram.h:2</a></div></div>
<div class="ttc" id="aqtypes_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition</b> <a href="qtypes_8h_source.html#l00012">qtypes.h:12</a></div></div>
<div class="ttc" id="astructCompressedImageCacheItem_html"><div class="ttname"><a href="structCompressedImageCacheItem.html">CompressedImageCacheItem</a></div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00999">jpeg.c:1000</a></div></div>
<div class="ttc" id="azone_8c_html_ac742acee1395c22ccf6d2370d465f844"><div class="ttname"><a href="zone_8c.html#ac742acee1395c22ccf6d2370d465f844">tempmempool</a></div><div class="ttdeci">mempool_t * tempmempool</div><div class="ttdef"><b>Definition</b> <a href="zone_8c_source.html#l00794">zone.c:794</a></div></div>
<div class="ttc" id="azone_8h_html_a06bb588bb8d0406e051f04c1ca723d28"><div class="ttname"><a href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a></div><div class="ttdeci">#define Mem_Free(mem)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00096">zone.h:96</a></div></div>
<div class="ttc" id="azone_8h_html_a1f8b0c54fe3d32858da2b13a4f7e5783"><div class="ttname"><a href="zone_8h.html#a1f8b0c54fe3d32858da2b13a4f7e5783">Mem_Alloc</a></div><div class="ttdeci">#define Mem_Alloc(pool, size)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00092">zone.h:92</a></div></div>
<div class="ttc" id="azone_8h_html_a35deb8ef816a08fb1bc8feac8db020c5"><div class="ttname"><a href="zone_8h.html#a35deb8ef816a08fb1bc8feac8db020c5">Z_Malloc</a></div><div class="ttdeci">#define Z_Malloc(size)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00161">zone.h:161</a></div></div>
<div class="ttc" id="azone_8h_html_abbce8ea44a12486a6b59f31f02bab5ee"><div class="ttname"><a href="zone_8h.html#abbce8ea44a12486a6b59f31f02bab5ee">Z_Free</a></div><div class="ttdeci">#define Z_Free(data)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00164">zone.h:164</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="svvm__cmds_8c_source.html#l01565">VM_SV_WritePicture()</a>.</p>

</div>
</div>
<a id="aaac04bbe4602f5ed3e81bf0090f220ff" name="aaac04bbe4602f5ed3e81bf0090f220ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaac04bbe4602f5ed3e81bf0090f220ff">&#9670;&#160;</a></span>JPEG_CloseLibrary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> JPEG_CloseLibrary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jpeg_8c_source.html#l00538">538</a> of file <a class="el" href="jpeg_8c_source.html">jpeg.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  539</span>{</div>
<div class="line"><span class="lineno">  540</span><span class="preprocessor">#ifndef LINK_TO_LIBJPEG</span></div>
<div class="line"><span class="lineno">  541</span>    <a class="code hl_function" href="sys_8h.html#ae1bd207c941d95e0bd80aae8dab178f2">Sys_FreeLibrary</a> (&amp;<a class="code hl_variable" href="jpeg_8c.html#a83d500743159436de76baa45240a5c58">jpeg_dll</a>);</div>
<div class="line"><span class="lineno">  542</span>    <a class="code hl_variable" href="jpeg_8c.html#ab037ca83fe3319e82580a0044ccb4124">jpeg_tried_loading</a> = <span class="keyword">false</span>; <span class="comment">// allow retry</span></div>
<div class="line"><span class="lineno">  543</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  544</span>}</div>
<div class="ttc" id="ajpeg_8c_html_ab037ca83fe3319e82580a0044ccb4124"><div class="ttname"><a href="jpeg_8c.html#ab037ca83fe3319e82580a0044ccb4124">jpeg_tried_loading</a></div><div class="ttdeci">qbool jpeg_tried_loading</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00458">jpeg.c:458</a></div></div>
<div class="ttc" id="asys_8h_html_ae1bd207c941d95e0bd80aae8dab178f2"><div class="ttname"><a href="sys_8h.html#ae1bd207c941d95e0bd80aae8dab178f2">Sys_FreeLibrary</a></div><div class="ttdeci">void Sys_FreeLibrary(dllhandle_t *handle)</div><div class="ttdef"><b>Definition</b> <a href="sys__shared_8c_source.html#l00242">sys_shared.c:242</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="gl__textures_8c_source.html#l00657">r_textures_shutdown()</a>.</p>

</div>
</div>
<a id="a26b23b0df745c232193435bd9d6f81c0" name="a26b23b0df745c232193435bd9d6f81c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26b23b0df745c232193435bd9d6f81c0">&#9670;&#160;</a></span>JPEG_LoadImage_BGRA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> * JPEG_LoadImage_BGRA </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>filesize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *&#160;</td>
          <td class="paramname"><em>miplevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jpeg_8c_source.html#l00606">606</a> of file <a class="el" href="jpeg_8c_source.html">jpeg.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  607</span>{</div>
<div class="line"><span class="lineno">  608</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structjpeg__decompress__struct.html">jpeg_decompress_struct</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>;</div>
<div class="line"><span class="lineno">  609</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structjpeg__error__mgr.html">jpeg_error_mgr</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jerr</a>;</div>
<div class="line"><span class="lineno">  610</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">line</a>;</div>
<div class="line"><span class="lineno">  612</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">submip</a> = 0;</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>    <span class="comment">// No DLL = no JPEGs</span></div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="jpeg_8c.html#a83d500743159436de76baa45240a5c58">jpeg_dll</a>)</div>
<div class="line"><span class="lineno">  616</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">if</span>(miplevel &amp;&amp; <a class="code hl_variable" href="jpeg_8c.html#a926230fc140404aee94aae2260530212">r_texture_jpeg_fastpicmip</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno">  619</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">submip</a> = <a class="code hl_define" href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a>(0, *miplevel, 3);</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.err = <a class="code hl_variable" href="jpeg_8c.html#a085c2ca0e1636ab9ad1007b5e6d9b41a">qjpeg_std_error</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jerr</a>);</div>
<div class="line"><span class="lineno">  622</span>    <a class="code hl_define" href="jpeg_8c.html#af49c9dc43296b66142ca59039c02d1d0">qjpeg_create_decompress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">setjmp</a>(<a class="code hl_variable" href="jpeg_8c.html#a88dc06dee982dfeff84484ac0b85dbb6">error_in_jpeg</a>))</div>
<div class="line"><span class="lineno">  624</span>        <span class="keywordflow">goto</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">error_caught</a>;</div>
<div class="line"><span class="lineno">  625</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.err = <a class="code hl_variable" href="jpeg_8c.html#a085c2ca0e1636ab9ad1007b5e6d9b41a">qjpeg_std_error</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jerr</a>);</div>
<div class="line"><span class="lineno">  626</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.err-&gt;error_exit = <a class="code hl_function" href="jpeg_8c.html#ae84a1cb734dbf063e57cc498750dffb1">JPEG_ErrorExit</a>;</div>
<div class="line"><span class="lineno">  627</span>    <a class="code hl_function" href="jpeg_8c.html#aac26e7fc6a7cda548eec0b059e4ae373">JPEG_MemSrc</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, <a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, filesize);</div>
<div class="line"><span class="lineno">  628</span>    <a class="code hl_variable" href="jpeg_8c.html#a15d1e8c888ed1c36a4cdf5b76eba3830">qjpeg_read_header</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  629</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.scale_num = 1;</div>
<div class="line"><span class="lineno">  630</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.scale_denom = (1 &lt;&lt; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">submip</a>);</div>
<div class="line"><span class="lineno">  631</span>    <a class="code hl_variable" href="jpeg_8c.html#aa7c01d2d8ede40d72b55836ab27ba62f">qjpeg_start_decompress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>    <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.output_width;</div>
<div class="line"><span class="lineno">  634</span>    <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.output_height;</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> &gt; 32768 || <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a> &gt; 32768 || <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> &lt;= 0 || <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a> &lt;= 0)</div>
<div class="line"><span class="lineno">  637</span>    {</div>
<div class="line"><span class="lineno">  638</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;JPEG_LoadImage: invalid image size %ix%i\n&quot;</span>, <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a>, <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a>);</div>
<div class="line"><span class="lineno">  639</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  640</span>    }</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_define" href="zone_8h.html#a1f8b0c54fe3d32858da2b13a4f7e5783">Mem_Alloc</a>(<a class="code hl_variable" href="zone_8c.html#ac742acee1395c22ccf6d2370d465f844">tempmempool</a>, <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> * <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a> * 4);</div>
<div class="line"><span class="lineno">  643</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_define" href="zone_8h.html#a1f8b0c54fe3d32858da2b13a4f7e5783">Mem_Alloc</a>(<a class="code hl_variable" href="zone_8c.html#ac742acee1395c22ccf6d2370d465f844">tempmempool</a>, <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> * <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.output_components);</div>
<div class="line"><span class="lineno">  644</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a> || !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>)</div>
<div class="line"><span class="lineno">  645</span>    {</div>
<div class="line"><span class="lineno">  646</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a>)</div>
<div class="line"><span class="lineno">  647</span>            <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a>);</div>
<div class="line"><span class="lineno">  648</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>)</div>
<div class="line"><span class="lineno">  649</span>            <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>);</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;JPEG_LoadImage: not enough memory for %i by %i image\n&quot;</span>, <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a>, <a class="code hl_variable" href="image_8c.html#a1e0e6a62a1d85a2fdf500d466ea7a33f">image_height</a>);</div>
<div class="line"><span class="lineno">  652</span>        <a class="code hl_variable" href="jpeg_8c.html#abae8ad7f8a915064c1af7a24d6326d0e">qjpeg_finish_decompress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  653</span>        <a class="code hl_variable" href="jpeg_8c.html#a268c7ba05b330ae64a3cb691a8ee156f">qjpeg_destroy_decompress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  654</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  655</span>    }</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    <span class="comment">// Decompress the image, line by line</span></div>
<div class="line"><span class="lineno">  658</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">line</a> = 0;</div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.output_scanline &lt; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.output_height)</div>
<div class="line"><span class="lineno">  660</span>    {</div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>;</div>
<div class="line"><span class="lineno">  662</span>        <span class="keywordtype">int</span> ind;</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>        <a class="code hl_variable" href="jpeg_8c.html#a0e2cf899cd5f036fe75e9ab18a84e28d">qjpeg_read_scanlines</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>, 1);</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>        <span class="comment">// Convert the image to BGRA</span></div>
<div class="line"><span class="lineno">  667</span>        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.output_components)</div>
<div class="line"><span class="lineno">  668</span>        {</div>
<div class="line"><span class="lineno">  669</span>            <span class="comment">// RGB images</span></div>
<div class="line"><span class="lineno">  670</span>            <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno">  671</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a> = &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a>[<a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> * <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">line</a> * 4];</div>
<div class="line"><span class="lineno">  672</span>                <span class="keywordflow">for</span> (ind = 0; ind &lt; <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> * 3; ind += 3, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a> += 4)</div>
<div class="line"><span class="lineno">  673</span>                {</div>
<div class="line"><span class="lineno">  674</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>[2] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>[ind];</div>
<div class="line"><span class="lineno">  675</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>[1] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>[ind + 1];</div>
<div class="line"><span class="lineno">  676</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>[0] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>[ind + 2];</div>
<div class="line"><span class="lineno">  677</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>[3] = 255;</div>
<div class="line"><span class="lineno">  678</span>                }</div>
<div class="line"><span class="lineno">  679</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>            <span class="comment">// Greyscale images (default to it, just in case)</span></div>
<div class="line"><span class="lineno">  682</span>            <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  683</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  684</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a> = &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a>[<a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a> * <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">line</a> * 4];</div>
<div class="line"><span class="lineno">  685</span>                <span class="keywordflow">for</span> (ind = 0; ind &lt; <a class="code hl_variable" href="image_8c.html#adcdf062bf62cd36e741bd190386f5fdb">image_width</a>; ind++, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a> += 4)</div>
<div class="line"><span class="lineno">  686</span>                {</div>
<div class="line"><span class="lineno">  687</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>[0] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>[ind];</div>
<div class="line"><span class="lineno">  688</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>[1] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>[ind];</div>
<div class="line"><span class="lineno">  689</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>[2] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>[ind];</div>
<div class="line"><span class="lineno">  690</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buffer_ptr</a>[3] = 255;</div>
<div class="line"><span class="lineno">  691</span>                }</div>
<div class="line"><span class="lineno">  692</span>        }</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">line</a>++;</div>
<div class="line"><span class="lineno">  695</span>    }</div>
<div class="line"><span class="lineno">  696</span>    <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>); <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>    <a class="code hl_variable" href="jpeg_8c.html#abae8ad7f8a915064c1af7a24d6326d0e">qjpeg_finish_decompress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  699</span>    <a class="code hl_variable" href="jpeg_8c.html#a268c7ba05b330ae64a3cb691a8ee156f">qjpeg_destroy_decompress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>    <span class="keywordflow">if</span>(miplevel)</div>
<div class="line"><span class="lineno">  702</span>        *miplevel -= <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">submip</a>;</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a>;</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span><a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">error_caught</a>:</div>
<div class="line"><span class="lineno">  707</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>)</div>
<div class="line"><span class="lineno">  708</span>        <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>);</div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a>)</div>
<div class="line"><span class="lineno">  710</span>        <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">image_buffer</a>);</div>
<div class="line"><span class="lineno">  711</span>    <a class="code hl_variable" href="jpeg_8c.html#a268c7ba05b330ae64a3cb691a8ee156f">qjpeg_destroy_decompress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  713</span>}</div>
<div class="ttc" id="ajpeg_8c_html_a085c2ca0e1636ab9ad1007b5e6d9b41a"><div class="ttname"><a href="jpeg_8c.html#a085c2ca0e1636ab9ad1007b5e6d9b41a">qjpeg_std_error</a></div><div class="ttdeci">static struct jpeg_error_mgr *(* qjpeg_std_error)(struct jpeg_error_mgr *err)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00430">jpeg.c:431</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a0e2cf899cd5f036fe75e9ab18a84e28d"><div class="ttname"><a href="jpeg_8c.html#a0e2cf899cd5f036fe75e9ab18a84e28d">qjpeg_read_scanlines</a></div><div class="ttdeci">static JDIMENSION(* qjpeg_read_scanlines)(j_decompress_ptr cinfo, unsigned char **scanlines, JDIMENSION max_lines)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00426">jpeg.c:426</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a15d1e8c888ed1c36a4cdf5b76eba3830"><div class="ttname"><a href="jpeg_8c.html#a15d1e8c888ed1c36a4cdf5b76eba3830">qjpeg_read_header</a></div><div class="ttdeci">static int(* qjpeg_read_header)(j_decompress_ptr cinfo, jboolean require_image)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00425">jpeg.c:425</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a268c7ba05b330ae64a3cb691a8ee156f"><div class="ttname"><a href="jpeg_8c.html#a268c7ba05b330ae64a3cb691a8ee156f">qjpeg_destroy_decompress</a></div><div class="ttdeci">static void(* qjpeg_destroy_decompress)(j_decompress_ptr cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00421">jpeg.c:421</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a88dc06dee982dfeff84484ac0b85dbb6"><div class="ttname"><a href="jpeg_8c.html#a88dc06dee982dfeff84484ac0b85dbb6">error_in_jpeg</a></div><div class="ttdeci">static jmp_buf error_in_jpeg</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00462">jpeg.c:462</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a926230fc140404aee94aae2260530212"><div class="ttname"><a href="jpeg_8c.html#a926230fc140404aee94aae2260530212">r_texture_jpeg_fastpicmip</a></div><div class="ttdeci">cvar_t r_texture_jpeg_fastpicmip</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00032">jpeg.c:32</a></div></div>
<div class="ttc" id="ajpeg_8c_html_aa7c01d2d8ede40d72b55836ab27ba62f"><div class="ttname"><a href="jpeg_8c.html#aa7c01d2d8ede40d72b55836ab27ba62f">qjpeg_start_decompress</a></div><div class="ttdeci">static jboolean(* qjpeg_start_decompress)(j_decompress_ptr cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00430">jpeg.c:430</a></div></div>
<div class="ttc" id="ajpeg_8c_html_aac26e7fc6a7cda548eec0b059e4ae373"><div class="ttname"><a href="jpeg_8c.html#aac26e7fc6a7cda548eec0b059e4ae373">JPEG_MemSrc</a></div><div class="ttdeci">static void JPEG_MemSrc(j_decompress_ptr cinfo, const unsigned char *buffer, size_t filesize)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00578">jpeg.c:578</a></div></div>
<div class="ttc" id="ajpeg_8c_html_abae8ad7f8a915064c1af7a24d6326d0e"><div class="ttname"><a href="jpeg_8c.html#abae8ad7f8a915064c1af7a24d6326d0e">qjpeg_finish_decompress</a></div><div class="ttdeci">static jboolean(* qjpeg_finish_decompress)(j_decompress_ptr cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00423">jpeg.c:423</a></div></div>
<div class="ttc" id="ajpeg_8c_html_ae84a1cb734dbf063e57cc498750dffb1"><div class="ttname"><a href="jpeg_8c.html#ae84a1cb734dbf063e57cc498750dffb1">JPEG_ErrorExit</a></div><div class="ttdeci">static void JPEG_ErrorExit(j_common_ptr cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00592">jpeg.c:592</a></div></div>
<div class="ttc" id="ajpeg_8c_html_af49c9dc43296b66142ca59039c02d1d0"><div class="ttname"><a href="jpeg_8c.html#af49c9dc43296b66142ca59039c02d1d0">qjpeg_create_decompress</a></div><div class="ttdeci">#define qjpeg_create_decompress(cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00415">jpeg.c:415</a></div></div>
<div class="ttc" id="amathlib_8h_html_a553641b2aac0b2a7c43f9f74f8333fd5"><div class="ttname"><a href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a></div><div class="ttdeci">#define bound(min, num, max)</div><div class="ttdef"><b>Definition</b> <a href="mathlib_8h_source.html#l00034">mathlib.h:34</a></div></div>
<div class="ttc" id="ashader__glsl_8h_html_a731feb93da8dc28ee53e37b43daabd06"><div class="ttname"><a href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a></div><div class="ttdeci">float f</div><div class="ttdef"><b>Definition</b> <a href="shader__glsl_8h_source.html#l00586">shader_glsl.h:586</a></div></div>
<div class="ttc" id="astructcvar__t_html_a376ca13f147f306d71edbe7670e138b0"><div class="ttname"><a href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">cvar_t::integer</a></div><div class="ttdeci">int integer</div><div class="ttdef"><b>Definition</b> <a href="cvar_8h_source.html#l00073">cvar.h:73</a></div></div>
<div class="ttc" id="astructjpeg__decompress__struct_html"><div class="ttname"><a href="structjpeg__decompress__struct.html">jpeg_decompress_struct</a></div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00222">jpeg.c:223</a></div></div>
<div class="ttc" id="astructjpeg__error__mgr_html"><div class="ttname"><a href="structjpeg__error__mgr.html">jpeg_error_mgr</a></div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00124">jpeg.c:125</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="libcurl_8c_source.html#l00487">decode_image()</a>, <a class="el" href="image_8c_source.html#l01043">loadimagepixelsbgra()</a>, and <a class="el" href="clvm__cmds_8c_source.html#l02533">VM_CL_ReadPicture()</a>.</p>

</div>
</div>
<a id="aa11ad53af48f7a9158cbfe2913e227d6" name="aa11ad53af48f7a9158cbfe2913e227d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa11ad53af48f7a9158cbfe2913e227d6">&#9670;&#160;</a></span>JPEG_OpenLibrary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> JPEG_OpenLibrary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jpeg_8c_source.html#l00492">492</a> of file <a class="el" href="jpeg_8c_source.html">jpeg.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  493</span>{</div>
<div class="line"><span class="lineno">  494</span><span class="preprocessor">#ifdef LINK_TO_LIBJPEG</span></div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  496</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  497</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dllnames</a> [] =</div>
<div class="line"><span class="lineno">  498</span>    {</div>
<div class="line"><span class="lineno">  499</span><span class="preprocessor">#if defined(WIN32)</span></div>
<div class="line"><span class="lineno">  500</span>        <span class="stringliteral">&quot;libjpeg.dll&quot;</span>,</div>
<div class="line"><span class="lineno">  501</span><span class="preprocessor">#elif defined(MACOSX)</span></div>
<div class="line"><span class="lineno">  502</span>        <span class="stringliteral">&quot;libjpeg.62.dylib&quot;</span>,</div>
<div class="line"><span class="lineno">  503</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  504</span>        <span class="stringliteral">&quot;libjpeg.so.62&quot;</span>,</div>
<div class="line"><span class="lineno">  505</span>        <span class="stringliteral">&quot;libjpeg.so&quot;</span>,</div>
<div class="line"><span class="lineno">  506</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  507</span>        <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div>
<div class="line"><span class="lineno">  508</span>    };</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="comment">// Already loaded?</span></div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="jpeg_8c.html#a83d500743159436de76baa45240a5c58">jpeg_dll</a>)</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="jpeg_8c.html#ab037ca83fe3319e82580a0044ccb4124">jpeg_tried_loading</a>) <span class="comment">// only try once</span></div>
<div class="line"><span class="lineno">  515</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    <a class="code hl_variable" href="jpeg_8c.html#ab037ca83fe3319e82580a0044ccb4124">jpeg_tried_loading</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span><span class="preprocessor">#ifdef __ANDROID__</span></div>
<div class="line"><span class="lineno">  520</span>    <span class="comment">// loading the native Android libjpeg.so causes crashes</span></div>
<div class="line"><span class="lineno">  521</span>    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Not opening libjpeg.so dynamically on Android - use LINK_TO_LIBJPEG instead if it is needed.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  523</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">// Load the DLL</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="sys_8h.html#a7d5fb719236d753c6487958a306b51c6">Sys_LoadDependency</a> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dllnames</a>, &amp;<a class="code hl_variable" href="jpeg_8c.html#a83d500743159436de76baa45240a5c58">jpeg_dll</a>, <a class="code hl_variable" href="jpeg_8c.html#ad544214e6a3256d5622cdbc0665d37df">jpegfuncs</a>);</div>
<div class="line"><span class="lineno">  527</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  528</span>}</div>
<div class="ttc" id="ajpeg_8c_html_ad544214e6a3256d5622cdbc0665d37df"><div class="ttname"><a href="jpeg_8c.html#ad544214e6a3256d5622cdbc0665d37df">jpegfuncs</a></div><div class="ttdeci">static dllfunction_t jpegfuncs[]</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00435">jpeg.c:435</a></div></div>
<div class="ttc" id="asys_8h_html_a7d5fb719236d753c6487958a306b51c6"><div class="ttname"><a href="sys_8h.html#a7d5fb719236d753c6487958a306b51c6">Sys_LoadDependency</a></div><div class="ttdeci">qbool Sys_LoadDependency(const char **dllnames, dllhandle_t *handle, const dllfunction_t *fcts)</div><div class="ttdef"><b>Definition</b> <a href="sys__shared_8c_source.html#l00128">sys_shared.c:128</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="jpeg_8c_source.html#l01047">Image_Compress()</a>, and <a class="el" href="gl__textures_8c_source.html#l00634">r_textures_start()</a>.</p>

</div>
</div>
<a id="a7ea68e80b101f4106f1111c417299dbf" name="a7ea68e80b101f4106f1111c417299dbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ea68e80b101f4106f1111c417299dbf">&#9670;&#160;</a></span>JPEG_SaveImage_preflipped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> JPEG_SaveImage_preflipped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jpeg_8c_source.html#l00818">818</a> of file <a class="el" href="jpeg_8c_source.html">jpeg.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  819</span>{</div>
<div class="line"><span class="lineno">  820</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structjpeg__compress__struct.html">jpeg_compress_struct</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>;</div>
<div class="line"><span class="lineno">  821</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structjpeg__error__mgr.html">jpeg_error_mgr</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jerr</a>;</div>
<div class="line"><span class="lineno">  822</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>;</div>
<div class="line"><span class="lineno">  823</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#a9d8e5095d0454547c650ff9bde64f8e6">offset</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">linesize</a>;</div>
<div class="line"><span class="lineno">  824</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">qfile_t</a>* file;</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>    <span class="comment">// No DLL = no JPEGs</span></div>
<div class="line"><span class="lineno">  827</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="jpeg_8c.html#a83d500743159436de76baa45240a5c58">jpeg_dll</a>)</div>
<div class="line"><span class="lineno">  828</span>    {</div>
<div class="line"><span class="lineno">  829</span>        <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;You need the libjpeg library to save JPEG images\n&quot;</span>);</div>
<div class="line"><span class="lineno">  830</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  831</span>    }</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>    <span class="comment">// Open the file</span></div>
<div class="line"><span class="lineno">  834</span>    file = <a class="code hl_function" href="fs_8c.html#a7757c6165ecaee803fba8e3d1db3e2e9">FS_OpenRealFile</a>(filename, <span class="stringliteral">&quot;wb&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordflow">if</span> (!file)</div>
<div class="line"><span class="lineno">  836</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">setjmp</a>(<a class="code hl_variable" href="jpeg_8c.html#a88dc06dee982dfeff84484ac0b85dbb6">error_in_jpeg</a>))</div>
<div class="line"><span class="lineno">  839</span>        <span class="keywordflow">goto</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">error_caught</a>;</div>
<div class="line"><span class="lineno">  840</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.err = <a class="code hl_variable" href="jpeg_8c.html#a085c2ca0e1636ab9ad1007b5e6d9b41a">qjpeg_std_error</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jerr</a>);</div>
<div class="line"><span class="lineno">  841</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.err-&gt;error_exit = <a class="code hl_function" href="jpeg_8c.html#ae84a1cb734dbf063e57cc498750dffb1">JPEG_ErrorExit</a>;</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>    <a class="code hl_define" href="jpeg_8c.html#af117d855fb01a8313f29fdfdd714f4d4">qjpeg_create_compress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  844</span>    <a class="code hl_function" href="jpeg_8c.html#ab28de73f2b65b9526149847783054202">JPEG_FileDest</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, file);</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>    <span class="comment">// Set the parameters for compression</span></div>
<div class="line"><span class="lineno">  847</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.image_width = <a class="code hl_variable" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a>;</div>
<div class="line"><span class="lineno">  848</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.image_height = <a class="code hl_variable" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a>;</div>
<div class="line"><span class="lineno">  849</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.in_color_space = <a class="code hl_enumvalue" href="jpeg_8c.html#a6ea40239360b06efe6377f125f1134f3aea1348cf43a3ffbf0cd106348892aadf">JCS_RGB</a>;</div>
<div class="line"><span class="lineno">  850</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.input_components = 3;</div>
<div class="line"><span class="lineno">  851</span>    <a class="code hl_variable" href="jpeg_8c.html#aab33d9cd5bdfdd385c5277cfc500f5b0">qjpeg_set_defaults</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  852</span>    <a class="code hl_variable" href="jpeg_8c.html#aaa05e550852aa3627090563761883c1d">qjpeg_set_quality</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, (<span class="keywordtype">int</span>)(<a class="code hl_variable" href="cl__screen_8c.html#ae1f55d8758d37aa6c5c64a3c8f76deaf">scr_screenshot_jpeg_quality</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> * 100), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  853</span>    <a class="code hl_variable" href="jpeg_8c.html#a9c45946997eed8b6538ec9d93cdec8c4">qjpeg_simple_progression</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    <span class="comment">// turn off subsampling (to make text look better)</span></div>
<div class="line"><span class="lineno">  856</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.optimize_coding = 1;</div>
<div class="line"><span class="lineno">  857</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.comp_info[0].h_samp_factor = 1;</div>
<div class="line"><span class="lineno">  858</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.comp_info[0].v_samp_factor = 1;</div>
<div class="line"><span class="lineno">  859</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.comp_info[1].h_samp_factor = 1;</div>
<div class="line"><span class="lineno">  860</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.comp_info[1].v_samp_factor = 1;</div>
<div class="line"><span class="lineno">  861</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.comp_info[2].h_samp_factor = 1;</div>
<div class="line"><span class="lineno">  862</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.comp_info[2].v_samp_factor = 1;</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>    <a class="code hl_variable" href="jpeg_8c.html#a5c0eed7bb41607dd00d53c41c6626844">qjpeg_start_compress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>    <span class="comment">// Compress each scanline</span></div>
<div class="line"><span class="lineno">  867</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">linesize</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.image_width * 3;</div>
<div class="line"><span class="lineno">  868</span>    <a class="code hl_variable" href="glquake_8h.html#a9d8e5095d0454547c650ff9bde64f8e6">offset</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">linesize</a> * (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.image_height - 1);</div>
<div class="line"><span class="lineno">  869</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.next_scanline &lt; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.image_height)</div>
<div class="line"><span class="lineno">  870</span>    {</div>
<div class="line"><span class="lineno">  871</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a> = &amp;<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[<a class="code hl_variable" href="glquake_8h.html#a9d8e5095d0454547c650ff9bde64f8e6">offset</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.next_scanline * <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">linesize</a>];</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>        <a class="code hl_variable" href="jpeg_8c.html#a60c056b8d9c730965d1537b507942ca8">qjpeg_write_scanlines</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">scanline</a>, 1);</div>
<div class="line"><span class="lineno">  874</span>    }</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>    <a class="code hl_variable" href="jpeg_8c.html#a1e773f2ba21fb760e46d4f5aa4711815">qjpeg_finish_compress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  877</span>    <a class="code hl_variable" href="jpeg_8c.html#a69864795fd78aef43839f588512e2233">qjpeg_destroy_compress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>    <a class="code hl_function" href="fs_8c.html#abcf26e98f08b7bbcc5645486294ebb5c">FS_Close</a> (file);</div>
<div class="line"><span class="lineno">  880</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span><a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">error_caught</a>:</div>
<div class="line"><span class="lineno">  883</span>    <a class="code hl_variable" href="jpeg_8c.html#a69864795fd78aef43839f588512e2233">qjpeg_destroy_compress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  884</span>    <a class="code hl_function" href="fs_8c.html#abcf26e98f08b7bbcc5645486294ebb5c">FS_Close</a> (file);</div>
<div class="line"><span class="lineno">  885</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  886</span>}</div>
<div class="ttc" id="acl__screen_8c_html_ae1f55d8758d37aa6c5c64a3c8f76deaf"><div class="ttname"><a href="cl__screen_8c.html#ae1f55d8758d37aa6c5c64a3c8f76deaf">scr_screenshot_jpeg_quality</a></div><div class="ttdeci">cvar_t scr_screenshot_jpeg_quality</div><div class="ttdef"><b>Definition</b> <a href="cl__screen_8c_source.html#l00060">cl_screen.c:60</a></div></div>
<div class="ttc" id="afs_8c_html_a7757c6165ecaee803fba8e3d1db3e2e9"><div class="ttname"><a href="fs_8c.html#a7757c6165ecaee803fba8e3d1db3e2e9">FS_OpenRealFile</a></div><div class="ttdeci">qfile_t * FS_OpenRealFile(const char *filepath, const char *mode, qbool quiet)</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l02897">fs.c:2897</a></div></div>
<div class="ttc" id="afs_8c_html_abcf26e98f08b7bbcc5645486294ebb5c"><div class="ttname"><a href="fs_8c.html#abcf26e98f08b7bbcc5645486294ebb5c">FS_Close</a></div><div class="ttdeci">int FS_Close(qfile_t *file)</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l02966">fs.c:2966</a></div></div>
<div class="ttc" id="aglquake_8h_html_a0e843e6cb4b0547b3a2b414af3d53a53"><div class="ttname"><a href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a></div><div class="ttdeci">GLenum GLsizei width</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00621">glquake.h:621</a></div></div>
<div class="ttc" id="aglquake_8h_html_a136cce2f78c36b837ec3c8cf72c96aad"><div class="ttname"><a href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a></div><div class="ttdeci">GLenum GLsizei GLsizei height</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00621">glquake.h:621</a></div></div>
<div class="ttc" id="aglquake_8h_html_a820662f5b80a48256e2503352e9f51b9"><div class="ttname"><a href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a></div><div class="ttdeci">GLsizeiptr const GLvoid * data</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00638">glquake.h:638</a></div></div>
<div class="ttc" id="aglquake_8h_html_a9d8e5095d0454547c650ff9bde64f8e6"><div class="ttname"><a href="glquake_8h.html#a9d8e5095d0454547c650ff9bde64f8e6">offset</a></div><div class="ttdeci">GLuint GLuint GLintptr offset</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00631">glquake.h:631</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a1e773f2ba21fb760e46d4f5aa4711815"><div class="ttname"><a href="jpeg_8c.html#a1e773f2ba21fb760e46d4f5aa4711815">qjpeg_finish_compress</a></div><div class="ttdeci">static void(* qjpeg_finish_compress)(j_compress_ptr cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00422">jpeg.c:422</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a5c0eed7bb41607dd00d53c41c6626844"><div class="ttname"><a href="jpeg_8c.html#a5c0eed7bb41607dd00d53c41c6626844">qjpeg_start_compress</a></div><div class="ttdeci">static jboolean(* qjpeg_start_compress)(j_compress_ptr cinfo, jboolean write_all_tables)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00429">jpeg.c:429</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a60c056b8d9c730965d1537b507942ca8"><div class="ttname"><a href="jpeg_8c.html#a60c056b8d9c730965d1537b507942ca8">qjpeg_write_scanlines</a></div><div class="ttdeci">static JDIMENSION(* qjpeg_write_scanlines)(j_compress_ptr cinfo, unsigned char **scanlines, JDIMENSION num_lines)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00432">jpeg.c:432</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a69864795fd78aef43839f588512e2233"><div class="ttname"><a href="jpeg_8c.html#a69864795fd78aef43839f588512e2233">qjpeg_destroy_compress</a></div><div class="ttdeci">static void(* qjpeg_destroy_compress)(j_compress_ptr cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00420">jpeg.c:420</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a6ea40239360b06efe6377f125f1134f3aea1348cf43a3ffbf0cd106348892aadf"><div class="ttname"><a href="jpeg_8c.html#a6ea40239360b06efe6377f125f1134f3aea1348cf43a3ffbf0cd106348892aadf">JCS_RGB</a></div><div class="ttdeci">@ JCS_RGB</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00082">jpeg.c:82</a></div></div>
<div class="ttc" id="ajpeg_8c_html_a9c45946997eed8b6538ec9d93cdec8c4"><div class="ttname"><a href="jpeg_8c.html#a9c45946997eed8b6538ec9d93cdec8c4">qjpeg_simple_progression</a></div><div class="ttdeci">static void(* qjpeg_simple_progression)(j_compress_ptr cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00433">jpeg.c:433</a></div></div>
<div class="ttc" id="ajpeg_8c_html_aaa05e550852aa3627090563761883c1d"><div class="ttname"><a href="jpeg_8c.html#aaa05e550852aa3627090563761883c1d">qjpeg_set_quality</a></div><div class="ttdeci">static void(* qjpeg_set_quality)(j_compress_ptr cinfo, int quality, jboolean force_baseline)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00428">jpeg.c:428</a></div></div>
<div class="ttc" id="ajpeg_8c_html_aab33d9cd5bdfdd385c5277cfc500f5b0"><div class="ttname"><a href="jpeg_8c.html#aab33d9cd5bdfdd385c5277cfc500f5b0">qjpeg_set_defaults</a></div><div class="ttdeci">static void(* qjpeg_set_defaults)(j_compress_ptr cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00427">jpeg.c:427</a></div></div>
<div class="ttc" id="ajpeg_8c_html_ab28de73f2b65b9526149847783054202"><div class="ttname"><a href="jpeg_8c.html#ab28de73f2b65b9526149847783054202">JPEG_FileDest</a></div><div class="ttdeci">static void JPEG_FileDest(j_compress_ptr cinfo, qfile_t *outfile)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00756">jpeg.c:756</a></div></div>
<div class="ttc" id="ajpeg_8c_html_af117d855fb01a8313f29fdfdd714f4d4"><div class="ttname"><a href="jpeg_8c.html#af117d855fb01a8313f29fdfdd714f4d4">qjpeg_create_compress</a></div><div class="ttdeci">#define qjpeg_create_compress(cinfo)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00413">jpeg.c:413</a></div></div>
<div class="ttc" id="astructcvar__t_html_a305faa0167494135297f1b8e6216d469"><div class="ttname"><a href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">cvar_t::value</a></div><div class="ttdeci">float value</div><div class="ttdef"><b>Definition</b> <a href="cvar_8h_source.html#l00074">cvar.h:74</a></div></div>
<div class="ttc" id="astructjpeg__compress__struct_html"><div class="ttname"><a href="structjpeg__compress__struct.html">jpeg_compress_struct</a></div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00320">jpeg.c:321</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="cl__screen_8c_source.html#l01474">SCR_ScreenShot()</a>.</p>

</div>
</div>
<a id="ad22e4351f8a41a17139362ffdb9b1df7" name="ad22e4351f8a41a17139362ffdb9b1df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad22e4351f8a41a17139362ffdb9b1df7">&#9670;&#160;</a></span>JPEG_SaveImage_to_Buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> JPEG_SaveImage_to_Buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>jpegbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>jpegsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>0 if failed, or the size actually used. </dd></dl>

<p class="definition">Definition at line <a class="el" href="jpeg_8c_source.html#l00931">931</a> of file <a class="el" href="jpeg_8c_source.html">jpeg.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  932</span>{</div>
<div class="line"><span class="lineno">  933</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structjpeg__compress__struct.html">jpeg_compress_struct</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>;</div>
<div class="line"><span class="lineno">  934</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structjpeg__error__mgr.html">jpeg_error_mgr</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jerr</a>;</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>    <span class="keywordtype">int</span> quality;</div>
<div class="line"><span class="lineno">  937</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">quality_guess</a>;</div>
<div class="line"><span class="lineno">  938</span>    <span class="keywordtype">size_t</span> result;</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>    <span class="comment">// No DLL = no JPEGs</span></div>
<div class="line"><span class="lineno">  941</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="jpeg_8c.html#a83d500743159436de76baa45240a5c58">jpeg_dll</a>)</div>
<div class="line"><span class="lineno">  942</span>    {</div>
<div class="line"><span class="lineno">  943</span>        <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;You need the libjpeg library to save JPEG images\n&quot;</span>);</div>
<div class="line"><span class="lineno">  944</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  945</span>    }</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">setjmp</a>(<a class="code hl_variable" href="jpeg_8c.html#a88dc06dee982dfeff84484ac0b85dbb6">error_in_jpeg</a>))</div>
<div class="line"><span class="lineno">  948</span>        <span class="keywordflow">goto</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">error_caught</a>;</div>
<div class="line"><span class="lineno">  949</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.err = <a class="code hl_variable" href="jpeg_8c.html#a085c2ca0e1636ab9ad1007b5e6d9b41a">qjpeg_std_error</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jerr</a>);</div>
<div class="line"><span class="lineno">  950</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>.err-&gt;error_exit = <a class="code hl_function" href="jpeg_8c.html#ae84a1cb734dbf063e57cc498750dffb1">JPEG_ErrorExit</a>;</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>    <a class="code hl_define" href="jpeg_8c.html#af117d855fb01a8313f29fdfdd714f4d4">qjpeg_create_compress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span><span class="preprocessor">#if 0</span></div>
<div class="line"><span class="lineno">  955</span>    <span class="comment">// used to get the formula below</span></div>
<div class="line"><span class="lineno">  956</span>    {</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[1048576];</div>
<div class="line"><span class="lineno">  958</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#a3c3adcdb77335f00a87aa5f96a24eb2e">img</a>;</div>
<div class="line"><span class="lineno">  959</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  960</span> </div>
<div class="line"><span class="lineno">  961</span>        <a class="code hl_variable" href="glquake_8h.html#a3c3adcdb77335f00a87aa5f96a24eb2e">img</a> = <a class="code hl_define" href="zone_8h.html#a1f8b0c54fe3d32858da2b13a4f7e5783">Mem_Alloc</a>(<a class="code hl_variable" href="zone_8c.html#ac742acee1395c22ccf6d2370d465f844">tempmempool</a>, <a class="code hl_variable" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a> * <a class="code hl_variable" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a> * 3);</div>
<div class="line"><span class="lineno">  962</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_variable" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a> * <a class="code hl_variable" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a> * 3; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  963</span>            <a class="code hl_variable" href="glquake_8h.html#a3c3adcdb77335f00a87aa5f96a24eb2e">img</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rand</a>() &amp; 0xFF;</div>
<div class="line"><span class="lineno">  964</span> </div>
<div class="line"><span class="lineno">  965</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= 100; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  966</span>        {</div>
<div class="line"><span class="lineno">  967</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;! %d %d %d %d\n&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a>, <a class="code hl_variable" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, (<span class="keywordtype">int</span>) <a class="code hl_function" href="jpeg_8c.html#aaeaf75108768fc524b293fae1f1e91c5">JPEG_try_SaveImage_to_Buffer</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a>, <a class="code hl_variable" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a>, <a class="code hl_variable" href="glquake_8h.html#a3c3adcdb77335f00a87aa5f96a24eb2e">img</a>));</div>
<div class="line"><span class="lineno">  968</span>        }</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>        <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a>(<a class="code hl_variable" href="glquake_8h.html#a3c3adcdb77335f00a87aa5f96a24eb2e">img</a>);</div>
<div class="line"><span class="lineno">  971</span>    }</div>
<div class="line"><span class="lineno">  972</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>    <span class="comment">//quality_guess = (int)((100 * jpegsize - 41000) / (width*height) + 2); // fits random data</span></div>
<div class="line"><span class="lineno">  975</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">quality_guess</a>   = (<a class="code hl_function" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>)((256 * <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jpegsize</a> - 81920) / (<a class="code hl_variable" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a>*<a class="code hl_variable" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a>) - 8); <span class="comment">// fits Nexuiz&#39;s/Xonotic&#39;s map pictures</span></div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">quality_guess</a> = <a class="code hl_define" href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a>(0, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">quality_guess</a>, 100);</div>
<div class="line"><span class="lineno">  978</span>    quality = <a class="code hl_define" href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a>(0, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">quality_guess</a> + <a class="code hl_variable" href="jpeg_8c.html#ab7ea420958e7d2e15a38019b4357f147">sv_writepicture_quality</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>, 100); <span class="comment">// assume it can do 10 failed attempts</span></div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>    <span class="keywordflow">while</span>(!(result = <a class="code hl_function" href="jpeg_8c.html#aaeaf75108768fc524b293fae1f1e91c5">JPEG_try_SaveImage_to_Buffer</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jpegbuf</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jpegsize</a>, quality, <a class="code hl_variable" href="glquake_8h.html#a0e843e6cb4b0547b3a2b414af3d53a53">width</a>, <a class="code hl_variable" href="glquake_8h.html#a136cce2f78c36b837ec3c8cf72c96aad">height</a>, <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>)))</div>
<div class="line"><span class="lineno">  981</span>    {</div>
<div class="line"><span class="lineno">  982</span>        --quality;</div>
<div class="line"><span class="lineno">  983</span>        <span class="keywordflow">if</span>(quality &lt; 0)</div>
<div class="line"><span class="lineno">  984</span>        {</div>
<div class="line"><span class="lineno">  985</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;couldn&#39;t write image at all, probably too big\n&quot;</span>);</div>
<div class="line"><span class="lineno">  986</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  987</span>        }</div>
<div class="line"><span class="lineno">  988</span>    }</div>
<div class="line"><span class="lineno">  989</span>    <a class="code hl_variable" href="jpeg_8c.html#a69864795fd78aef43839f588512e2233">qjpeg_destroy_compress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  990</span>    <a class="code hl_function" href="console_8c.html#a2696300802453d9333e9f52e5fae15bc">Con_DPrintf</a>(<span class="stringliteral">&quot;JPEG_SaveImage_to_Buffer: guessed quality/size %d/%d, actually got %d/%d\n&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">quality_guess</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">jpegsize</a>, quality, (<span class="keywordtype">int</span>)result);</div>
<div class="line"><span class="lineno">  991</span> </div>
<div class="line"><span class="lineno">  992</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span><a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">error_caught</a>:</div>
<div class="line"><span class="lineno">  995</span>    <a class="code hl_variable" href="jpeg_8c.html#a69864795fd78aef43839f588512e2233">qjpeg_destroy_compress</a> (&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cinfo</a>);</div>
<div class="line"><span class="lineno">  996</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  997</span>}</div>
<div class="ttc" id="aconsole_8c_html_a2696300802453d9333e9f52e5fae15bc"><div class="ttname"><a href="console_8c.html#a2696300802453d9333e9f52e5fae15bc">Con_DPrintf</a></div><div class="ttdeci">void Con_DPrintf(const char *fmt,...)</div><div class="ttdoc">A Con_Printf that only shows up if the &quot;developer&quot; cvar is set.</div><div class="ttdef"><b>Definition</b> <a href="console_8c_source.html#l01490">console.c:1490</a></div></div>
<div class="ttc" id="afs_8c_html_a93257bedba32e45fc3f07bea139c0604"><div class="ttname"><a href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a></div><div class="ttdeci">static int(ZEXPORT *qz_inflate)(z_stream *strm</div></div>
<div class="ttc" id="aglquake_8h_html_a3c3adcdb77335f00a87aa5f96a24eb2e"><div class="ttname"><a href="glquake_8h.html#a3c3adcdb77335f00a87aa5f96a24eb2e">img</a></div><div class="ttdeci">GLint void * img</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00691">glquake.h:691</a></div></div>
<div class="ttc" id="ajpeg_8c_html_aaeaf75108768fc524b293fae1f1e91c5"><div class="ttname"><a href="jpeg_8c.html#aaeaf75108768fc524b293fae1f1e91c5">JPEG_try_SaveImage_to_Buffer</a></div><div class="ttdeci">static size_t JPEG_try_SaveImage_to_Buffer(struct jpeg_compress_struct *cinfo, char *jpegbuf, size_t jpegsize, int quality, int width, int height, unsigned char *data)</div><div class="ttdef"><b>Definition</b> <a href="jpeg_8c_source.html#l00888">jpeg.c:888</a></div></div>
<div class="ttc" id="ajpeg_8c_html_ab7ea420958e7d2e15a38019b4357f147"><div class="ttname"><a href="jpeg_8c.html#ab7ea420958e7d2e15a38019b4357f147">sv_writepicture_quality</a></div><div class="ttdeci">cvar_t sv_writepicture_quality</div><div class="ttdef"><b>Definition</b> <a href="sv__main_8c_source.html#l00218">sv_main.c:218</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="jpeg_8c_source.html#l01047">Image_Compress()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="jpeg_8h.html">jpeg.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
