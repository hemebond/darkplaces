<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DarkPlaces: crypto.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-customisations.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="darkplaces48x48.png"/></td>
  <td id="projectalign">
   <div id="projectname">DarkPlaces
   </div>
   <div id="projectbrief">Game engine based on the Quake 1 engine by id Software, developed by LadyHavoc</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('crypto_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">crypto.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="quakedef_8h_source.html">quakedef.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="thread_8h_source.html">thread.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hmac_8h_source.html">hmac.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="libcurl_8h_source.html">libcurl.h</a>&quot;</code><br />
</div>
<p><a href="crypto_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structserver__cryptoconnect__t.html">server_cryptoconnect_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__data__t.html">crypto_data_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a415708eb37a2ec762abe53d4dac87ac0" id="r_a415708eb37a2ec762abe53d4dac87ac0"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a415708eb37a2ec762abe53d4dac87ac0">PROTOCOL_D0_BLIND_ID</a>&#160;&#160;&#160;<a class="el" href="crypto-keygen-standalone_8c.html#a207294545e7e194a700239bd148de2ac">FOURCC_D0PK</a></td></tr>
<tr class="separator:a415708eb37a2ec762abe53d4dac87ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ba1c091c9f8d31b8761c8c6c8e12a74" id="r_a2ba1c091c9f8d31b8761c8c6c8e12a74"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2ba1c091c9f8d31b8761c8c6c8e12a74">PROTOCOL_VLEN</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>' &lt;&lt; 0) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>' &lt;&lt; 8) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">e</a>' &lt;&lt; 16) | ('<a class="el" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>' &lt;&lt; 24))</td></tr>
<tr class="separator:a2ba1c091c9f8d31b8761c8c6c8e12a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207294545e7e194a700239bd148de2ac" id="r_a207294545e7e194a700239bd148de2ac"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a207294545e7e194a700239bd148de2ac">FOURCC_D0PK</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('p' &lt;&lt; 16) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>' &lt;&lt; 24))</td></tr>
<tr class="separator:a207294545e7e194a700239bd148de2ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9408e24bf177d7c2602f1497b315f969" id="r_a9408e24bf177d7c2602f1497b315f969"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9408e24bf177d7c2602f1497b315f969">FOURCC_D0SK</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('s' &lt;&lt; 16) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>' &lt;&lt; 24))</td></tr>
<tr class="separator:a9408e24bf177d7c2602f1497b315f969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c387d8ee20257119425b2b2137fdb2" id="r_a89c387d8ee20257119425b2b2137fdb2"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a89c387d8ee20257119425b2b2137fdb2">FOURCC_D0PI</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('p' &lt;&lt; 16) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 24))</td></tr>
<tr class="separator:a89c387d8ee20257119425b2b2137fdb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cfb14fb175de61c8f50eaf4ae8be02a" id="r_a6cfb14fb175de61c8f50eaf4ae8be02a"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6cfb14fb175de61c8f50eaf4ae8be02a">FOURCC_D0SI</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('s' &lt;&lt; 16) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 24))</td></tr>
<tr class="separator:a6cfb14fb175de61c8f50eaf4ae8be02a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfd3a4ea879edc599acb8ee0ff614d8e" id="r_adfd3a4ea879edc599acb8ee0ff614d8e"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#adfd3a4ea879edc599acb8ee0ff614d8e">FOURCC_D0IQ</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 16) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">q</a>' &lt;&lt; 24))</td></tr>
<tr class="separator:adfd3a4ea879edc599acb8ee0ff614d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a952ca24af982e8a9dde40f9bfd860882" id="r_a952ca24af982e8a9dde40f9bfd860882"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a952ca24af982e8a9dde40f9bfd860882">FOURCC_D0IR</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 16) | ('<a class="el" href="shader__glsl_8h.html#a008e65201d4481545ed89903a22f667a">r</a>' &lt;&lt; 24))</td></tr>
<tr class="separator:a952ca24af982e8a9dde40f9bfd860882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abef3a6061b8a9869eeba8ac100f10d4d" id="r_abef3a6061b8a9869eeba8ac100f10d4d"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abef3a6061b8a9869eeba8ac100f10d4d">FOURCC_D0ER</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">e</a>' &lt;&lt; 16) | ('<a class="el" href="shader__glsl_8h.html#a008e65201d4481545ed89903a22f667a">r</a>' &lt;&lt; 24))</td></tr>
<tr class="separator:abef3a6061b8a9869eeba8ac100f10d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a130dc520e3510ecb53e73356184ee9dd" id="r_a130dc520e3510ecb53e73356184ee9dd"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a130dc520e3510ecb53e73356184ee9dd">FOURCC_D0IC</a>&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 16) | ('c' &lt;&lt; 24))</td></tr>
<tr class="separator:a130dc520e3510ecb53e73356184ee9dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0764ae836719cd84a09939276875cee" id="r_af0764ae836719cd84a09939276875cee"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af0764ae836719cd84a09939276875cee">USE_AES</a></td></tr>
<tr class="separator:af0764ae836719cd84a09939276875cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60d4582b2e05d234358e37f6357d26bd" id="r_a60d4582b2e05d234358e37f6357d26bd"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a></td></tr>
<tr class="separator:a60d4582b2e05d234358e37f6357d26bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0621e91f6f7f0e31c054018cffff852e" id="r_a0621e91f6f7f0e31c054018cffff852e"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a></td></tr>
<tr class="separator:a0621e91f6f7f0e31c054018cffff852e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cc28a754edbe5c9184d04bb4a6ad76a" id="r_a2cc28a754edbe5c9184d04bb4a6ad76a"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;&#160;&#160;<a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a></td></tr>
<tr class="separator:a2cc28a754edbe5c9184d04bb4a6ad76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0d5a8f17f24d42f5e9c58645ac3a178" id="r_ab0d5a8f17f24d42f5e9c58645ac3a178"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab0d5a8f17f24d42f5e9c58645ac3a178">D0_RIJNDAEL_KEYLENGTH</a>(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)&#160;&#160;&#160;((<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)/8)</td></tr>
<tr class="separator:ab0d5a8f17f24d42f5e9c58645ac3a178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae40679674b1d1578562cb4e1d13c48bb" id="r_ae40679674b1d1578562cb4e1d13c48bb"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae40679674b1d1578562cb4e1d13c48bb">D0_RIJNDAEL_RKLENGTH</a>(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)&#160;&#160;&#160;((<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)/8+28)</td></tr>
<tr class="separator:ae40679674b1d1578562cb4e1d13c48bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae3fa2cd7b52a90123438b9b4ea38efb" id="r_aae3fa2cd7b52a90123438b9b4ea38efb"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aae3fa2cd7b52a90123438b9b4ea38efb">D0_RIJNDAEL_NROUNDS</a>(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)&#160;&#160;&#160;((<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)/32+6)</td></tr>
<tr class="separator:aae3fa2cd7b52a90123438b9b4ea38efb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81517c37964da8773c8a85b39cbe62ef" id="r_a81517c37964da8773c8a85b39cbe62ef"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a81517c37964da8773c8a85b39cbe62ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0227d3cfd03cca7f1cb298e750152c61" id="r_a0227d3cfd03cca7f1cb298e750152c61"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a0227d3cfd03cca7f1cb298e750152c61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51e64ae560deec18fe339cf0c2192cc7" id="r_a51e64ae560deec18fe339cf0c2192cc7"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a51e64ae560deec18fe339cf0c2192cc7">CRYPTOCONNECT_NONE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a51e64ae560deec18fe339cf0c2192cc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c980015873bb7e757fd28d81fe5374" id="r_a98c980015873bb7e757fd28d81fe5374"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a98c980015873bb7e757fd28d81fe5374">CRYPTOCONNECT_PRECONNECT</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a98c980015873bb7e757fd28d81fe5374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b21b9b224ac66403379dc81f79ee43" id="r_ad9b21b9b224ac66403379dc81f79ee43"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad9b21b9b224ac66403379dc81f79ee43">CRYPTOCONNECT_CONNECT</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ad9b21b9b224ac66403379dc81f79ee43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f29bdb652dbc3cb7011a9b727ecddc9" id="r_a9f29bdb652dbc3cb7011a9b727ecddc9"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9f29bdb652dbc3cb7011a9b727ecddc9">CRYPTOCONNECT_RECONNECT</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a9f29bdb652dbc3cb7011a9b727ecddc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bb3dfd3d76e2f6853fa61f046122d6e" id="r_a9bb3dfd3d76e2f6853fa61f046122d6e"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9bb3dfd3d76e2f6853fa61f046122d6e">CRYPTOCONNECT_DUPLICATE</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a9bb3dfd3d76e2f6853fa61f046122d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72048b767e62a20b79bde41af5b4615c" id="r_a72048b767e62a20b79bde41af5b4615c"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>&#160;&#160;&#160;((<a class="el" href="structcrypto__data__t.html">crypto_data_t</a> *) crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>)</td></tr>
<tr class="separator:a72048b767e62a20b79bde41af5b4615c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e2d859ffde566232fcd3e099be1acc9" id="r_a9e2d859ffde566232fcd3e099be1acc9"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9e2d859ffde566232fcd3e099be1acc9">MAKE_CDATA</a>&#160;&#160;&#160;<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">if</a>(!crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>) crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> = <a class="el" href="zone_8h.html#a35deb8ef816a08fb1bc8feac8db020c5">Z_Malloc</a>(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">sizeof</a>(<a class="el" href="structcrypto__data__t.html">crypto_data_t</a>))</td></tr>
<tr class="separator:a9e2d859ffde566232fcd3e099be1acc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0749fdaf63ce66fa265a6eb1d352a36" id="r_ae0749fdaf63ce66fa265a6eb1d352a36"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>&#160;&#160;&#160;<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">if</a>(crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>) { <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">if</a>(<a class="el" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;<a class="el" href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a>) <a class="el" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="el" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;<a class="el" href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a>); <a class="el" href="zone_8h.html#abbce8ea44a12486a6b59f31f02bab5ee">Z_Free</a>(crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>); } crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> = <a class="el" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td></tr>
<tr class="separator:ae0749fdaf63ce66fa265a6eb1d352a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abb3ae89a45f60de77f1dd02d6c2a5328" id="r_abb3ae89a45f60de77f1dd02d6c2a5328"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abb3ae89a45f60de77f1dd02d6c2a5328">d0_malloc_t</a>(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:abb3ae89a45f60de77f1dd02d6c2a5328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2efe40262b15742cbcd54501782639e5" id="r_a2efe40262b15742cbcd54501782639e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2efe40262b15742cbcd54501782639e5">d0_free_t</a>(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *p)</td></tr>
<tr class="separator:a2efe40262b15742cbcd54501782639e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15bf368c6c65ee2efeb72b13e8390298" id="r_a15bf368c6c65ee2efeb72b13e8390298"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a15bf368c6c65ee2efeb72b13e8390298">d0_createmutex_t</a>(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a15bf368c6c65ee2efeb72b13e8390298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c84d33e1ae7fabefa009ded492313f" id="r_a17c84d33e1ae7fabefa009ded492313f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a17c84d33e1ae7fabefa009ded492313f">d0_destroymutex_t</a>(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *)</td></tr>
<tr class="separator:a17c84d33e1ae7fabefa009ded492313f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c8d295a5d00c9b704eeaf9cdc2c554" id="r_a03c8d295a5d00c9b704eeaf9cdc2c554"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a03c8d295a5d00c9b704eeaf9cdc2c554">d0_lockmutex_t</a>(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *)</td></tr>
<tr class="separator:a03c8d295a5d00c9b704eeaf9cdc2c554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd63a13cc35cc9a1f783b8d383342c00" id="r_abd63a13cc35cc9a1f783b8d383342c00"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abd63a13cc35cc9a1f783b8d383342c00">d0_unlockmutex_t</a>(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *)</td></tr>
<tr class="separator:abd63a13cc35cc9a1f783b8d383342c00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4e48fcb3e2bb84bb6d537bcdf564935" id="r_ab4e48fcb3e2bb84bb6d537bcdf564935"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d0_blind_id_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a></td></tr>
<tr class="separator:ab4e48fcb3e2bb84bb6d537bcdf564935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9d5b16f62f27456634480bcde1bc99" id="r_acd9d5b16f62f27456634480bcde1bc99"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#acd9d5b16f62f27456634480bcde1bc99">d0_fastreject_function</a>) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pass</a>)</td></tr>
<tr class="separator:acd9d5b16f62f27456634480bcde1bc99"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab680491cca435a1f84b2e9fa8a973061" id="r_ab680491cca435a1f84b2e9fa8a973061"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>)</td></tr>
<tr class="separator:ab680491cca435a1f84b2e9fa8a973061"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7aaba47178e17c579b18b5d27b4bb83" id="r_ae7aaba47178e17c579b18b5d27b4bb83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae7aaba47178e17c579b18b5d27b4bb83">Crypto_UnLittleLong</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>)</td></tr>
<tr class="separator:ae7aaba47178e17c579b18b5d27b4bb83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad099246d8ff3e9be8f5f4c35bf14d5d" id="r_aad099246d8ff3e9be8f5f4c35bf14d5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aad099246d8ff3e9be8f5f4c35bf14d5d">Crypto_ParsePack</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> header, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> **lumps, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nlumps</a>)</td></tr>
<tr class="separator:aad099246d8ff3e9be8f5f4c35bf14d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858dccc118582ddc67008845ede2a273" id="r_a858dccc118582ddc67008845ede2a273"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a858dccc118582ddc67008845ede2a273">Crypto_UnParsePack</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> header, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> *lumps, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nlumps</a>)</td></tr>
<tr class="separator:a858dccc118582ddc67008845ede2a273"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc7bf287af177afa9b29d2e79ef0559" id="r_a6cc7bf287af177afa9b29d2e79ef0559"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6cc7bf287af177afa9b29d2e79ef0559">Crypto_OpenLibrary</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a6cc7bf287af177afa9b29d2e79ef0559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd38a734f1d86b5075d6d6a82c71b7b" id="r_acdd38a734f1d86b5075d6d6a82c71b7b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#acdd38a734f1d86b5075d6d6a82c71b7b">Crypto_CloseLibrary</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:acdd38a734f1d86b5075d6d6a82c71b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa266b054915a179b802f7177d59e58e9" id="r_aa266b054915a179b802f7177d59e58e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa266b054915a179b802f7177d59e58e9">Crypto_Rijndael_OpenLibrary</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:aa266b054915a179b802f7177d59e58e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad54f544f3250410db6aff02f795c322" id="r_aad54f544f3250410db6aff02f795c322"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aad54f544f3250410db6aff02f795c322">Crypto_Rijndael_CloseLibrary</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:aad54f544f3250410db6aff02f795c322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61b0d8e49d857cf554e5db8c601c2be4" id="r_a61b0d8e49d857cf554e5db8c601c2be4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a61b0d8e49d857cf554e5db8c601c2be4">sha256</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *in, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>)</td></tr>
<tr class="separator:a61b0d8e49d857cf554e5db8c601c2be4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6ceb1adf55efb9bc29eea8ba64fdad" id="r_a6c6ceb1adf55efb9bc29eea8ba64fdad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6c6ceb1adf55efb9bc29eea8ba64fdad">Crypto_LoadFile</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *path, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nmax</a>, <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inuserdir</a>)</td></tr>
<tr class="separator:a6c6ceb1adf55efb9bc29eea8ba64fdad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d3d64d18e1c220988f7cff0053d630" id="r_a57d3d64d18e1c220988f7cff0053d630"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> **<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *len, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">str</a>)</td></tr>
<tr class="separator:a57d3d64d18e1c220988f7cff0053d630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae86e7e74ff72144661d72e3a6d347cdc" id="r_ae86e7e74ff72144661d72e3a6d347cdc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> **<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *len)</td></tr>
<tr class="separator:ae86e7e74ff72144661d72e3a6d347cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cb4a9947263eef8d464f94959d0411d" id="r_a5cb4a9947263eef8d464f94959d0411d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5cb4a9947263eef8d464f94959d0411d">Crypto_ReadPublicKey</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:a5cb4a9947263eef8d464f94959d0411d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae509f43bdccf26baf95b3ed68b24d750" id="r_ae509f43bdccf26baf95b3ed68b24d750"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae509f43bdccf26baf95b3ed68b24d750">Crypto_AddPrivateKey</a> (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:ae509f43bdccf26baf95b3ed68b24d750"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33a7c8f188fd12df9099e15fb7aa682" id="r_ae33a7c8f188fd12df9099e15fb7aa682"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae33a7c8f188fd12df9099e15fb7aa682">Crypto_ServerFindInstance</a> (<a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress, <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">allow_create</a>)</td></tr>
<tr class="separator:ae33a7c8f188fd12df9099e15fb7aa682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5609d4a90ca33175311e3fceec6ff6d" id="r_af5609d4a90ca33175311e3fceec6ff6d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af5609d4a90ca33175311e3fceec6ff6d">Crypto_FinishInstance</a> (<a class="el" href="structcrypto__t.html">crypto_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, <a class="el" href="structcrypto__t.html">crypto_t</a> *crypto)</td></tr>
<tr class="separator:af5609d4a90ca33175311e3fceec6ff6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a054ffa4cc3d4babef105c85cbb5f367f" id="r_a054ffa4cc3d4babef105c85cbb5f367f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a054ffa4cc3d4babef105c85cbb5f367f">Crypto_ServerGetInstance</a> (<a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress)</td></tr>
<tr class="separator:a054ffa4cc3d4babef105c85cbb5f367f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c96b96431f5c4f965baa36a690a851e" id="r_a4c96b96431f5c4f965baa36a690a851e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a4c96b96431f5c4f965baa36a690a851e">Crypto_InitHostKeys</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a4c96b96431f5c4f965baa36a690a851e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2531ce5eea2370af4ade686477c9e9f2" id="r_a2531ce5eea2370af4ade686477c9e9f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2531ce5eea2370af4ade686477c9e9f2">Crypto_ClearHostKeys</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a2531ce5eea2370af4ade686477c9e9f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba58302060be72fb4652709fe63dcabf" id="r_aba58302060be72fb4652709fe63dcabf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aba58302060be72fb4652709fe63dcabf">Crypto_ClearHostKey</a> (<a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress)</td></tr>
<tr class="separator:aba58302060be72fb4652709fe63dcabf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf812a19119a94ac6d13e6c6f241e7ad" id="r_aaf812a19119a94ac6d13e6c6f241e7ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a> (<a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>, <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">complain</a>)</td></tr>
<tr class="separator:aaf812a19119a94ac6d13e6c6f241e7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4addd0ad7e9030ba3719926ad25b11b4" id="r_a4addd0ad7e9030ba3719926ad25b11b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a> (<a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *keyid, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfplen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *idfp, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idfplen</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *aeslevel, <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> *issigned)</td></tr>
<tr class="separator:a4addd0ad7e9030ba3719926ad25b11b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530db18ab03fe35200fa035277bc9b03" id="r_a530db18ab03fe35200fa035277bc9b03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a530db18ab03fe35200fa035277bc9b03">Crypto_RetrieveLocalKey</a> (<a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> keyid, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfplen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *idfp, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idfplen</a>, <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> *issigned)</td></tr>
<tr class="separator:a530db18ab03fe35200fa035277bc9b03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ea4fbb85d42f0fe445c6853deb27e3" id="r_af4ea4fbb85d42f0fe445c6853deb27e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af4ea4fbb85d42f0fe445c6853deb27e3">Crypto_BuildChallengeAppend</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:af4ea4fbb85d42f0fe445c6853deb27e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8da1c183634a38674c81c765b2c8e42" id="r_ac8da1c183634a38674c81c765b2c8e42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac8da1c183634a38674c81c765b2c8e42">Crypto_SavePubKeyTextFile</a> (<a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</td></tr>
<tr class="separator:ac8da1c183634a38674c81c765b2c8e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b037eca70363845b5621daa59b81f93" id="r_a7b037eca70363845b5621daa59b81f93"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a7b037eca70363845b5621daa59b81f93">Crypto_BuildIdString</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a7b037eca70363845b5621daa59b81f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6cc26fc4d71eacae07453774cf06de" id="r_a1e6cc26fc4d71eacae07453774cf06de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1e6cc26fc4d71eacae07453774cf06de">Crypto_LoadKeys</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a1e6cc26fc4d71eacae07453774cf06de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82a547776a3b80b6f0a2c04b428e49b" id="r_ab82a547776a3b80b6f0a2c04b428e49b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab82a547776a3b80b6f0a2c04b428e49b">Crypto_UnloadKeys</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:ab82a547776a3b80b6f0a2c04b428e49b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3e46b0be825db44980c41f18e4a27ea" id="r_ad3e46b0be825db44980c41f18e4a27ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad3e46b0be825db44980c41f18e4a27ea">Crypto_d0_malloc</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:ad3e46b0be825db44980c41f18e4a27ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04461f04f135ed9168b3635769dfd3fb" id="r_a04461f04f135ed9168b3635769dfd3fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a04461f04f135ed9168b3635769dfd3fb">Crypto_d0_free</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *p)</td></tr>
<tr class="separator:a04461f04f135ed9168b3635769dfd3fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1ead9aff323c67f6ea971213af9b87" id="r_aef1ead9aff323c67f6ea971213af9b87"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aef1ead9aff323c67f6ea971213af9b87">Crypto_d0_createmutex</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:aef1ead9aff323c67f6ea971213af9b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a246f3b70ce88542638a2e60c057921" id="r_a2a246f3b70ce88542638a2e60c057921"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2a246f3b70ce88542638a2e60c057921">Crypto_d0_destroymutex</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *m)</td></tr>
<tr class="separator:a2a246f3b70ce88542638a2e60c057921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a451c6225535919e74dc187635381c137" id="r_a451c6225535919e74dc187635381c137"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a451c6225535919e74dc187635381c137">Crypto_d0_lockmutex</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *m)</td></tr>
<tr class="separator:a451c6225535919e74dc187635381c137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf9cffdca970c75960fb23d63552825b" id="r_abf9cffdca970c75960fb23d63552825b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abf9cffdca970c75960fb23d63552825b">Crypto_d0_unlockmutex</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *m)</td></tr>
<tr class="separator:abf9cffdca970c75960fb23d63552825b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55a704ba907e52ab40b463e8dcdee49" id="r_aa55a704ba907e52ab40b463e8dcdee49"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa55a704ba907e52ab40b463e8dcdee49">Crypto_Shutdown</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:aa55a704ba907e52ab40b463e8dcdee49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e05ee4f38d1d5a579abfe2980e370f" id="r_ac8e05ee4f38d1d5a579abfe2980e370f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac8e05ee4f38d1d5a579abfe2980e370f">Crypto_Init</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:ac8e05ee4f38d1d5a579abfe2980e370f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1846f2fe5c20c0a720498ab004a620b" id="r_af1846f2fe5c20c0a720498ab004a620b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af1846f2fe5c20c0a720498ab004a620b">Crypto_Available</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:af1846f2fe5c20c0a720498ab004a620b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a974940e63001e09ee6d4b48d0e4de656" id="r_a974940e63001e09ee6d4b48d0e4de656"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a974940e63001e09ee6d4b48d0e4de656">Crypto_KeyGen_Finished</a> (<a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">code</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">length_received</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#a39774db434725e51f4ad4c04150ed6a1">buffer</a>, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cbdata</a>)</td></tr>
<tr class="separator:a974940e63001e09ee6d4b48d0e4de656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f9b2a112d3766361cf97490ac6fb0e" id="r_ad3f9b2a112d3766361cf97490ac6fb0e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad3f9b2a112d3766361cf97490ac6fb0e">Crypto_KeyGen_f</a> (<a class="el" href="structcmd__state__t.html">cmd_state_t</a> *cmd)</td></tr>
<tr class="separator:ad3f9b2a112d3766361cf97490ac6fb0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2face099d8db579f04009cc115b4b7b2" id="r_a2face099d8db579f04009cc115b4b7b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2face099d8db579f04009cc115b4b7b2">Crypto_Reload_f</a> (<a class="el" href="structcmd__state__t.html">cmd_state_t</a> *cmd)</td></tr>
<tr class="separator:a2face099d8db579f04009cc115b4b7b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada60652b956c044bd851cbc63d2b6b2c" id="r_ada60652b956c044bd851cbc63d2b6b2c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ada60652b956c044bd851cbc63d2b6b2c">Crypto_Keys_f</a> (<a class="el" href="structcmd__state__t.html">cmd_state_t</a> *cmd)</td></tr>
<tr class="separator:ada60652b956c044bd851cbc63d2b6b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb12a2be57fc3c4742ea681e22e7708" id="r_a9fb12a2be57fc3c4742ea681e22e7708"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9fb12a2be57fc3c4742ea681e22e7708">Crypto_HostKeys_f</a> (<a class="el" href="structcmd__state__t.html">cmd_state_t</a> *cmd)</td></tr>
<tr class="separator:a9fb12a2be57fc3c4742ea681e22e7708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada3befbe537d810f7aaf3d498ec6823c" id="r_ada3befbe537d810f7aaf3d498ec6823c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ada3befbe537d810f7aaf3d498ec6823c">Crypto_HostKey_Clear_f</a> (<a class="el" href="structcmd__state__t.html">cmd_state_t</a> *cmd)</td></tr>
<tr class="separator:ada3befbe537d810f7aaf3d498ec6823c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc22d3a48652b22d43fb40e750e4cd4" id="r_a2dc22d3a48652b22d43fb40e750e4cd4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2dc22d3a48652b22d43fb40e750e4cd4">Crypto_Init_Commands</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a2dc22d3a48652b22d43fb40e750e4cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3d6a3c0d2952e5dfdd43ad262d46dc" id="r_add3d6a3c0d2952e5dfdd43ad262d46dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#add3d6a3c0d2952e5dfdd43ad262d46dc">aescpy</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *key, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">iv</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *src, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:add3d6a3c0d2952e5dfdd43ad262d46dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65bcc30d6b1ebadfcec50ca06f7bfac5" id="r_a65bcc30d6b1ebadfcec50ca06f7bfac5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a65bcc30d6b1ebadfcec50ca06f7bfac5">seacpy</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *key, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">iv</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *src, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:a65bcc30d6b1ebadfcec50ca06f7bfac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f0f56ef0e8867e2bae48ad0c12eb7c" id="r_a31f0f56ef0e8867e2bae48ad0c12eb7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a31f0f56ef0e8867e2bae48ad0c12eb7c">Crypto_EncryptPacket</a> (<a class="el" href="structcrypto__t.html">crypto_t</a> *crypto, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:a31f0f56ef0e8867e2bae48ad0c12eb7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5edc59e776eb84e8d80fd7a1c83e7973" id="r_a5edc59e776eb84e8d80fd7a1c83e7973"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5edc59e776eb84e8d80fd7a1c83e7973">Crypto_DecryptPacket</a> (<a class="el" href="structcrypto__t.html">crypto_t</a> *crypto, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td></tr>
<tr class="separator:a5edc59e776eb84e8d80fd7a1c83e7973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a13832c196fc6cb7e25fd6f55aa489" id="r_ae0a13832c196fc6cb7e25fd6f55aa489"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae0a13832c196fc6cb7e25fd6f55aa489">Crypto_GetInfoResponseDataString</a> (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:ae0a13832c196fc6cb7e25fd6f55aa489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1d27aad50725635cef9445233a58e3f" id="r_af1d27aad50725635cef9445233a58e3f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af1d27aad50725635cef9445233a58e3f">Crypto_ServerAppendToChallenge</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxlen_out</a>)</td></tr>
<tr class="separator:af1d27aad50725635cef9445233a58e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47f01fa09e28a809c2bf17a9bf68fafb" id="r_a47f01fa09e28a809c2bf17a9bf68fafb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *msg, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msg_client</a>)</td></tr>
<tr class="separator:a47f01fa09e28a809c2bf17a9bf68fafb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c0105d4befc97770091006feafb4d6" id="r_a93c0105d4befc97770091006feafb4d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *msg)</td></tr>
<tr class="separator:a93c0105d4befc97770091006feafb4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54bf4c38d481347e97316d106fb793f3" id="r_a54bf4c38d481347e97316d106fb793f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a54bf4c38d481347e97316d106fb793f3">Crypto_ServerParsePacket_Internal</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress)</td></tr>
<tr class="separator:a54bf4c38d481347e97316d106fb793f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace1b41f4cd5100f173da25da7f726a8f" id="r_ace1b41f4cd5100f173da25da7f726a8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ace1b41f4cd5100f173da25da7f726a8f">Crypto_ServerParsePacket</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress)</td></tr>
<tr class="separator:ace1b41f4cd5100f173da25da7f726a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85cf03eabae9c5ffb347409d468d6f9c" id="r_a85cf03eabae9c5ffb347409d468d6f9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *msg)</td></tr>
<tr class="separator:a85cf03eabae9c5ffb347409d468d6f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca5468ecb996a99a78f68985d23a085d" id="r_aca5468ecb996a99a78f68985d23a085d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *msg)</td></tr>
<tr class="separator:aca5468ecb996a99a78f68985d23a085d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b4969371415991b42f94cc5c82838a" id="r_a29b4969371415991b42f94cc5c82838a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a29b4969371415991b42f94cc5c82838a">Crypto_ClientParsePacket</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *peeraddress, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">peeraddressstring</a>)</td></tr>
<tr class="separator:a29b4969371415991b42f94cc5c82838a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6808cc09c495f2c6eb4bdf1eedbd68" id="r_a3f6808cc09c495f2c6eb4bdf1eedbd68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a3f6808cc09c495f2c6eb4bdf1eedbd68">Crypto_SignData</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">datasize</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> keyid, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>)</td></tr>
<tr class="separator:a3f6808cc09c495f2c6eb4bdf1eedbd68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad247271fff8b625706df45f83222d8ba" id="r_ad247271fff8b625706df45f83222d8ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad247271fff8b625706df45f83222d8ba">Crypto_SignDataDetached</a> (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">datasize</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> keyid, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_data</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>)</td></tr>
<tr class="separator:ad247271fff8b625706df45f83222d8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6f3d29a8d2e8a24dc51d47cba14aef9e" id="r_a6f3d29a8d2e8a24dc51d47cba14aef9e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcvar__t.html">cvar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6f3d29a8d2e8a24dc51d47cba14aef9e">crypto_developer</a> = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_developer&quot;, &quot;0&quot;, &quot;print <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">extra</a> info <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">about</a> crypto <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">handshake&quot;</a>}</td></tr>
<tr class="separator:a6f3d29a8d2e8a24dc51d47cba14aef9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a8e5916e25ff44b9ed67996dba0068" id="r_aa6a8e5916e25ff44b9ed67996dba0068"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcvar__t.html">cvar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a> = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_aeslevel&quot;, &quot;1&quot;, &quot;whether to support <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">AES</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">encryption</a> in authenticated <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">connections</a> (0 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">no</a>, 1 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">supported</a>, 2 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">requested</a>, 3 = required)&quot;}</td></tr>
<tr class="separator:aa6a8e5916e25ff44b9ed67996dba0068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60a6b08ba933d05ae0ba07ba429fe03e" id="r_a60a6b08ba933d05ae0ba07ba429fe03e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcvar__t.html">cvar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a> = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_servercpupercent&quot;, &quot;10&quot;, &quot;allowed crypto <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">CPU</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">load</a> in percent <a class="el" href="shader__glsl_8h.html#a5b8048416847492c5588fff7fada734d">for</a> server <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">operation</a> (0 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">no</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">limit</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">faster</a>)&quot;}</td></tr>
<tr class="separator:a60a6b08ba933d05ae0ba07ba429fe03e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a802583bf599735ca3f90741d55954864" id="r_a802583bf599735ca3f90741d55954864"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcvar__t.html">cvar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a> = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_servercpumaxtime&quot;, &quot;0.01&quot;, &quot;maximum <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">allowed</a> crypto <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">CPU</a> time <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">per</a> frame (0 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">no</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">limit</a>)&quot;}</td></tr>
<tr class="separator:a802583bf599735ca3f90741d55954864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90ed817e2c4e40c2d34af9d37e7edd64" id="r_a90ed817e2c4e40c2d34af9d37e7edd64"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcvar__t.html">cvar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a> = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_servercpudebug&quot;, &quot;0&quot;, &quot;print <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">statistics</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">about</a> time <a class="el" href="glquake_8h.html#a32b0a8e61cbee081afd64f670a39d7cb">usage</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">by</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">crypto&quot;</a>}</td></tr>
<tr class="separator:a90ed817e2c4e40c2d34af9d37e7edd64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1310a98c3e1b982d484654a27f259671" id="r_a1310a98c3e1b982d484654a27f259671"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> = 0</td></tr>
<tr class="separator:a1310a98c3e1b982d484654a27f259671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a481f329d6a8171607db23fb324302b70" id="r_a481f329d6a8171607db23fb324302b70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a> = 0</td></tr>
<tr class="separator:a481f329d6a8171607db23fb324302b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5918471d5570f5ecf0da17ecf0a253b" id="r_ae5918471d5570f5ecf0da17ecf0a253b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcvar__t.html">cvar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae5918471d5570f5ecf0da17ecf0a253b">net_sourceaddresscheck</a></td></tr>
<tr class="separator:ae5918471d5570f5ecf0da17ecf0a253b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28bce26dd18684379882653e173b0188" id="r_a28bce26dd18684379882653e173b0188"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a></td></tr>
<tr class="separator:a28bce26dd18684379882653e173b0188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e167138d96bd0023ba86e401f27253a" id="r_a9e167138d96bd0023ba86e401f27253a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a> = <a class="el" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td></tr>
<tr class="separator:a9e167138d96bd0023ba86e401f27253a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63426ba3da78d70b38153267dbe74ccc" id="r_a63426ba3da78d70b38153267dbe74ccc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a> [512]</td></tr>
<tr class="separator:a63426ba3da78d70b38153267dbe74ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386a69f0199d722b7886d32cafe9d7dc" id="r_a386a69f0199d722b7886d32cafe9d7dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a> )(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a386a69f0199d722b7886d32cafe9d7dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aa92bfaaf0609b72efa4ee010523361" id="r_a6aa92bfaaf0609b72efa4ee010523361"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="shader__glsl_8h.html#ada7daae51ef1e670767c18b83ea78044">a</a>)</td></tr>
<tr class="separator:a6aa92bfaaf0609b72efa4ee010523361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb17359f23753e70a2d100f311c83e9b" id="r_acb17359f23753e70a2d100f311c83e9b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *src)</td></tr>
<tr class="separator:acb17359f23753e70a2d100f311c83e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9d3969f89aaf222970ed72c2fd09ca" id="r_a0b9d3969f89aaf222970ed72c2fd09ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0b9d3969f89aaf222970ed72c2fd09ca">qd0_blind_id_read_public_key</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>)</td></tr>
<tr class="separator:a0b9d3969f89aaf222970ed72c2fd09ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f64f786d757a09a4e8c73edf953a466" id="r_a2f64f786d757a09a4e8c73edf953a466"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2f64f786d757a09a4e8c73edf953a466">qd0_blind_id_fingerprint64_public_key</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:a2f64f786d757a09a4e8c73edf953a466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad8d6f9972282ff99b7ed54db5380368" id="r_aad8d6f9972282ff99b7ed54db5380368"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aad8d6f9972282ff99b7ed54db5380368">qd0_blind_id_read_private_id_modulus</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>)</td></tr>
<tr class="separator:aad8d6f9972282ff99b7ed54db5380368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879fdc43d8e4a297a1556f17504bf6e8" id="r_a879fdc43d8e4a297a1556f17504bf6e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a879fdc43d8e4a297a1556f17504bf6e8">qd0_blind_id_generate_private_id_start</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>)</td></tr>
<tr class="separator:a879fdc43d8e4a297a1556f17504bf6e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1142ed9b4b3a54d428fd4b3a046fdccf" id="r_a1142ed9b4b3a54d428fd4b3a046fdccf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1142ed9b4b3a54d428fd4b3a046fdccf">qd0_blind_id_generate_private_id_request</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:a1142ed9b4b3a54d428fd4b3a046fdccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3685a8b8407588f11204fab35bef81e" id="r_ad3685a8b8407588f11204fab35bef81e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad3685a8b8407588f11204fab35bef81e">qd0_blind_id_finish_private_id_request</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>)</td></tr>
<tr class="separator:ad3685a8b8407588f11204fab35bef81e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282255c5456bd132c907e62ff5e26846" id="r_a282255c5456bd132c907e62ff5e26846"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a282255c5456bd132c907e62ff5e26846">qd0_blind_id_read_private_id</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>)</td></tr>
<tr class="separator:a282255c5456bd132c907e62ff5e26846"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2a076dba69c5847aab34bf0bf54b54" id="r_a3e2a076dba69c5847aab34bf0bf54b54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a3e2a076dba69c5847aab34bf0bf54b54">qd0_blind_id_write_private_id</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:a3e2a076dba69c5847aab34bf0bf54b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09cfb5d32dc22ee93c5f88bb883084e" id="r_aa09cfb5d32dc22ee93c5f88bb883084e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">is_first</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">send_modulus</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *message, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msglen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:aa09cfb5d32dc22ee93c5f88bb883084e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a238db7be954a2720b4646a56f416e7a5" id="r_a238db7be954a2720b4646a56f416e7a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a238db7be954a2720b4646a56f416e7a5">qd0_blind_id_authenticate_with_private_id_challenge</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">is_first</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">recv_modulus</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>)</td></tr>
<tr class="separator:a238db7be954a2720b4646a56f416e7a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf540674cda53b14bdd104f40759c386" id="r_aaf540674cda53b14bdd104f40759c386"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aaf540674cda53b14bdd104f40759c386">qd0_blind_id_authenticate_with_private_id_response</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:aaf540674cda53b14bdd104f40759c386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af57a05bc9b21589d745930acee39eb78" id="r_af57a05bc9b21589d745930acee39eb78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af57a05bc9b21589d745930acee39eb78">qd0_blind_id_authenticate_with_private_id_verify</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *msg, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msglen</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>)</td></tr>
<tr class="separator:af57a05bc9b21589d745930acee39eb78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cb23abf4b1a78be4ffa5d5f8842faa0" id="r_a9cb23abf4b1a78be4ffa5d5f8842faa0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:a9cb23abf4b1a78be4ffa5d5f8842faa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cbfb270eaaeb2f550ad978be861d129" id="r_a4cbfb270eaaeb2f550ad978be861d129"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:a4cbfb270eaaeb2f550ad978be861d129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a769580f1e63f2603aa90bb8986ac3ef3" id="r_a769580f1e63f2603aa90bb8986ac3ef3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a769580f1e63f2603aa90bb8986ac3ef3">qd0_blind_id_INITIALIZE</a> )(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a769580f1e63f2603aa90bb8986ac3ef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71fc08325ecf3532fc19e05a46b2d295" id="r_a71fc08325ecf3532fc19e05a46b2d295"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a71fc08325ecf3532fc19e05a46b2d295">qd0_blind_id_SHUTDOWN</a> )(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td></tr>
<tr class="separator:a71fc08325ecf3532fc19e05a46b2d295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b44899185366951da0286b16f86f43" id="r_a62b44899185366951da0286b16f86f43"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a62b44899185366951da0286b16f86f43">qd0_blind_id_util_sha256</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *in, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>)</td></tr>
<tr class="separator:a62b44899185366951da0286b16f86f43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a053fe3ee2c82148ddb847da9f7e20f71" id="r_a053fe3ee2c82148ddb847da9f7e20f71"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a053fe3ee2c82148ddb847da9f7e20f71">qd0_blind_id_sign_with_private_id_sign</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">is_first</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">send_modulus</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *message, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msglen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:a053fe3ee2c82148ddb847da9f7e20f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7ad86a0d8f95960c08726067fe9831e" id="r_aa7ad86a0d8f95960c08726067fe9831e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa7ad86a0d8f95960c08726067fe9831e">qd0_blind_id_sign_with_private_id_sign_detached</a> )(<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">is_first</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">send_modulus</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *message, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msglen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>)</td></tr>
<tr class="separator:aa7ad86a0d8f95960c08726067fe9831e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690b3fafb6357836766ea72705753a4f" id="r_a690b3fafb6357836766ea72705753a4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a690b3fafb6357836766ea72705753a4f">qd0_blind_id_setmallocfuncs</a> )(<a class="el" href="crypto_8c.html#abb3ae89a45f60de77f1dd02d6c2a5328">d0_malloc_t</a> *m, <a class="el" href="crypto_8c.html#a2efe40262b15742cbcd54501782639e5">d0_free_t</a> *<a class="el" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>)</td></tr>
<tr class="separator:a690b3fafb6357836766ea72705753a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed7aa781c8545c1333c525f437aa7fc" id="r_afed7aa781c8545c1333c525f437aa7fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#afed7aa781c8545c1333c525f437aa7fc">qd0_blind_id_setmutexfuncs</a> )(<a class="el" href="crypto_8c.html#a15bf368c6c65ee2efeb72b13e8390298">d0_createmutex_t</a> *c, <a class="el" href="crypto_8c.html#a17c84d33e1ae7fabefa009ded492313f">d0_destroymutex_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>, <a class="el" href="crypto_8c.html#a03c8d295a5d00c9b704eeaf9cdc2c554">d0_lockmutex_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>, <a class="el" href="crypto_8c.html#abd63a13cc35cc9a1f783b8d383342c00">d0_unlockmutex_t</a> *u)</td></tr>
<tr class="separator:afed7aa781c8545c1333c525f437aa7fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099d4d32154ed82ff5431ab675945965" id="r_a099d4d32154ed82ff5431ab675945965"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a099d4d32154ed82ff5431ab675945965">qd0_blind_id_verify_public_id</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>)</td></tr>
<tr class="separator:a099d4d32154ed82ff5431ab675945965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d43fdd72f73796e0dbd984eae9347f4" id="r_a5d43fdd72f73796e0dbd984eae9347f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5d43fdd72f73796e0dbd984eae9347f4">qd0_blind_id_verify_private_id</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>)</td></tr>
<tr class="separator:a5d43fdd72f73796e0dbd984eae9347f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a422626d9526190c4d1ab54321f94b463" id="r_a422626d9526190c4d1ab54321f94b463"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="structdllfunction__t.html">dllfunction_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a422626d9526190c4d1ab54321f94b463">d0_blind_id_funcs</a> []</td></tr>
<tr class="separator:a422626d9526190c4d1ab54321f94b463"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a630ddbca1d559d1a461a73a5cf7851e0" id="r_a630ddbca1d559d1a461a73a5cf7851e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="sys_8h.html#a6adb43a47c235f59ea1333f385eef73d">dllhandle_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a> = <a class="el" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td></tr>
<tr class="separator:a630ddbca1d559d1a461a73a5cf7851e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a2774cae8b42a7f02b79fe450bab4e" id="r_a43a2774cae8b42a7f02b79fe450bab4e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a43a2774cae8b42a7f02b79fe450bab4e">qd0_rijndael_setup_encrypt</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *key, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)</td></tr>
<tr class="separator:a43a2774cae8b42a7f02b79fe450bab4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a0fc4737467183933f83921685e1492" id="r_a5a0fc4737467183933f83921685e1492"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5a0fc4737467183933f83921685e1492">qd0_rijndael_setup_decrypt</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *key, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)</td></tr>
<tr class="separator:a5a0fc4737467183933f83921685e1492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa7c805b800d7f78c68a7b925b318bc" id="r_a8fa7c805b800d7f78c68a7b925b318bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a8fa7c805b800d7f78c68a7b925b318bc">qd0_rijndael_encrypt</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nrounds</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">plaintext</a>[16], <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ciphertext</a>[16])</td></tr>
<tr class="separator:a8fa7c805b800d7f78c68a7b925b318bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3c2380c084a6b13af5345dd3f3d1938" id="r_ac3c2380c084a6b13af5345dd3f3d1938"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac3c2380c084a6b13af5345dd3f3d1938">qd0_rijndael_decrypt</a> )(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nrounds</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ciphertext</a>[16], <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">plaintext</a>[16])</td></tr>
<tr class="separator:ac3c2380c084a6b13af5345dd3f3d1938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1189ee7ea90350778e8fdbe7ee9a9d2" id="r_aa1189ee7ea90350778e8fdbe7ee9a9d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="structdllfunction__t.html">dllfunction_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa1189ee7ea90350778e8fdbe7ee9a9d2">d0_rijndael_funcs</a> []</td></tr>
<tr class="separator:aa1189ee7ea90350778e8fdbe7ee9a9d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f343ad0620ecc82d3eb9a52c3ecfb6" id="r_ac8f343ad0620ecc82d3eb9a52c3ecfb6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="sys_8h.html#a6adb43a47c235f59ea1333f385eef73d">dllhandle_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> = <a class="el" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td></tr>
<tr class="separator:ac8f343ad0620ecc82d3eb9a52c3ecfb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad209fec4c56eb4b0966702b7452bd7db" id="r_ad209fec4c56eb4b0966702b7452bd7db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a> [<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>]</td></tr>
<tr class="separator:ad209fec4c56eb4b0966702b7452bd7db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa88008abe3af1f6fb6c5596928082e4e" id="r_aa88008abe3af1f6fb6c5596928082e4e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a> [<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>][<a class="el" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1]</td></tr>
<tr class="separator:aa88008abe3af1f6fb6c5596928082e4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97b4731bcda09762498f4c4ab8950eee" id="r_a97b4731bcda09762498f4c4ab8950eee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a> [<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>]</td></tr>
<tr class="separator:a97b4731bcda09762498f4c4ab8950eee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d40b2f3505629533c24fcfc912854c" id="r_a95d40b2f3505629533c24fcfc912854c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a> [<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>]</td></tr>
<tr class="separator:a95d40b2f3505629533c24fcfc912854c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48cd47ff384a225c07aae1505db8c269" id="r_a48cd47ff384a225c07aae1505db8c269"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a> [<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>][<a class="el" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1]</td></tr>
<tr class="separator:a48cd47ff384a225c07aae1505db8c269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a7166948fbca4aa370e98c8f64d139a" id="r_a0a7166948fbca4aa370e98c8f64d139a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0a7166948fbca4aa370e98c8f64d139a">challenge_append</a> [1400]</td></tr>
<tr class="separator:a0a7166948fbca4aa370e98c8f64d139a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d332095b22ac949589bca1293869cb2" id="r_a5d332095b22ac949589bca1293869cb2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a></td></tr>
<tr class="separator:a5d332095b22ac949589bca1293869cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae660e3db5e569c5c606531a62f889148" id="r_ae660e3db5e569c5c606531a62f889148"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1</td></tr>
<tr class="separator:ae660e3db5e569c5c606531a62f889148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acef24f9adaa96877f886d9e102044538" id="r_acef24f9adaa96877f886d9e102044538"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#acef24f9adaa96877f886d9e102044538">keygen_buf</a> [8192]</td></tr>
<tr class="separator:acef24f9adaa96877f886d9e102044538"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4630d2842fd947361b293e0102b7205" id="r_aa4630d2842fd947361b293e0102b7205"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="structserver__cryptoconnect__t.html">server_cryptoconnect_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a> [<a class="el" href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a>]</td></tr>
<tr class="separator:aa4630d2842fd947361b293e0102b7205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09ddfceaa9b1578f414a3e3408ce7ea1" id="r_a09ddfceaa9b1578f414a3e3408ce7ea1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a09ddfceaa9b1578f414a3e3408ce7ea1">cdata_id</a> = 0</td></tr>
<tr class="separator:a09ddfceaa9b1578f414a3e3408ce7ea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8a64f8aefe35f96d148557fb2e090db" id="r_ab8a64f8aefe35f96d148557fb2e090db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a> [<a class="el" href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a>]</td></tr>
<tr class="separator:ab8a64f8aefe35f96d148557fb2e090db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a473d64350b7902deaac13e21f96f11d8" id="r_a473d64350b7902deaac13e21f96f11d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="structmempool__t.html">mempool_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a473d64350b7902deaac13e21f96f11d8">cryptomempool</a></td></tr>
<tr class="separator:a473d64350b7902deaac13e21f96f11d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a72048b767e62a20b79bde41af5b4615c" name="a72048b767e62a20b79bde41af5b4615c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72048b767e62a20b79bde41af5b4615c">&#9670;&#160;</a></span>CDATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CDATA&#160;&#160;&#160;((<a class="el" href="structcrypto__data__t.html">crypto_data_t</a> *) crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00524">524</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ae0749fdaf63ce66fa265a6eb1d352a36" name="ae0749fdaf63ce66fa265a6eb1d352a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0749fdaf63ce66fa265a6eb1d352a36">&#9670;&#160;</a></span>CLEAR_CDATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CLEAR_CDATA&#160;&#160;&#160;<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">if</a>(crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>) { <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">if</a>(<a class="el" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;<a class="el" href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a>) <a class="el" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="el" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;<a class="el" href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a>); <a class="el" href="zone_8h.html#abbce8ea44a12486a6b59f31f02bab5ee">Z_Free</a>(crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>); } crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> = <a class="el" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00526">526</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ad9b21b9b224ac66403379dc81f79ee43" name="ad9b21b9b224ac66403379dc81f79ee43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9b21b9b224ac66403379dc81f79ee43">&#9670;&#160;</a></span>CRYPTOCONNECT_CONNECT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTOCONNECT_CONNECT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00496">496</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a9bb3dfd3d76e2f6853fa61f046122d6e" name="a9bb3dfd3d76e2f6853fa61f046122d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bb3dfd3d76e2f6853fa61f046122d6e">&#9670;&#160;</a></span>CRYPTOCONNECT_DUPLICATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTOCONNECT_DUPLICATE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00498">498</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a51e64ae560deec18fe339cf0c2192cc7" name="a51e64ae560deec18fe339cf0c2192cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51e64ae560deec18fe339cf0c2192cc7">&#9670;&#160;</a></span>CRYPTOCONNECT_NONE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTOCONNECT_NONE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00494">494</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a98c980015873bb7e757fd28d81fe5374" name="a98c980015873bb7e757fd28d81fe5374"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c980015873bb7e757fd28d81fe5374">&#9670;&#160;</a></span>CRYPTOCONNECT_PRECONNECT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTOCONNECT_PRECONNECT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00495">495</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a9f29bdb652dbc3cb7011a9b727ecddc9" name="a9f29bdb652dbc3cb7011a9b727ecddc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f29bdb652dbc3cb7011a9b727ecddc9">&#9670;&#160;</a></span>CRYPTOCONNECT_RECONNECT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> CRYPTOCONNECT_RECONNECT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00497">497</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a2cc28a754edbe5c9184d04bb4a6ad76a" name="a2cc28a754edbe5c9184d04bb4a6ad76a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cc28a754edbe5c9184d04bb4a6ad76a">&#9670;&#160;</a></span>D0_BOOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> D0_BOOL&#160;&#160;&#160;<a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00187">187</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a60d4582b2e05d234358e37f6357d26bd" name="a60d4582b2e05d234358e37f6357d26bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60d4582b2e05d234358e37f6357d26bd">&#9670;&#160;</a></span>D0_EXPORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> D0_EXPORT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00181">181</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ab0d5a8f17f24d42f5e9c58645ac3a178" name="ab0d5a8f17f24d42f5e9c58645ac3a178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0d5a8f17f24d42f5e9c58645ac3a178">&#9670;&#160;</a></span>D0_RIJNDAEL_KEYLENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> D0_RIJNDAEL_KEYLENGTH</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a></td><td>)</td>
          <td>&#160;&#160;&#160;((<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)/8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00338">338</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="aae3fa2cd7b52a90123438b9b4ea38efb" name="aae3fa2cd7b52a90123438b9b4ea38efb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae3fa2cd7b52a90123438b9b4ea38efb">&#9670;&#160;</a></span>D0_RIJNDAEL_NROUNDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> D0_RIJNDAEL_NROUNDS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a></td><td>)</td>
          <td>&#160;&#160;&#160;((<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)/32+6)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00340">340</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ae40679674b1d1578562cb4e1d13c48bb" name="ae40679674b1d1578562cb4e1d13c48bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae40679674b1d1578562cb4e1d13c48bb">&#9670;&#160;</a></span>D0_RIJNDAEL_RKLENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> D0_RIJNDAEL_RKLENGTH</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a></td><td>)</td>
          <td>&#160;&#160;&#160;((<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>)/8+28)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00339">339</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a0621e91f6f7f0e31c054018cffff852e" name="a0621e91f6f7f0e31c054018cffff852e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0621e91f6f7f0e31c054018cffff852e">&#9670;&#160;</a></span>D0_WARN_UNUSED_RESULT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> D0_WARN_UNUSED_RESULT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00185">185</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="abef3a6061b8a9869eeba8ac100f10d4d" name="abef3a6061b8a9869eeba8ac100f10d4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abef3a6061b8a9869eeba8ac100f10d4d">&#9670;&#160;</a></span>FOURCC_D0ER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FOURCC_D0ER&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">e</a>' &lt;&lt; 16) | ('<a class="el" href="shader__glsl_8h.html#a008e65201d4481545ed89903a22f667a">r</a>' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00056">56</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a130dc520e3510ecb53e73356184ee9dd" name="a130dc520e3510ecb53e73356184ee9dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a130dc520e3510ecb53e73356184ee9dd">&#9670;&#160;</a></span>FOURCC_D0IC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FOURCC_D0IC&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 16) | ('c' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00057">57</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="adfd3a4ea879edc599acb8ee0ff614d8e" name="adfd3a4ea879edc599acb8ee0ff614d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfd3a4ea879edc599acb8ee0ff614d8e">&#9670;&#160;</a></span>FOURCC_D0IQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FOURCC_D0IQ&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 16) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">q</a>' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00054">54</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a952ca24af982e8a9dde40f9bfd860882" name="a952ca24af982e8a9dde40f9bfd860882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a952ca24af982e8a9dde40f9bfd860882">&#9670;&#160;</a></span>FOURCC_D0IR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FOURCC_D0IR&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 16) | ('<a class="el" href="shader__glsl_8h.html#a008e65201d4481545ed89903a22f667a">r</a>' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00055">55</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a89c387d8ee20257119425b2b2137fdb2" name="a89c387d8ee20257119425b2b2137fdb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89c387d8ee20257119425b2b2137fdb2">&#9670;&#160;</a></span>FOURCC_D0PI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FOURCC_D0PI&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('p' &lt;&lt; 16) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00052">52</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a207294545e7e194a700239bd148de2ac" name="a207294545e7e194a700239bd148de2ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a207294545e7e194a700239bd148de2ac">&#9670;&#160;</a></span>FOURCC_D0PK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FOURCC_D0PK&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('p' &lt;&lt; 16) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00050">50</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a6cfb14fb175de61c8f50eaf4ae8be02a" name="a6cfb14fb175de61c8f50eaf4ae8be02a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfb14fb175de61c8f50eaf4ae8be02a">&#9670;&#160;</a></span>FOURCC_D0SI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FOURCC_D0SI&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('s' &lt;&lt; 16) | ('<a class="el" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00053">53</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a9408e24bf177d7c2602f1497b315f969" name="a9408e24bf177d7c2602f1497b315f969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9408e24bf177d7c2602f1497b315f969">&#9670;&#160;</a></span>FOURCC_D0SK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> FOURCC_D0SK&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>' &lt;&lt; 0) | ('0' &lt;&lt; 8) | ('s' &lt;&lt; 16) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00051">51</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a9e2d859ffde566232fcd3e099be1acc9" name="a9e2d859ffde566232fcd3e099be1acc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e2d859ffde566232fcd3e099be1acc9">&#9670;&#160;</a></span>MAKE_CDATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> MAKE_CDATA&#160;&#160;&#160;<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">if</a>(!crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>) crypto-&gt;<a class="el" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> = <a class="el" href="zone_8h.html#a35deb8ef816a08fb1bc8feac8db020c5">Z_Malloc</a>(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">sizeof</a>(<a class="el" href="structcrypto__data__t.html">crypto_data_t</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00525">525</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a0227d3cfd03cca7f1cb298e750152c61" name="a0227d3cfd03cca7f1cb298e750152c61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0227d3cfd03cca7f1cb298e750152c61">&#9670;&#160;</a></span>MAX_CRYPTOCONNECTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> MAX_CRYPTOCONNECTS&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00493">493</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a81517c37964da8773c8a85b39cbe62ef" name="a81517c37964da8773c8a85b39cbe62ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81517c37964da8773c8a85b39cbe62ef">&#9670;&#160;</a></span>MAX_PUBKEYS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> MAX_PUBKEYS&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00481">481</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a415708eb37a2ec762abe53d4dac87ac0" name="a415708eb37a2ec762abe53d4dac87ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a415708eb37a2ec762abe53d4dac87ac0">&#9670;&#160;</a></span>PROTOCOL_D0_BLIND_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> PROTOCOL_D0_BLIND_ID&#160;&#160;&#160;<a class="el" href="crypto-keygen-standalone_8c.html#a207294545e7e194a700239bd148de2ac">FOURCC_D0PK</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00046">46</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a2ba1c091c9f8d31b8761c8c6c8e12a74" name="a2ba1c091c9f8d31b8761c8c6c8e12a74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ba1c091c9f8d31b8761c8c6c8e12a74">&#9670;&#160;</a></span>PROTOCOL_VLEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> PROTOCOL_VLEN&#160;&#160;&#160;(('<a class="el" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>' &lt;&lt; 0) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>' &lt;&lt; 8) | ('<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">e</a>' &lt;&lt; 16) | ('<a class="el" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>' &lt;&lt; 24))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00047">47</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="af0764ae836719cd84a09939276875cee" name="af0764ae836719cd84a09939276875cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0764ae836719cd84a09939276875cee">&#9670;&#160;</a></span>USE_AES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">define</a> USE_AES</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00128">128</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ab4e48fcb3e2bb84bb6d537bcdf564935" name="ab4e48fcb3e2bb84bb6d537bcdf564935"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4e48fcb3e2bb84bb6d537bcdf564935">&#9670;&#160;</a></span>d0_blind_id_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">struct</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d0_blind_id_s</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00196">196</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a15bf368c6c65ee2efeb72b13e8390298" name="a15bf368c6c65ee2efeb72b13e8390298"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15bf368c6c65ee2efeb72b13e8390298">&#9670;&#160;</a></span>d0_createmutex_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *() d0_createmutex_t(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00191">191</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a17c84d33e1ae7fabefa009ded492313f" name="a17c84d33e1ae7fabefa009ded492313f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17c84d33e1ae7fabefa009ded492313f">&#9670;&#160;</a></span>d0_destroymutex_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>() d0_destroymutex_t(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00192">192</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="acd9d5b16f62f27456634480bcde1bc99" name="acd9d5b16f62f27456634480bcde1bc99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd9d5b16f62f27456634480bcde1bc99">&#9670;&#160;</a></span>d0_fastreject_function</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* d0_fastreject_function) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pass</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00197">197</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a2efe40262b15742cbcd54501782639e5" name="a2efe40262b15742cbcd54501782639e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2efe40262b15742cbcd54501782639e5">&#9670;&#160;</a></span>d0_free_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>() d0_free_t(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *p)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00190">190</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a03c8d295a5d00c9b704eeaf9cdc2c554" name="a03c8d295a5d00c9b704eeaf9cdc2c554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03c8d295a5d00c9b704eeaf9cdc2c554">&#9670;&#160;</a></span>d0_lockmutex_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>() d0_lockmutex_t(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00193">193</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="abb3ae89a45f60de77f1dd02d6c2a5328" name="abb3ae89a45f60de77f1dd02d6c2a5328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb3ae89a45f60de77f1dd02d6c2a5328">&#9670;&#160;</a></span>d0_malloc_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *() d0_malloc_t(<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> len)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00189">189</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="abd63a13cc35cc9a1f783b8d383342c00" name="abd63a13cc35cc9a1f783b8d383342c00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd63a13cc35cc9a1f783b8d383342c00">&#9670;&#160;</a></span>d0_unlockmutex_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">typedef</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>() d0_unlockmutex_t(<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00194">194</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="add3d6a3c0d2952e5dfdd43ad262d46dc" name="add3d6a3c0d2952e5dfdd43ad262d46dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add3d6a3c0d2952e5dfdd43ad262d46dc">&#9670;&#160;</a></span>aescpy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> aescpy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01472">1472</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1473</span>{</div>
<div class="line"><span class="lineno"> 1474</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">iv</a>;</div>
<div class="line"><span class="lineno"> 1475</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>[16];</div>
<div class="line"><span class="lineno"> 1476</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>[<a class="code hl_define" href="crypto_8c.html#ae40679674b1d1578562cb4e1d13c48bb">D0_RIJNDAEL_RKLENGTH</a>(<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a> * 8)];</div>
<div class="line"><span class="lineno"> 1477</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1478</span>    <a class="code hl_variable" href="crypto_8c.html#a43a2774cae8b42a7f02b79fe450bab4e">qd0_rijndael_setup_encrypt</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, key, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a> * 8);</div>
<div class="line"><span class="lineno"> 1479</span>    <span class="keywordflow">while</span>(len &gt; 16)</div>
<div class="line"><span class="lineno"> 1480</span>    {</div>
<div class="line"><span class="lineno"> 1481</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 16; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1482</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = src[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^ <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno"> 1483</span>        <a class="code hl_variable" href="crypto_8c.html#a8fa7c805b800d7f78c68a7b925b318bc">qd0_rijndael_encrypt</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="code hl_define" href="crypto_8c.html#aae3fa2cd7b52a90123438b9b4ea38efb">D0_RIJNDAEL_NROUNDS</a>(<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a> * 8), <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a>);</div>
<div class="line"><span class="lineno"> 1484</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a>;</div>
<div class="line"><span class="lineno"> 1485</span>        len -= 16;</div>
<div class="line"><span class="lineno"> 1486</span>        src += 16;</div>
<div class="line"><span class="lineno"> 1487</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a> += 16;</div>
<div class="line"><span class="lineno"> 1488</span>    }</div>
<div class="line"><span class="lineno"> 1489</span>    <span class="keywordflow">if</span>(len &gt; 0)</div>
<div class="line"><span class="lineno"> 1490</span>    {</div>
<div class="line"><span class="lineno"> 1491</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; len; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1492</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = src[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^ <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno"> 1493</span>        <span class="keywordflow">for</span>(; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 16; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1494</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno"> 1495</span>        <a class="code hl_variable" href="crypto_8c.html#a8fa7c805b800d7f78c68a7b925b318bc">qd0_rijndael_encrypt</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="code hl_define" href="crypto_8c.html#aae3fa2cd7b52a90123438b9b4ea38efb">D0_RIJNDAEL_NROUNDS</a>(<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a> * 8), <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a>);</div>
<div class="line"><span class="lineno"> 1496</span>    }</div>
<div class="line"><span class="lineno"> 1497</span>}</div>
<div class="ttc" id="acrypto_8c_html_a43a2774cae8b42a7f02b79fe450bab4e"><div class="ttname"><a href="crypto_8c.html#a43a2774cae8b42a7f02b79fe450bab4e">qd0_rijndael_setup_encrypt</a></div><div class="ttdeci">D0_EXPORT int(* qd0_rijndael_setup_encrypt)(unsigned long *rk, const unsigned char *key, int keybits)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00330">crypto.c:330</a></div></div>
<div class="ttc" id="acrypto_8c_html_a8fa7c805b800d7f78c68a7b925b318bc"><div class="ttname"><a href="crypto_8c.html#a8fa7c805b800d7f78c68a7b925b318bc">qd0_rijndael_encrypt</a></div><div class="ttdeci">D0_EXPORT void(* qd0_rijndael_encrypt)(const unsigned long *rk, int nrounds, const unsigned char plaintext[16], unsigned char ciphertext[16])</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00334">crypto.c:334</a></div></div>
<div class="ttc" id="acrypto_8c_html_aae3fa2cd7b52a90123438b9b4ea38efb"><div class="ttname"><a href="crypto_8c.html#aae3fa2cd7b52a90123438b9b4ea38efb">D0_RIJNDAEL_NROUNDS</a></div><div class="ttdeci">#define D0_RIJNDAEL_NROUNDS(keybits)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00340">crypto.c:340</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae40679674b1d1578562cb4e1d13c48bb"><div class="ttname"><a href="crypto_8c.html#ae40679674b1d1578562cb4e1d13c48bb">D0_RIJNDAEL_RKLENGTH</a></div><div class="ttdeci">#define D0_RIJNDAEL_RKLENGTH(keybits)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00339">crypto.c:339</a></div></div>
<div class="ttc" id="acrypto_8h_html_ad9de82069262439e7e921069abb457c1"><div class="ttname"><a href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a></div><div class="ttdeci">#define DHKEY_SIZE</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00039">crypto.h:39</a></div></div>
<div class="ttc" id="aglquake_8h_html_af7ca775b6d9354291c4d7d01b8b2a8bc"><div class="ttname"><a href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">index</a></div><div class="ttdeci">GLuint index</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00628">glquake.h:628</a></div></div>
<div class="ttc" id="aprvm__execprogram_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition</b> <a href="prvm__execprogram_8h_source.html#l00002">prvm_execprogram.h:2</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01527">Crypto_EncryptPacket()</a>.</p>

</div>
</div>
<a id="ae509f43bdccf26baf95b3ed68b24d750" name="ae509f43bdccf26baf95b3ed68b24d750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae509f43bdccf26baf95b3ed68b24d750">&#9670;&#160;</a></span>Crypto_AddPrivateKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_AddPrivateKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00469">469</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  470</span>{</div>
<div class="line"><span class="lineno">  471</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *p[1];</div>
<div class="line"><span class="lineno">  472</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[1];</div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="crypto_8c.html#aad099246d8ff3e9be8f5f4c35bf14d5d">Crypto_ParsePack</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, len, <a class="code hl_define" href="crypto_8c.html#a6cfb14fb175de61c8f50eaf4ae8be02a">FOURCC_D0SI</a>, p, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>, 1))</div>
<div class="line"><span class="lineno">  474</span>    {</div>
<div class="line"><span class="lineno">  475</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a282255c5456bd132c907e62ff5e26846">qd0_blind_id_read_private_id</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a>, p[0], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0]))</div>
<div class="line"><span class="lineno">  476</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  477</span>    }</div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  479</span>}</div>
<div class="ttc" id="acrypto_8c_html_a282255c5456bd132c907e62ff5e26846"><div class="ttname"><a href="crypto_8c.html#a282255c5456bd132c907e62ff5e26846">qd0_blind_id_read_private_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_read_private_id)(d0_blind_id_t *ctx, const char *inbuf, size_t inbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00218">crypto.c:218</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6cfb14fb175de61c8f50eaf4ae8be02a"><div class="ttname"><a href="crypto_8c.html#a6cfb14fb175de61c8f50eaf4ae8be02a">FOURCC_D0SI</a></div><div class="ttdeci">#define FOURCC_D0SI</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00053">crypto.c:53</a></div></div>
<div class="ttc" id="acrypto_8c_html_aad099246d8ff3e9be8f5f4c35bf14d5d"><div class="ttname"><a href="crypto_8c.html#aad099246d8ff3e9be8f5f4c35bf14d5d">Crypto_ParsePack</a></div><div class="ttdeci">static size_t Crypto_ParsePack(const char *buf, size_t len, unsigned long header, const char **lumps, size_t *lumpsize, size_t nlumps)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00076">crypto.c:76</a></div></div>
<div class="ttc" id="aglquake_8h_html_ac0759919bfcf4c7222738ba583673a9e"><div class="ttname"><a href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a></div><div class="ttdeci">GLenum GLuint GLenum GLsizei const GLchar * buf</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00656">glquake.h:656</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="af1846f2fe5c20c0a720498ab004a620b" name="af1846f2fe5c20c0a720498ab004a620b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1846f2fe5c20c0a720498ab004a620b">&#9670;&#160;</a></span>Crypto_Available()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_Available </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01097">1097</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1098</span>{</div>
<div class="line"><span class="lineno"> 1099</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1100</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1101</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1102</span>}</div>
<div class="ttc" id="acrypto_8c_html_a630ddbca1d559d1a461a73a5cf7851e0"><div class="ttname"><a href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a></div><div class="ttdeci">static dllhandle_t d0_blind_id_dll</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00282">crypto.c:282</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="prvm__cmds_8c_source.html#l00323">checkextension()</a>, and <a class="el" href="prvm__cmds_8c_source.html#l05175">VM_digest_hex()</a>.</p>

</div>
</div>
<a id="af4ea4fbb85d42f0fe445c6853deb27e3" name="af4ea4fbb85d42f0fe445c6853deb27e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4ea4fbb85d42f0fe445c6853deb27e3">&#9670;&#160;</a></span>Crypto_BuildChallengeAppend()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_BuildChallengeAppend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00785">785</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  786</span>{</div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordtype">char</span> *p, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lengthptr</a>, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">startptr</a>;</div>
<div class="line"><span class="lineno">  788</span>    <span class="keywordtype">size_t</span> <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>;</div>
<div class="line"><span class="lineno">  789</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  790</span>    p = <a class="code hl_variable" href="crypto_8c.html#a0a7166948fbca4aa370e98c8f64d139a">challenge_append</a>;</div>
<div class="line"><span class="lineno">  791</span>    <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#a0a7166948fbca4aa370e98c8f64d139a">challenge_append</a>);</div>
<div class="line"><span class="lineno">  792</span>    <a class="code hl_function" href="crypto_8c.html#ae7aaba47178e17c579b18b5d27b4bb83">Crypto_UnLittleLong</a>(p, <a class="code hl_define" href="crypto_8c.html#a2ba1c091c9f8d31b8761c8c6c8e12a74">PROTOCOL_VLEN</a>);</div>
<div class="line"><span class="lineno">  793</span>    p += 4;</div>
<div class="line"><span class="lineno">  794</span>    <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a> -= 4;</div>
<div class="line"><span class="lineno">  795</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lengthptr</a> = p;</div>
<div class="line"><span class="lineno">  796</span>    <a class="code hl_function" href="crypto_8c.html#ae7aaba47178e17c579b18b5d27b4bb83">Crypto_UnLittleLong</a>(p, 0);</div>
<div class="line"><span class="lineno">  797</span>    p += 4;</div>
<div class="line"><span class="lineno">  798</span>    <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a> -= 4;</div>
<div class="line"><span class="lineno">  799</span>    <a class="code hl_function" href="crypto_8c.html#ae7aaba47178e17c579b18b5d27b4bb83">Crypto_UnLittleLong</a>(p, <a class="code hl_define" href="crypto_8c.html#a415708eb37a2ec762abe53d4dac87ac0">PROTOCOL_D0_BLIND_ID</a>);</div>
<div class="line"><span class="lineno">  800</span>    p += 4;</div>
<div class="line"><span class="lineno">  801</span>    <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a> -= 4;</div>
<div class="line"><span class="lineno">  802</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">startptr</a> = p;</div>
<div class="line"><span class="lineno">  803</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  804</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  805</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;p, &amp;<a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  806</span>    <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;p, &amp;<a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  808</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  809</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;p, &amp;<a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  810</span>    <a class="code hl_function" href="crypto_8c.html#ae7aaba47178e17c579b18b5d27b4bb83">Crypto_UnLittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lengthptr</a>, p - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">startptr</a>);</div>
<div class="line"><span class="lineno">  811</span>    <a class="code hl_variable" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a> = p - <a class="code hl_variable" href="crypto_8c.html#a0a7166948fbca4aa370e98c8f64d139a">challenge_append</a>;</div>
<div class="line"><span class="lineno">  812</span>}</div>
<div class="ttc" id="acrypto_8c_html_a0a7166948fbca4aa370e98c8f64d139a"><div class="ttname"><a href="crypto_8c.html#a0a7166948fbca4aa370e98c8f64d139a">challenge_append</a></div><div class="ttdeci">static char challenge_append[1400]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00487">crypto.c:487</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2ba1c091c9f8d31b8761c8c6c8e12a74"><div class="ttname"><a href="crypto_8c.html#a2ba1c091c9f8d31b8761c8c6c8e12a74">PROTOCOL_VLEN</a></div><div class="ttdeci">#define PROTOCOL_VLEN</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00047">crypto.c:47</a></div></div>
<div class="ttc" id="acrypto_8c_html_a415708eb37a2ec762abe53d4dac87ac0"><div class="ttname"><a href="crypto_8c.html#a415708eb37a2ec762abe53d4dac87ac0">PROTOCOL_D0_BLIND_ID</a></div><div class="ttdeci">#define PROTOCOL_D0_BLIND_ID</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00046">crypto.c:46</a></div></div>
<div class="ttc" id="acrypto_8c_html_a57d3d64d18e1c220988f7cff0053d630"><div class="ttname"><a href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a></div><div class="ttdeci">static qbool PutWithNul(char **data, size_t *len, const char *str)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00406">crypto.c:406</a></div></div>
<div class="ttc" id="acrypto_8c_html_a5d332095b22ac949589bca1293869cb2"><div class="ttname"><a href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a></div><div class="ttdeci">static size_t challenge_append_length</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00488">crypto.c:488</a></div></div>
<div class="ttc" id="acrypto_8c_html_a81517c37964da8773c8a85b39cbe62ef"><div class="ttname"><a href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a></div><div class="ttdeci">#define MAX_PUBKEYS</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00481">crypto.c:481</a></div></div>
<div class="ttc" id="acrypto_8c_html_a97b4731bcda09762498f4c4ab8950eee"><div class="ttname"><a href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a></div><div class="ttdeci">static qbool pubkeys_havepriv[MAX_PUBKEYS]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00484">crypto.c:484</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa88008abe3af1f6fb6c5596928082e4e"><div class="ttname"><a href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a></div><div class="ttdeci">static char pubkeys_fp64[MAX_PUBKEYS][FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00483">crypto.c:483</a></div></div>
<div class="ttc" id="acrypto_8c_html_ad209fec4c56eb4b0966702b7452bd7db"><div class="ttname"><a href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a></div><div class="ttdeci">static d0_blind_id_t * pubkeys[MAX_PUBKEYS]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00482">crypto.c:482</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae7aaba47178e17c579b18b5d27b4bb83"><div class="ttname"><a href="crypto_8c.html#ae7aaba47178e17c579b18b5d27b4bb83">Crypto_UnLittleLong</a></div><div class="ttdeci">static void Crypto_UnLittleLong(char *data, unsigned long l)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00068">crypto.c:68</a></div></div>
<div class="ttc" id="afractalnoise_8c_html_a86fdeed0593c5e3b95d1f2447350ca96"><div class="ttname"><a href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a></div><div class="ttdeci">#define n(x, y)</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, and <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="a7b037eca70363845b5621daa59b81f93" name="a7b037eca70363845b5621daa59b81f93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b037eca70363845b5621daa59b81f93">&#9670;&#160;</a></span>Crypto_BuildIdString()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_BuildIdString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00842">842</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  843</span>{</div>
<div class="line"><span class="lineno">  844</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  845</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>    <a class="code hl_variable" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  848</span>    <a class="code hl_function" href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a>(<a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>), <span class="stringliteral">&quot;%d&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> ? <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> : 0);</div>
<div class="line"><span class="lineno">  849</span>    <span class="keywordflow">for</span> (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  850</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  851</span>            <a class="code hl_define" href="common_8h.html#a48b55a981b8eb9cbcf455b613f62e6b3">dp_strlcat</a>(<a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot; %s@%s%s&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;~&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]), <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">sizeof</a>(<a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>));</div>
<div class="line"><span class="lineno">  852</span>    <a class="code hl_variable" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a> = <a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>;</div>
<div class="line"><span class="lineno">  853</span>}</div>
<div class="ttc" id="acommon_8c_html_a4a8220fa88226bf9cf39b12a051a20d7"><div class="ttname"><a href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a></div><div class="ttdeci">char * va(char *buf, size_t buflen, const char *format,...)</div><div class="ttdef"><b>Definition</b> <a href="common_8c_source.html#l00972">common.c:972</a></div></div>
<div class="ttc" id="acommon_8c_html_ae36050083f45e395189fee6aa45fbb0c"><div class="ttname"><a href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a></div><div class="ttdeci">int dpsnprintf(char *buffer, size_t buffersize, const char *format,...)</div><div class="ttdoc">Returns the number of printed characters, excluding the final '\0' or returns -1 if the buffer isn't ...</div><div class="ttdef"><b>Definition</b> <a href="common_8c_source.html#l00997">common.c:997</a></div></div>
<div class="ttc" id="acommon_8h_html_a48b55a981b8eb9cbcf455b613f62e6b3"><div class="ttname"><a href="common_8h.html#a48b55a981b8eb9cbcf455b613f62e6b3">dp_strlcat</a></div><div class="ttdeci">#define dp_strlcat(dst, src, dsize)</div><div class="ttdef"><b>Definition</b> <a href="common_8h_source.html#l00304">common.h:304</a></div></div>
<div class="ttc" id="acrypto_8c_html_a48cd47ff384a225c07aae1505db8c269"><div class="ttname"><a href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a></div><div class="ttdeci">static char pubkeys_priv_fp64[MAX_PUBKEYS][FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00486">crypto.c:486</a></div></div>
<div class="ttc" id="acrypto_8c_html_a63426ba3da78d70b38153267dbe74ccc"><div class="ttname"><a href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a></div><div class="ttdeci">static char crypto_idstring_buf[512]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00043">crypto.c:43</a></div></div>
<div class="ttc" id="acrypto_8c_html_a95d40b2f3505629533c24fcfc912854c"><div class="ttname"><a href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a></div><div class="ttdeci">static qbool pubkeys_havesig[MAX_PUBKEYS]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00485">crypto.c:485</a></div></div>
<div class="ttc" id="acrypto_8c_html_a9e167138d96bd0023ba86e401f27253a"><div class="ttname"><a href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a></div><div class="ttdeci">static const char * crypto_idstring</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00042">crypto.c:42</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa6a8e5916e25ff44b9ed67996dba0068"><div class="ttname"><a href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a></div><div class="ttdeci">cvar_t crypto_aeslevel</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00031">crypto.c:31</a></div></div>
<div class="ttc" id="acrypto_8c_html_ac8f343ad0620ecc82d3eb9a52c3ecfb6"><div class="ttname"><a href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a></div><div class="ttdeci">static dllhandle_t d0_rijndael_dll</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00351">crypto.c:351</a></div></div>
<div class="ttc" id="aqtypes_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition</b> <a href="qtypes_8h_source.html#l00012">qtypes.h:12</a></div></div>
<div class="ttc" id="astructcvar__t_html_a376ca13f147f306d71edbe7670e138b0"><div class="ttname"><a href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">cvar_t::integer</a></div><div class="ttdeci">int integer</div><div class="ttdef"><b>Definition</b> <a href="cvar_8h_source.html#l00073">cvar.h:73</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, and <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="aba58302060be72fb4652709fe63dcabf" name="aba58302060be72fb4652709fe63dcabf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba58302060be72fb4652709fe63dcabf">&#9670;&#160;</a></span>Crypto_ClearHostKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_ClearHostKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00613">613</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  614</span>{</div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[128];</div>
<div class="line"><span class="lineno">  616</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a>;</div>
<div class="line"><span class="lineno">  617</span>    <a class="code hl_struct" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a> **<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkp</a>;</div>
<div class="line"><span class="lineno">  618</span>    <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">found</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>    <a class="code hl_function" href="lhnet_8c.html#a191c91d25271eed39a5eb76e2d8e5dde">LHNETADDRESS_ToString</a>(peeraddress, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), 1);</div>
<div class="line"><span class="lineno">  621</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a> = <a class="code hl_function" href="com__crc16_8c.html#aa9ba811c20537ebd01898928be2de439">CRC_Block</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strlen</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>)) % <a class="code hl_define" href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a>;</div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkp</a> = &amp;<a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a>]; *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkp</a> &amp;&amp; <a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(&amp;((*hkp)-&gt;addr), peeraddress); <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkp</a> = &amp;((*hkp)-&gt;next));</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">if</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkp</a>)</div>
<div class="line"><span class="lineno">  625</span>    {</div>
<div class="line"><span class="lineno">  626</span>        <a class="code hl_struct" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkp</a>;</div>
<div class="line"><span class="lineno">  627</span>        *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkp</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;<a class="code hl_variable" href="structcrypto__storedhostkey__t.html#af62d58040b87c90c543af4dd18900036">next</a>;</div>
<div class="line"><span class="lineno">  628</span>        <a class="code hl_define" href="zone_8h.html#abbce8ea44a12486a6b59f31f02bab5ee">Z_Free</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>);</div>
<div class="line"><span class="lineno">  629</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">found</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  630</span>    }</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">found</a>;</div>
<div class="line"><span class="lineno">  633</span>}</div>
<div class="ttc" id="acom__crc16_8c_html_aa9ba811c20537ebd01898928be2de439"><div class="ttname"><a href="com__crc16_8c.html#aa9ba811c20537ebd01898928be2de439">CRC_Block</a></div><div class="ttdeci">unsigned short CRC_Block(const unsigned char *data, size_t size)</div><div class="ttdef"><b>Definition</b> <a href="com__crc16_8c_source.html#l00075">com_crc16.c:75</a></div></div>
<div class="ttc" id="acrypto_8c_html_ab8a64f8aefe35f96d148557fb2e090db"><div class="ttname"><a href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a></div><div class="ttdeci">static crypto_storedhostkey_t * crypto_storedhostkey_hashtable[CRYPTO_HOSTKEY_HASHSIZE]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00589">crypto.c:589</a></div></div>
<div class="ttc" id="alhnet_8c_html_a191c91d25271eed39a5eb76e2d8e5dde"><div class="ttname"><a href="lhnet_8c.html#a191c91d25271eed39a5eb76e2d8e5dde">LHNETADDRESS_ToString</a></div><div class="ttdeci">int LHNETADDRESS_ToString(const lhnetaddress_t *vaddress, char *string, int stringbuffersize, int includeport)</div><div class="ttdoc">Returns the number of bytes written to *string excluding the \0 terminator.</div><div class="ttdef"><b>Definition</b> <a href="lhnet_8c_source.html#l00540">lhnet.c:540</a></div></div>
<div class="ttc" id="alhnet_8c_html_afcb50bceea3f2dc4d4c1663bb6d35e9e"><div class="ttname"><a href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a></div><div class="ttdeci">int LHNETADDRESS_Compare(const lhnetaddress_t *vaddress1, const lhnetaddress_t *vaddress2)</div><div class="ttdef"><b>Definition</b> <a href="lhnet_8c_source.html#l00665">lhnet.c:665</a></div></div>
<div class="ttc" id="aqdefs_8h_html_a48e850626a1e9dd288fe4090c8619663"><div class="ttname"><a href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a></div><div class="ttdeci">#define CRYPTO_HOSTKEY_HASHSIZE</div><div class="ttdoc">number of hash buckets for accelerating host key lookups</div><div class="ttdef"><b>Definition</b> <a href="qdefs_8h_source.html#l00126">qdefs.h:126</a></div></div>
<div class="ttc" id="aqtypes_8h_html_aa250998bce2dc350e4f644297bb579c3"><div class="ttname"><a href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a></div><div class="ttdeci">bool qbool</div><div class="ttdef"><b>Definition</b> <a href="qtypes_8h_source.html#l00009">qtypes.h:9</a></div></div>
<div class="ttc" id="astructcrypto__storedhostkey__t_html"><div class="ttname"><a href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a></div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00579">crypto.c:580</a></div></div>
<div class="ttc" id="astructcrypto__storedhostkey__t_html_af62d58040b87c90c543af4dd18900036"><div class="ttname"><a href="structcrypto__storedhostkey__t.html#af62d58040b87c90c543af4dd18900036">crypto_storedhostkey_t::next</a></div><div class="ttdeci">struct crypto_storedhostkey_s * next</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00581">crypto.c:581</a></div></div>
<div class="ttc" id="azone_8h_html_abbce8ea44a12486a6b59f31f02bab5ee"><div class="ttname"><a href="zone_8h.html#abbce8ea44a12486a6b59f31f02bab5ee">Z_Free</a></div><div class="ttdeci">#define Z_Free(data)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00164">zone.h:164</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01428">Crypto_HostKey_Clear_f()</a>.</p>

</div>
</div>
<a id="a2531ce5eea2370af4ade686477c9e9f2" name="a2531ce5eea2370af4ade686477c9e9f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2531ce5eea2370af4ade686477c9e9f2">&#9670;&#160;</a></span>Crypto_ClearHostKeys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_ClearHostKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00598">598</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  599</span>{</div>
<div class="line"><span class="lineno">  600</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  601</span>    <a class="code hl_struct" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkn</a>;</div>
<div class="line"><span class="lineno">  602</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  603</span>    {</div>
<div class="line"><span class="lineno">  604</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = <a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkn</a>)</div>
<div class="line"><span class="lineno">  605</span>        {</div>
<div class="line"><span class="lineno">  606</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hkn</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;<a class="code hl_variable" href="structcrypto__storedhostkey__t.html#af62d58040b87c90c543af4dd18900036">next</a>;</div>
<div class="line"><span class="lineno">  607</span>            <a class="code hl_define" href="zone_8h.html#abbce8ea44a12486a6b59f31f02bab5ee">Z_Free</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>);</div>
<div class="line"><span class="lineno">  608</span>        }</div>
<div class="line"><span class="lineno">  609</span>        <a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  610</span>    }</div>
<div class="line"><span class="lineno">  611</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01373">Crypto_Reload_f()</a>.</p>

</div>
</div>
<a id="a85cf03eabae9c5ffb347409d468d6f9c" name="a85cf03eabae9c5ffb347409d468d6f9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85cf03eabae9c5ffb347409d468d6f9c">&#9670;&#160;</a></span>Crypto_ClientError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_ClientError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02093">2093</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2094</span>{</div>
<div class="line"><span class="lineno"> 2095</span>    <a class="code hl_function" href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;reject %s&quot;</span>, msg);</div>
<div class="line"><span class="lineno"> 2096</span>    *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strlen</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>);</div>
<div class="line"><span class="lineno"> 2097</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a6d9f8e2afed02501c245a07309bd656c">CRYPTO_REPLACE</a>;</div>
<div class="line"><span class="lineno"> 2098</span>}</div>
<div class="ttc" id="acrypto_8h_html_a6d9f8e2afed02501c245a07309bd656c"><div class="ttname"><a href="crypto_8h.html#a6d9f8e2afed02501c245a07309bd656c">CRYPTO_REPLACE</a></div><div class="ttdeci">#define CRYPTO_REPLACE</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00067">crypto.h:67</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>.</p>

</div>
</div>
<a id="a29b4969371415991b42f94cc5c82838a" name="a29b4969371415991b42f94cc5c82838a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29b4969371415991b42f94cc5c82838a">&#9670;&#160;</a></span>Crypto_ClientParsePacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_ClientParsePacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>peeraddressstring</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02107">2107</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2108</span>{</div>
<div class="line"><span class="lineno"> 2109</span>    <a class="code hl_struct" href="structcrypto__t.html">crypto_t</a> *crypto = &amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a6b1b21c226c99c9d1e972dc080ee1855">crypto</a>;</div>
<div class="line"><span class="lineno"> 2110</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>;</div>
<div class="line"><span class="lineno"> 2111</span>    <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a>;</div>
<div class="line"><span class="lineno"> 2112</span>    <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2113</span>    <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno"> 2114</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>[<a class="code hl_define" href="qdefs_8h.html#a119f8457078d7390fb45ea0838adb806">MAX_INPUTLINE</a>];</div>
<div class="line"><span class="lineno"> 2115</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno"> 2116</span> </div>
<div class="line"><span class="lineno"> 2117</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 2118</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>; <span class="comment">// no support</span></div>
<div class="line"><span class="lineno"> 2119</span> </div>
<div class="line"><span class="lineno"> 2120</span>    <span class="comment">// if &quot;challenge&quot;: verify challenge, and discard message, send next crypto protocol message instead</span></div>
<div class="line"><span class="lineno"> 2121</span>    <span class="comment">// otherwise, just handle actual protocol messages</span></div>
<div class="line"><span class="lineno"> 2122</span> </div>
<div class="line"><span class="lineno"> 2123</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> == 6 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;accept&quot;</span>, 6) &amp;&amp; <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">connect_trying</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>)</div>
<div class="line"><span class="lineno"> 2124</span>    {</div>
<div class="line"><span class="lineno"> 2125</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> = -1;</div>
<div class="line"><span class="lineno"> 2126</span>        <a class="code hl_function" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2127</span>        <span class="keywordflow">if</span>(!crypto || !crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a>) <span class="comment">// we ALSO get here if we are using an encrypted connection, so let&#39;s rule this out</span></div>
<div class="line"><span class="lineno"> 2128</span>        {</div>
<div class="line"><span class="lineno"> 2129</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2130</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though a host key is present&quot;</span>);</div>
<div class="line"><span class="lineno"> 2131</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2132</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2133</span>        }</div>
<div class="line"><span class="lineno"> 2134</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2135</span>    }</div>
<div class="line"><span class="lineno"> 2136</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 1 &amp;&amp; <span class="keywordtype">string</span>[0] == <span class="charliteral">&#39;j&#39;</span> &amp;&amp; <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">connect_trying</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>)</div>
<div class="line"><span class="lineno"> 2137</span>    {</div>
<div class="line"><span class="lineno"> 2138</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> = -1;</div>
<div class="line"><span class="lineno"> 2139</span>        <a class="code hl_function" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2140</span>        <span class="comment">//if(!crypto || !crypto-&gt;authenticated)</span></div>
<div class="line"><span class="lineno"> 2141</span>        {</div>
<div class="line"><span class="lineno"> 2142</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2143</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though a host key is present&quot;</span>);</div>
<div class="line"><span class="lineno"> 2144</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2145</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2146</span>        }</div>
<div class="line"><span class="lineno"> 2147</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2148</span>    }</div>
<div class="line"><span class="lineno"> 2149</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 5 &amp;&amp; <a class="code hl_function" href="com__msg_8c.html#a9375c7a4c8e2a5785acd5a71078378bb">BuffLittleLong</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <span class="keywordtype">string</span>) == ((<span class="keywordtype">int</span>)<a class="code hl_define" href="netconn_8h.html#a292ee6efb14953f64ea03ddd1988b202">NETFLAG_CTL</a> | (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>))</div>
<div class="line"><span class="lineno"> 2150</span>    {</div>
<div class="line"><span class="lineno"> 2151</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> = -1;</div>
<div class="line"><span class="lineno"> 2152</span> </div>
<div class="line"><span class="lineno"> 2153</span>        <span class="comment">// these three are harmless</span></div>
<div class="line"><span class="lineno"> 2154</span>        <span class="keywordflow">if</span>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <span class="keywordtype">string</span>[4] == <a class="code hl_define" href="netconn_8h.html#a06ea659d8515a7837b0d743942d5b2ca">CCREP_SERVER_INFO</a>)</div>
<div class="line"><span class="lineno"> 2155</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2156</span>        <span class="keywordflow">if</span>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <span class="keywordtype">string</span>[4] == <a class="code hl_define" href="netconn_8h.html#a3bf085f22c8f4adbf3c06885f528ea82">CCREP_PLAYER_INFO</a>)</div>
<div class="line"><span class="lineno"> 2157</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2158</span>        <span class="keywordflow">if</span>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <span class="keywordtype">string</span>[4] == <a class="code hl_define" href="netconn_8h.html#aa34599ce347c884f29a05f2040fcab24">CCREP_RULE_INFO</a>)</div>
<div class="line"><span class="lineno"> 2159</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2160</span> </div>
<div class="line"><span class="lineno"> 2161</span>        <a class="code hl_function" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2162</span>        <span class="comment">//if(!crypto || !crypto-&gt;authenticated)</span></div>
<div class="line"><span class="lineno"> 2163</span>        {</div>
<div class="line"><span class="lineno"> 2164</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2165</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though a host key is present&quot;</span>);</div>
<div class="line"><span class="lineno"> 2166</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2167</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2168</span>        }</div>
<div class="line"><span class="lineno"> 2169</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2170</span>    }</div>
<div class="line"><span class="lineno"> 2171</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 13 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;infoResponse\x0A&quot;</span>, 13))</div>
<div class="line"><span class="lineno"> 2172</span>    {</div>
<div class="line"><span class="lineno"> 2173</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 13, <span class="stringliteral">&quot;d0_blind_id&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 2174</span>            <a class="code hl_function" href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a>(peeraddress, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2175</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2176</span>    }</div>
<div class="line"><span class="lineno"> 2177</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 15 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;statusResponse\x0A&quot;</span>, 15))</div>
<div class="line"><span class="lineno"> 2178</span>    {</div>
<div class="line"><span class="lineno"> 2179</span>        <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">save</a> = 0;</div>
<div class="line"><span class="lineno"> 2180</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"><span class="lineno"> 2181</span>        p = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strchr</a>(<span class="keywordtype">string</span> + 15, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><span class="lineno"> 2182</span>        <span class="keywordflow">if</span>(p)</div>
<div class="line"><span class="lineno"> 2183</span>        {</div>
<div class="line"><span class="lineno"> 2184</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">save</a> = *p;</div>
<div class="line"><span class="lineno"> 2185</span>            * (<span class="keywordtype">char</span> *) p = 0; <span class="comment">// cut off the string there</span></div>
<div class="line"><span class="lineno"> 2186</span>        }</div>
<div class="line"><span class="lineno"> 2187</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 15, <span class="stringliteral">&quot;d0_blind_id&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 2188</span>            <a class="code hl_function" href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a>(peeraddress, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2189</span>        <span class="keywordflow">if</span>(p)</div>
<div class="line"><span class="lineno"> 2190</span>        {</div>
<div class="line"><span class="lineno"> 2191</span>            * (<span class="keywordtype">char</span> *) p = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">save</a>;</div>
<div class="line"><span class="lineno"> 2192</span>            <span class="comment">// invoking those nasal demons again (do not run this on the DS9k)</span></div>
<div class="line"><span class="lineno"> 2193</span>        }</div>
<div class="line"><span class="lineno"> 2194</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2195</span>    }</div>
<div class="line"><span class="lineno"> 2196</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt; 10 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;challenge &quot;</span>, 10) &amp;&amp; <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">connect_trying</a>)</div>
<div class="line"><span class="lineno"> 2197</span>    {</div>
<div class="line"><span class="lineno"> 2198</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vlen_blind_id_ptr</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 2199</span>        <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_blind_id_ptr</a> = 0;</div>
<div class="line"><span class="lineno"> 2200</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>, <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>;</div>
<div class="line"><span class="lineno"> 2201</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *challenge = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> + 10;</div>
<div class="line"><span class="lineno"> 2202</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"><span class="lineno"> 2203</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 2204</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> = -1, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> = -1, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> = -1;</div>
<div class="line"><span class="lineno"> 2205</span>        <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">server_can_auth</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2206</span>        <span class="keywordtype">char</span> wantserver_idfp[<a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1];</div>
<div class="line"><span class="lineno"> 2207</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> = 0;</div>
<div class="line"><span class="lineno"> 2208</span>        <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> wantserver_issigned = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2209</span> </div>
<div class="line"><span class="lineno"> 2210</span>        <span class="comment">// Must check the source IP here, if we want to prevent other servers&#39; replies from falsely advancing the crypto state, preventing successful connect to the real server.</span></div>
<div class="line"><span class="lineno"> 2211</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="crypto_8c.html#ae5918471d5570f5ecf0da17ecf0a253b">net_sourceaddresscheck</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &amp;&amp; <a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(peeraddress, &amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>))</div>
<div class="line"><span class="lineno"> 2212</span>        {</div>
<div class="line"><span class="lineno"> 2213</span>            <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>[128];</div>
<div class="line"><span class="lineno"> 2214</span> </div>
<div class="line"><span class="lineno"> 2215</span>            <a class="code hl_function" href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>), <span class="stringliteral">&quot;ignoring challenge message from wrong server %s&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">peeraddressstring</a>);</div>
<div class="line"><span class="lineno"> 2216</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>);</div>
<div class="line"><span class="lineno"> 2217</span>        }</div>
<div class="line"><span class="lineno"> 2218</span> </div>
<div class="line"><span class="lineno"> 2219</span>        <span class="comment">// if we have a stored host key for the server, assume serverid to already be selected!</span></div>
<div class="line"><span class="lineno"> 2220</span>        <span class="comment">// (the loop will refuse to overwrite this one then)</span></div>
<div class="line"><span class="lineno"> 2221</span>        wantserver_idfp[0] = 0;</div>
<div class="line"><span class="lineno"> 2222</span>        <a class="code hl_function" href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, wantserver_idfp, <span class="keyword">sizeof</span>(wantserver_idfp), &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a>, &amp;wantserver_issigned);</div>
<div class="line"><span class="lineno"> 2223</span>        <span class="comment">// requirement: wantserver_idfp is a full ID if wantserverid set</span></div>
<div class="line"><span class="lineno"> 2224</span> </div>
<div class="line"><span class="lineno"> 2225</span>        <span class="comment">// if we leave, we have to consider the connection</span></div>
<div class="line"><span class="lineno"> 2226</span>        <span class="comment">// unauthenticated; NOTE: this may be faked by a clever</span></div>
<div class="line"><span class="lineno"> 2227</span>        <span class="comment">// attacker to force an unauthenticated connection; so we have</span></div>
<div class="line"><span class="lineno"> 2228</span>        <span class="comment">// a safeguard check in place when encryption is required too</span></div>
<div class="line"><span class="lineno"> 2229</span>        <span class="comment">// in place, or when authentication is required by the server</span></div>
<div class="line"><span class="lineno"> 2230</span>        crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2231</span> </div>
<div class="line"><span class="lineno"> 2232</span>        <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 2233</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>)</div>
<div class="line"><span class="lineno"> 2234</span>            <span class="keywordflow">return</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though a host key is present&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2235</span>                (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.integer &gt;= 3) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2236</span>                <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2237</span> </div>
<div class="line"><span class="lineno"> 2238</span>        <span class="comment">// FTEQW extension protocol</span></div>
<div class="line"><span class="lineno"> 2239</span>        <span class="keywordflow">while</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 8)</div>
<div class="line"><span class="lineno"> 2240</span>        {</div>
<div class="line"><span class="lineno"> 2241</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a> = <a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>);</div>
<div class="line"><span class="lineno"> 2242</span>            <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a> = <a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> + 4);</div>
<div class="line"><span class="lineno"> 2243</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> += 8;</div>
<div class="line"><span class="lineno"> 2244</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> -= 8;</div>
<div class="line"><span class="lineno"> 2245</span>            <span class="keywordflow">switch</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>)</div>
<div class="line"><span class="lineno"> 2246</span>            {</div>
<div class="line"><span class="lineno"> 2247</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="crypto_8c.html#a2ba1c091c9f8d31b8761c8c6c8e12a74">PROTOCOL_VLEN</a>:</div>
<div class="line"><span class="lineno"> 2248</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt;= 4 + <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>)</div>
<div class="line"><span class="lineno"> 2249</span>                    {</div>
<div class="line"><span class="lineno"> 2250</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a> = <a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>);</div>
<div class="line"><span class="lineno"> 2251</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> += 4;</div>
<div class="line"><span class="lineno"> 2252</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> -= 4;</div>
<div class="line"><span class="lineno"> 2253</span>                        <span class="keywordflow">switch</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">k</a>)</div>
<div class="line"><span class="lineno"> 2254</span>                        {</div>
<div class="line"><span class="lineno"> 2255</span>                            <span class="keywordflow">case</span> <a class="code hl_define" href="crypto_8c.html#a415708eb37a2ec762abe53d4dac87ac0">PROTOCOL_D0_BLIND_ID</a>:</div>
<div class="line"><span class="lineno"> 2256</span>                                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vlen_blind_id_ptr</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>;</div>
<div class="line"><span class="lineno"> 2257</span>                                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_blind_id_ptr</a> = <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>;</div>
<div class="line"><span class="lineno"> 2258</span>                                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2259</span>                        }</div>
<div class="line"><span class="lineno"> 2260</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> += <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>;</div>
<div class="line"><span class="lineno"> 2261</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> -= <a class="code hl_variable" href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a>;</div>
<div class="line"><span class="lineno"> 2262</span>                    }</div>
<div class="line"><span class="lineno"> 2263</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2264</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2265</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2266</span>            }</div>
<div class="line"><span class="lineno"> 2267</span>        }</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vlen_blind_id_ptr</a>)</div>
<div class="line"><span class="lineno"> 2270</span>            <span class="keywordflow">return</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server tried an unauthenticated connection even though authentication is required&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2271</span>                (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.integer &gt;= 3) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2272</span>                <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2273</span> </div>
<div class="line"><span class="lineno"> 2274</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vlen_blind_id_ptr</a>;</div>
<div class="line"><span class="lineno"> 2275</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_blind_id_ptr</a>;</div>
<div class="line"><span class="lineno"> 2276</span> </div>
<div class="line"><span class="lineno"> 2277</span>        <span class="comment">// parse fingerprints</span></div>
<div class="line"><span class="lineno"> 2278</span>        <span class="comment">//   once we found a fingerprint we can auth to (ANY), select it as clientfp</span></div>
<div class="line"><span class="lineno"> 2279</span>        <span class="comment">//   once we found a fingerprint in the first list that we know, select it as serverfp</span></div>
<div class="line"><span class="lineno"> 2280</span> </div>
<div class="line"><span class="lineno"> 2281</span>        <span class="keywordflow">for</span>(;;)</div>
<div class="line"><span class="lineno"> 2282</span>        {</div>
<div class="line"><span class="lineno"> 2283</span>            p = <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 2284</span>            <span class="keywordflow">if</span>(!p)</div>
<div class="line"><span class="lineno"> 2285</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2286</span>            <span class="keywordflow">if</span>(!*p)</div>
<div class="line"><span class="lineno"> 2287</span>            {</div>
<div class="line"><span class="lineno"> 2288</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">server_can_auth</a>)</div>
<div class="line"><span class="lineno"> 2289</span>                    <span class="keywordflow">break</span>; <span class="comment">// other protocol message may follow</span></div>
<div class="line"><span class="lineno"> 2290</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">server_can_auth</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2291</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2292</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2293</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2294</span>            }</div>
<div class="line"><span class="lineno"> 2295</span>            <span class="comment">// Find the highest numbered matching key for p.</span></div>
<div class="line"><span class="lineno"> 2296</span>            <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 2297</span>            {</div>
<div class="line"><span class="lineno"> 2298</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 2299</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(p, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><span class="lineno"> 2300</span>                {</div>
<div class="line"><span class="lineno"> 2301</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 2302</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 2303</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">server_can_auth</a>)</div>
<div class="line"><span class="lineno"> 2304</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &lt; 0 || <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a>)</div>
<div class="line"><span class="lineno"> 2305</span>                            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 2306</span>                }</div>
<div class="line"><span class="lineno"> 2307</span>            }</div>
<div class="line"><span class="lineno"> 2308</span>            <span class="comment">// Not breaking, as higher keys in the list always have priority.</span></div>
<div class="line"><span class="lineno"> 2309</span>        }</div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span>        <span class="comment">// if stored host key is not found:</span></div>
<div class="line"><span class="lineno"> 2312</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserverid</a> &gt;= 0 &amp;&amp; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 2313</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server CA does not match stored host key, refusing to connect&quot;</span>);</div>
<div class="line"><span class="lineno"> 2314</span> </div>
<div class="line"><span class="lineno"> 2315</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &gt;= 0 || <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2316</span>        {</div>
<div class="line"><span class="lineno"> 2317</span>            <a class="code hl_define" href="crypto_8c.html#a9e2d859ffde566232fcd3e099be1acc9">MAKE_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2318</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id = ++<a class="code hl_variable" href="crypto_8c.html#a09ddfceaa9b1578f414a3e3408ce7ea1">cdata_id</a>;</div>
<div class="line"><span class="lineno"> 2319</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a>;</div>
<div class="line"><span class="lineno"> 2320</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a>;</div>
<div class="line"><span class="lineno"> 2321</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, 0, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>));</div>
<div class="line"><span class="lineno"> 2322</span>            <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;challenge, challenge, <span class="keyword">sizeof</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;challenge));</div>
<div class="line"><span class="lineno"> 2323</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 2324</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 2325</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 2326</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 2327</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp, wantserver_idfp, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>));</div>
<div class="line"><span class="lineno"> 2328</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_issigned = wantserver_issigned;</div>
<div class="line"><span class="lineno"> 2329</span> </div>
<div class="line"><span class="lineno"> 2330</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp[0]) <span class="comment">// if we know a host key, honor its encryption setting</span></div>
<div class="line"><span class="lineno"> 2331</span>            <span class="keywordflow">switch</span>(<a class="code hl_define" href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a>(0, <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> ? <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> : 0, 3))</div>
<div class="line"><span class="lineno"> 2332</span>            {</div>
<div class="line"><span class="lineno"> 2333</span>                <span class="keywordflow">default</span>: <span class="comment">// dummy, never happens, but to make gcc happy...</span></div>
<div class="line"><span class="lineno"> 2334</span>                <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno"> 2335</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2336</span>                        <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2337</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2338</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2339</span>                <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno"> 2340</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes = (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &gt;= 2);</div>
<div class="line"><span class="lineno"> 2341</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2342</span>                <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno"> 2343</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes = (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &gt;= 1);</div>
<div class="line"><span class="lineno"> 2344</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2345</span>                <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno"> 2346</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &lt;= 0)</div>
<div class="line"><span class="lineno"> 2347</span>                        <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be supported (crypto_aeslevel &gt;= 1, and d0_rijndael library must be present)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2348</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2349</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2350</span>            }</div>
<div class="line"><span class="lineno"> 2351</span> </div>
<div class="line"><span class="lineno"> 2352</span>            <span class="comment">// build outgoing message</span></div>
<div class="line"><span class="lineno"> 2353</span>            <span class="comment">// append regular stuff</span></div>
<div class="line"><span class="lineno"> 2354</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\0\\id\\%d\\aeslevel\\%d\\challenge\\%s&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id, <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> ? <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> : 0, challenge));</div>
<div class="line"><span class="lineno"> 2355</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &gt;= 0 ? <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a>] : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2356</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &gt;= 0 ? <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a>] : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2357</span> </div>
<div class="line"><span class="lineno"> 2358</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2359</span>            {</div>
<div class="line"><span class="lineno"> 2360</span>                <span class="comment">// I am the client, and my key is ok... so let&#39;s set client_keyfp and client_idfp</span></div>
<div class="line"><span class="lineno"> 2361</span>                <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>));</div>
<div class="line"><span class="lineno"> 2362</span>                <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>));</div>
<div class="line"><span class="lineno"> 2363</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad0f40ef405fc08dcc50822d8183a6d30">client_issigned</a> = <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c];</div>
<div class="line"><span class="lineno"> 2364</span>            }</div>
<div class="line"><span class="lineno"> 2365</span> </div>
<div class="line"><span class="lineno"> 2366</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2367</span>            {</div>
<div class="line"><span class="lineno"> 2368</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 2369</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id = <a class="code hl_variable" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a>();</div>
<div class="line"><span class="lineno"> 2370</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 2371</span>                {</div>
<div class="line"><span class="lineno"> 2372</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2373</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_new failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2374</span>                }</div>
<div class="line"><span class="lineno"> 2375</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s]))</div>
<div class="line"><span class="lineno"> 2376</span>                {</div>
<div class="line"><span class="lineno"> 2377</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2378</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2379</span>                }</div>
<div class="line"><span class="lineno"> 2380</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 1;</div>
<div class="line"><span class="lineno"> 2381</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2382</span>            }</div>
<div class="line"><span class="lineno"> 2383</span>            <span class="keywordflow">else</span> <span class="comment">// if(clientid &gt;= 0) // guaranteed by condition one level outside</span></div>
<div class="line"><span class="lineno"> 2384</span>            {</div>
<div class="line"><span class="lineno"> 2385</span>                <span class="comment">// skip over server auth, perform client auth only</span></div>
<div class="line"><span class="lineno"> 2386</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 2387</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id = <a class="code hl_variable" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a>();</div>
<div class="line"><span class="lineno"> 2388</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 2389</span>                {</div>
<div class="line"><span class="lineno"> 2390</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2391</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_new failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2392</span>                }</div>
<div class="line"><span class="lineno"> 2393</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c]))</div>
<div class="line"><span class="lineno"> 2394</span>                {</div>
<div class="line"><span class="lineno"> 2395</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2396</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2397</span>                }</div>
<div class="line"><span class="lineno"> 2398</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;XONOTIC&quot;</span>, 8, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>)) <span class="comment">// len_out receives used size by this op</span></div>
<div class="line"><span class="lineno"> 2399</span>                {</div>
<div class="line"><span class="lineno"> 2400</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2401</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_start failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2402</span>                }</div>
<div class="line"><span class="lineno"> 2403</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 5;</div>
<div class="line"><span class="lineno"> 2404</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 2405</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2406</span>            }</div>
<div class="line"><span class="lineno"> 2407</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2408</span>        }</div>
<div class="line"><span class="lineno"> 2409</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2410</span>        {</div>
<div class="line"><span class="lineno"> 2411</span>            <span class="keywordflow">if</span>(wantserver_idfp[0]) <span class="comment">// if we know a host key, honor its encryption setting</span></div>
<div class="line"><span class="lineno"> 2412</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">wantserver_aeslevel</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 2413</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on encryption, but neither can authenticate to the other&quot;</span>);</div>
<div class="line"><span class="lineno"> 2414</span>            <span class="keywordflow">return</span> (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3) ? <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>) :</div>
<div class="line"><span class="lineno"> 2415</span>                <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2416</span>        }</div>
<div class="line"><span class="lineno"> 2417</span>    }</div>
<div class="line"><span class="lineno"> 2418</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt; 5 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;d0pk\\&quot;</span>, 5) &amp;&amp; <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">connect_trying</a>)</div>
<div class="line"><span class="lineno"> 2419</span>    {</div>
<div class="line"><span class="lineno"> 2420</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>;</div>
<div class="line"><span class="lineno"> 2421</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a>;</div>
<div class="line"><span class="lineno"> 2422</span> </div>
<div class="line"><span class="lineno"> 2423</span>        <span class="comment">// Must check the source IP here, if we want to prevent other servers&#39; replies from falsely advancing the crypto state, preventing successful connect to the real server.</span></div>
<div class="line"><span class="lineno"> 2424</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="crypto_8c.html#ae5918471d5570f5ecf0da17ecf0a253b">net_sourceaddresscheck</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &amp;&amp; <a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(peeraddress, &amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>))</div>
<div class="line"><span class="lineno"> 2425</span>        {</div>
<div class="line"><span class="lineno"> 2426</span>            <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>[128];</div>
<div class="line"><span class="lineno"> 2427</span> </div>
<div class="line"><span class="lineno"> 2428</span>            <a class="code hl_function" href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>), <span class="stringliteral">&quot;ignoring d0pk\\ message from wrong server %s&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">peeraddressstring</a>);</div>
<div class="line"><span class="lineno"> 2429</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">warn_msg</a>);</div>
<div class="line"><span class="lineno"> 2430</span>        }</div>
<div class="line"><span class="lineno"> 2431</span> </div>
<div class="line"><span class="lineno"> 2432</span>        <span class="keywordtype">id</span> = (<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;id&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)) ? <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>) : -1);</div>
<div class="line"><span class="lineno"> 2433</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a> = (<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;cnt&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)) ? <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a> : <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2434</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>)</div>
<div class="line"><span class="lineno"> 2435</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0pk\\ message without cnt&quot;</span>);</div>
<div class="line"><span class="lineno"> 2436</span>        <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 2437</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>)</div>
<div class="line"><span class="lineno"> 2438</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0pk\\ message without attachment&quot;</span>);</div>
<div class="line"><span class="lineno"> 2439</span> </div>
<div class="line"><span class="lineno"> 2440</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;1&quot;</span>))</div>
<div class="line"><span class="lineno"> 2441</span>        {</div>
<div class="line"><span class="lineno"> 2442</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2443</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 2444</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2445</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 1)</div>
<div class="line"><span class="lineno"> 2446</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 2447</span> </div>
<div class="line"><span class="lineno"> 2448</span>            <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a> = <a class="code hl_define" href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a>, <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> + 1); <span class="comment">// prevent &quot;hammering&quot;</span></div>
<div class="line"><span class="lineno"> 2449</span> </div>
<div class="line"><span class="lineno"> 2450</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;aes&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 2451</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>);</div>
<div class="line"><span class="lineno"> 2452</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2453</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2454</span>            <span class="comment">// we CANNOT toggle the AES status any more!</span></div>
<div class="line"><span class="lineno"> 2455</span>            <span class="comment">// as the server already decided</span></div>
<div class="line"><span class="lineno"> 2456</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp[0]) <span class="comment">// if we know a host key, honor its encryption setting</span></div>
<div class="line"><span class="lineno"> 2457</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes)</div>
<div class="line"><span class="lineno"> 2458</span>            {</div>
<div class="line"><span class="lineno"> 2459</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2460</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Stored host key requires encryption, but server did not enable encryption&quot;</span>);</div>
<div class="line"><span class="lineno"> 2461</span>            }</div>
<div class="line"><span class="lineno"> 2462</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; (!<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> || <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &lt;= 0))</div>
<div class="line"><span class="lineno"> 2463</span>            {</div>
<div class="line"><span class="lineno"> 2464</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2465</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on encryption too hard&quot;</span>);</div>
<div class="line"><span class="lineno"> 2466</span>            }</div>
<div class="line"><span class="lineno"> 2467</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3))</div>
<div class="line"><span class="lineno"> 2468</span>            {</div>
<div class="line"><span class="lineno"> 2469</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2470</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on plaintext too hard&quot;</span>);</div>
<div class="line"><span class="lineno"> 2471</span>            }</div>
<div class="line"><span class="lineno"> 2472</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> != 0;</div>
<div class="line"><span class="lineno"> 2473</span> </div>
<div class="line"><span class="lineno"> 2474</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\2\\id\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2475</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a238db7be954a2720b4646a56f416e7a5">qd0_blind_id_authenticate_with_private_id_challenge</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno"> 2476</span>            {</div>
<div class="line"><span class="lineno"> 2477</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2478</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_challenge failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2479</span>            }</div>
<div class="line"><span class="lineno"> 2480</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 3;</div>
<div class="line"><span class="lineno"> 2481</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 2482</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2483</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2484</span>        }</div>
<div class="line"><span class="lineno"> 2485</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;3&quot;</span>))</div>
<div class="line"><span class="lineno"> 2486</span>        {</div>
<div class="line"><span class="lineno"> 2487</span>            <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>[32];</div>
<div class="line"><span class="lineno"> 2488</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuflen</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>);</div>
<div class="line"><span class="lineno"> 2489</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>;</div>
<div class="line"><span class="lineno"> 2490</span> </div>
<div class="line"><span class="lineno"> 2491</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2492</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 2493</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2494</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 3)</div>
<div class="line"><span class="lineno"> 2495</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 2496</span> </div>
<div class="line"><span class="lineno"> 2497</span>            <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a> = <a class="code hl_define" href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a>, <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> + 1); <span class="comment">// prevent &quot;hammering&quot;</span></div>
<div class="line"><span class="lineno"> 2498</span> </div>
<div class="line"><span class="lineno"> 2499</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#af57a05bc9b21589d745930acee39eb78">qd0_blind_id_authenticate_with_private_id_verify</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuflen</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno"> 2500</span>            {</div>
<div class="line"><span class="lineno"> 2501</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2502</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_verify failed (server authentication error)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2503</span>            }</div>
<div class="line"><span class="lineno"> 2504</span> </div>
<div class="line"><span class="lineno"> 2505</span>            <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>));</div>
<div class="line"><span class="lineno"> 2506</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a> &amp;&amp; <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_issigned)</div>
<div class="line"><span class="lineno"> 2507</span>            {</div>
<div class="line"><span class="lineno"> 2508</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2509</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Stored host key requires a valid signature, but server did not provide any&quot;</span>);</div>
<div class="line"><span class="lineno"> 2510</span>            }</div>
<div class="line"><span class="lineno"> 2511</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a46738359a9a1d657faa7a94313d6aa1f">server_issigned</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>, 0, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>));</div>
<div class="line"><span class="lineno"> 2514</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>;</div>
<div class="line"><span class="lineno"> 2515</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 2516</span>            {</div>
<div class="line"><span class="lineno"> 2517</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2518</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_fingerprint64_public_id failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2519</span>            }</div>
<div class="line"><span class="lineno"> 2520</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp[0])</div>
<div class="line"><span class="lineno"> 2521</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>)))</div>
<div class="line"><span class="lineno"> 2522</span>            {</div>
<div class="line"><span class="lineno"> 2523</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2524</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server ID does not match stored host key, refusing to connect&quot;</span>);</div>
<div class="line"><span class="lineno"> 2525</span>            }</div>
<div class="line"><span class="lineno"> 2526</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>;</div>
<div class="line"><span class="lineno"> 2527</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, (<span class="keywordtype">char</span> *) crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 2528</span>            {</div>
<div class="line"><span class="lineno"> 2529</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2530</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_sessionkey_public_id failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2531</span>            }</div>
<div class="line"><span class="lineno"> 2532</span> </div>
<div class="line"><span class="lineno"> 2533</span>            <span class="comment">// cache the server key</span></div>
<div class="line"><span class="lineno"> 2534</span>            <a class="code hl_function" href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a>(&amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">connect_address</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%d %s@%s%s&quot;</span>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a> ? 1 : 0, crypto-&gt;server_idfp, crypto-&gt;server_issigned ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;~&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s]), <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">false</a>);</div>
<div class="line"><span class="lineno"> 2535</span> </div>
<div class="line"><span class="lineno"> 2536</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c &gt;= 0)</div>
<div class="line"><span class="lineno"> 2537</span>            {</div>
<div class="line"><span class="lineno"> 2538</span>                <span class="comment">// client will auth next</span></div>
<div class="line"><span class="lineno"> 2539</span>                <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\4\\id\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2540</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c]))</div>
<div class="line"><span class="lineno"> 2541</span>                {</div>
<div class="line"><span class="lineno"> 2542</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2543</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2544</span>                }</div>
<div class="line"><span class="lineno"> 2545</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;XONOTIC&quot;</span>, 8, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>)) <span class="comment">// len_out receives used size by this op</span></div>
<div class="line"><span class="lineno"> 2546</span>                {</div>
<div class="line"><span class="lineno"> 2547</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2548</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_start failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2549</span>                }</div>
<div class="line"><span class="lineno"> 2550</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 5;</div>
<div class="line"><span class="lineno"> 2551</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 2552</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2553</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2554</span>            }</div>
<div class="line"><span class="lineno"> 2555</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2556</span>            {</div>
<div class="line"><span class="lineno"> 2557</span>                <span class="comment">// session key is FINISHED (no server part is to be expected)! By this, all keys are set up</span></div>
<div class="line"><span class="lineno"> 2558</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2559</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 0;</div>
<div class="line"><span class="lineno"> 2560</span>                <span class="comment">// assume we got the empty challenge to finish the protocol</span></div>
<div class="line"><span class="lineno"> 2561</span>                <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;challenge &quot;</span>);</div>
<div class="line"><span class="lineno"> 2562</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2563</span>                --*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>; <span class="comment">// remove NUL terminator</span></div>
<div class="line"><span class="lineno"> 2564</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a6d9f8e2afed02501c245a07309bd656c">CRYPTO_REPLACE</a>;</div>
<div class="line"><span class="lineno"> 2565</span>            }</div>
<div class="line"><span class="lineno"> 2566</span>        }</div>
<div class="line"><span class="lineno"> 2567</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;5&quot;</span>))</div>
<div class="line"><span class="lineno"> 2568</span>        {</div>
<div class="line"><span class="lineno"> 2569</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>;</div>
<div class="line"><span class="lineno"> 2570</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dhkey[<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>];</div>
<div class="line"><span class="lineno"> 2571</span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 2572</span> </div>
<div class="line"><span class="lineno"> 2573</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 2574</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 2575</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2576</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 5)</div>
<div class="line"><span class="lineno"> 2577</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 2578</span> </div>
<div class="line"><span class="lineno"> 2579</span>            <a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a> = <a class="code hl_define" href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">connect_nextsendtime</a>, <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> + 1); <span class="comment">// prevent &quot;hammering&quot;</span></div>
<div class="line"><span class="lineno"> 2580</span> </div>
<div class="line"><span class="lineno"> 2581</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s &lt; 0) <span class="comment">// only if server didn&#39;t auth</span></div>
<div class="line"><span class="lineno"> 2582</span>            {</div>
<div class="line"><span class="lineno"> 2583</span>                <span class="keywordflow">if</span>(<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;aes&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 2584</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>);</div>
<div class="line"><span class="lineno"> 2585</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2586</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2587</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_idfp[0]) <span class="comment">// if we know a host key, honor its encryption setting</span></div>
<div class="line"><span class="lineno"> 2588</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;wantserver_aes)</div>
<div class="line"><span class="lineno"> 2589</span>                {</div>
<div class="line"><span class="lineno"> 2590</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2591</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Stored host key requires encryption, but server did not enable encryption&quot;</span>);</div>
<div class="line"><span class="lineno"> 2592</span>                }</div>
<div class="line"><span class="lineno"> 2593</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; (!<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> || <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &lt;= 0))</div>
<div class="line"><span class="lineno"> 2594</span>                {</div>
<div class="line"><span class="lineno"> 2595</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2596</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on encryption too hard&quot;</span>);</div>
<div class="line"><span class="lineno"> 2597</span>                }</div>
<div class="line"><span class="lineno"> 2598</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> &amp;&amp; (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3))</div>
<div class="line"><span class="lineno"> 2599</span>                {</div>
<div class="line"><span class="lineno"> 2600</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2601</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Server insists on plaintext too hard&quot;</span>);</div>
<div class="line"><span class="lineno"> 2602</span>                }</div>
<div class="line"><span class="lineno"> 2603</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> != 0;</div>
<div class="line"><span class="lineno"> 2604</span>            }</div>
<div class="line"><span class="lineno"> 2605</span> </div>
<div class="line"><span class="lineno"> 2606</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\6\\id\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 2607</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#aaf540674cda53b14bdd104f40759c386">qd0_blind_id_authenticate_with_private_id_response</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>))</div>
<div class="line"><span class="lineno"> 2608</span>            {</div>
<div class="line"><span class="lineno"> 2609</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2610</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_response failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2611</span>            }</div>
<div class="line"><span class="lineno"> 2612</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>;</div>
<div class="line"><span class="lineno"> 2613</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, (<span class="keywordtype">char</span> *) dhkey, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 2614</span>            {</div>
<div class="line"><span class="lineno"> 2615</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2616</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_sessionkey_public_id failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 2617</span>            }</div>
<div class="line"><span class="lineno"> 2618</span>            <span class="comment">// XOR the two DH keys together to make one</span></div>
<div class="line"><span class="lineno"> 2619</span>            <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 2620</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^= dhkey[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno"> 2621</span>            <span class="comment">// session key is FINISHED! By this, all keys are set up</span></div>
<div class="line"><span class="lineno"> 2622</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2623</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 0;</div>
<div class="line"><span class="lineno"> 2624</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 2625</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2626</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2627</span>        }</div>
<div class="line"><span class="lineno"> 2628</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Got unknown d0_blind_id message from server&quot;</span>);</div>
<div class="line"><span class="lineno"> 2629</span>    }</div>
<div class="line"><span class="lineno"> 2630</span> </div>
<div class="line"><span class="lineno"> 2631</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2632</span>}</div>
<div class="ttc" id="acl__main_8c_html_ab4b4e0f12a72d330ee0869bdf1b372cd"><div class="ttname"><a href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a></div><div class="ttdeci">client_static_t cls</div><div class="ttdef"><b>Definition</b> <a href="cl__main_8c_source.html#l00116">cl_main.c:116</a></div></div>
<div class="ttc" id="acom__infostring_8c_html_aa001d512a0f3228d202a4c8b47aa7984"><div class="ttname"><a href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a></div><div class="ttdeci">size_t InfoString_GetValue(const char *buffer, const char *key, char *value, size_t valuesize)</div><div class="ttdoc">Returns the number of bytes written to *value excluding the \0 terminator.</div><div class="ttdef"><b>Definition</b> <a href="com__infostring_8c_source.html#l00023">com_infostring.c:23</a></div></div>
<div class="ttc" id="acom__msg_8c_html_a9375c7a4c8e2a5785acd5a71078378bb"><div class="ttname"><a href="com__msg_8c.html#a9375c7a4c8e2a5785acd5a71078378bb">BuffLittleLong</a></div><div class="ttdeci">int BuffLittleLong(const unsigned char *buffer)</div><div class="ttdoc">Extract a little endian 32bit int from the given buffer.</div><div class="ttdef"><b>Definition</b> <a href="com__msg_8c_source.html#l00071">com_msg.c:71</a></div></div>
<div class="ttc" id="acommon_8h_html_aaef80d6b72e2476c82258733a8c4eced"><div class="ttname"><a href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a></div><div class="ttdeci">#define dp_strlcpy(dst, src, dsize)</div><div class="ttdef"><b>Definition</b> <a href="common_8h_source.html#l00303">common.h:303</a></div></div>
<div class="ttc" id="acrypto_8c_html_a09ddfceaa9b1578f414a3e3408ce7ea1"><div class="ttname"><a href="crypto_8c.html#a09ddfceaa9b1578f414a3e3408ce7ea1">cdata_id</a></div><div class="ttdeci">static int cdata_id</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00509">crypto.c:509</a></div></div>
<div class="ttc" id="acrypto_8c_html_a238db7be954a2720b4646a56f416e7a5"><div class="ttname"><a href="crypto_8c.html#a238db7be954a2720b4646a56f416e7a5">qd0_blind_id_authenticate_with_private_id_challenge</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_authenticate_with_private_id_challenge)(d0_blind_id_t *ctx, D0_BOOL is_first, D0_BOOL recv_modulus, const char *inbuf, size_t inbuflen, char *outbuf, size_t *outbuflen, D0_BOOL *status)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00223">crypto.c:223</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2cc28a754edbe5c9184d04bb4a6ad76a"><div class="ttname"><a href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a></div><div class="ttdeci">#define D0_BOOL</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00187">crypto.c:187</a></div></div>
<div class="ttc" id="acrypto_8c_html_a386a69f0199d722b7886d32cafe9d7dc"><div class="ttname"><a href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT d0_blind_id_t *(* qd0_blind_id_new)(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00198">crypto.c:198</a></div></div>
<div class="ttc" id="acrypto_8c_html_a4addd0ad7e9030ba3719926ad25b11b4"><div class="ttname"><a href="crypto_8c.html#a4addd0ad7e9030ba3719926ad25b11b4">Crypto_RetrieveHostKey</a></div><div class="ttdeci">qbool Crypto_RetrieveHostKey(lhnetaddress_t *peeraddress, int *keyid, char *keyfp, size_t keyfplen, char *idfp, size_t idfplen, int *aeslevel, qbool *issigned)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00734">crypto.c:734</a></div></div>
<div class="ttc" id="acrypto_8c_html_a4cbfb270eaaeb2f550ad978be861d129"><div class="ttname"><a href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_sessionkey_public_id)(const d0_blind_id_t *ctx, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00227">crypto.c:227</a></div></div>
<div class="ttc" id="acrypto_8c_html_a72048b767e62a20b79bde41af5b4615c"><div class="ttname"><a href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a></div><div class="ttdeci">#define CDATA</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00524">crypto.c:524</a></div></div>
<div class="ttc" id="acrypto_8c_html_a85cf03eabae9c5ffb347409d468d6f9c"><div class="ttname"><a href="crypto_8c.html#a85cf03eabae9c5ffb347409d468d6f9c">Crypto_ClientError</a></div><div class="ttdeci">static int Crypto_ClientError(char *data_out, size_t *len_out, const char *msg)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l02093">crypto.c:2093</a></div></div>
<div class="ttc" id="acrypto_8c_html_a9cb23abf4b1a78be4ffa5d5f8842faa0"><div class="ttname"><a href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_fingerprint64_public_id)(const d0_blind_id_t *ctx, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00226">crypto.c:226</a></div></div>
<div class="ttc" id="acrypto_8c_html_a9e2d859ffde566232fcd3e099be1acc9"><div class="ttname"><a href="crypto_8c.html#a9e2d859ffde566232fcd3e099be1acc9">MAKE_CDATA</a></div><div class="ttdeci">#define MAKE_CDATA</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00525">crypto.c:525</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa09cfb5d32dc22ee93c5f88bb883084e"><div class="ttname"><a href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_authenticate_with_private_id_start)(d0_blind_id_t *ctx, D0_BOOL is_first, D0_BOOL send_modulus, const char *message, size_t msglen, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00222">crypto.c:222</a></div></div>
<div class="ttc" id="acrypto_8c_html_aaf540674cda53b14bdd104f40759c386"><div class="ttname"><a href="crypto_8c.html#aaf540674cda53b14bdd104f40759c386">qd0_blind_id_authenticate_with_private_id_response</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_authenticate_with_private_id_response)(d0_blind_id_t *ctx, const char *inbuf, size_t inbuflen, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00224">crypto.c:224</a></div></div>
<div class="ttc" id="acrypto_8c_html_aaf812a19119a94ac6d13e6c6f241e7ad"><div class="ttname"><a href="crypto_8c.html#aaf812a19119a94ac6d13e6c6f241e7ad">Crypto_StoreHostKey</a></div><div class="ttdeci">static void Crypto_StoreHostKey(lhnetaddress_t *peeraddress, const char *keystring, qbool complain)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00635">crypto.c:635</a></div></div>
<div class="ttc" id="acrypto_8c_html_ab680491cca435a1f84b2e9fa8a973061"><div class="ttname"><a href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a></div><div class="ttdeci">static unsigned long Crypto_LittleLong(const char *data)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00059">crypto.c:59</a></div></div>
<div class="ttc" id="acrypto_8c_html_aca5468ecb996a99a78f68985d23a085d"><div class="ttname"><a href="crypto_8c.html#aca5468ecb996a99a78f68985d23a085d">Crypto_SoftClientError</a></div><div class="ttdeci">static int Crypto_SoftClientError(char *data_out, size_t *len_out, const char *msg)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l02100">crypto.c:2100</a></div></div>
<div class="ttc" id="acrypto_8c_html_acb17359f23753e70a2d100f311c83e9b"><div class="ttname"><a href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_copy)(d0_blind_id_t *ctx, const d0_blind_id_t *src)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00201">crypto.c:201</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae0749fdaf63ce66fa265a6eb1d352a36"><div class="ttname"><a href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a></div><div class="ttdeci">#define CLEAR_CDATA</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00526">crypto.c:526</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae5918471d5570f5ecf0da17ecf0a253b"><div class="ttname"><a href="crypto_8c.html#ae5918471d5570f5ecf0da17ecf0a253b">net_sourceaddresscheck</a></div><div class="ttdeci">cvar_t net_sourceaddresscheck</div><div class="ttdef"><b>Definition</b> <a href="netconn_8c_source.html#l00083">netconn.c:83</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae86e7e74ff72144661d72e3a6d347cdc"><div class="ttname"><a href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a></div><div class="ttdeci">static const char * GetUntilNul(const char **data, size_t *len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00418">crypto.c:418</a></div></div>
<div class="ttc" id="acrypto_8c_html_af57a05bc9b21589d745930acee39eb78"><div class="ttname"><a href="crypto_8c.html#af57a05bc9b21589d745930acee39eb78">qd0_blind_id_authenticate_with_private_id_verify</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_authenticate_with_private_id_verify)(d0_blind_id_t *ctx, const char *inbuf, size_t inbuflen, char *msg, size_t *msglen, D0_BOOL *status)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00225">crypto.c:225</a></div></div>
<div class="ttc" id="acrypto_8h_html_a1efd20cc345410a8f68978ece41aac10"><div class="ttname"><a href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a></div><div class="ttdeci">#define CRYPTO_DISCARD</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00066">crypto.h:66</a></div></div>
<div class="ttc" id="acrypto_8h_html_a5b284ff4c80ff5aa9f0b4ee842a33d44"><div class="ttname"><a href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a></div><div class="ttdeci">#define FP64_SIZE</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00038">crypto.h:38</a></div></div>
<div class="ttc" id="acrypto_8h_html_a8c7ff8f693d7a32873476640d01ecef3"><div class="ttname"><a href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a></div><div class="ttdeci">#define CRYPTO_NOMATCH</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00064">crypto.h:64</a></div></div>
<div class="ttc" id="aglquake_8h_html_a004e0b0e92ed2f6e1c9993f0271ebfb3"><div class="ttname"><a href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a></div><div class="ttdeci">GLenum GLuint id</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00656">glquake.h:656</a></div></div>
<div class="ttc" id="aglquake_8h_html_a4d1613b1e415f5e41c4651a1793b277a"><div class="ttname"><a href="glquake_8h.html#a4d1613b1e415f5e41c4651a1793b277a">v</a></div><div class="ttdeci">const GLdouble * v</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00761">glquake.h:761</a></div></div>
<div class="ttc" id="ahost_8c_html_a18cf3cec0ecbf5cc14125f494c49023d"><div class="ttname"><a href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a></div><div class="ttdeci">host_static_t host</div><div class="ttdef"><b>Definition</b> <a href="host_8c_source.html#l00041">host.c:41</a></div></div>
<div class="ttc" id="amathlib_8h_html_a24e753bacac6be5f30e18f8a2bdefda4"><div class="ttname"><a href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a></div><div class="ttdeci">#define max(A, B)</div><div class="ttdef"><b>Definition</b> <a href="mathlib_8h_source.html#l00038">mathlib.h:38</a></div></div>
<div class="ttc" id="amathlib_8h_html_a553641b2aac0b2a7c43f9f74f8333fd5"><div class="ttname"><a href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a></div><div class="ttdeci">#define bound(min, num, max)</div><div class="ttdef"><b>Definition</b> <a href="mathlib_8h_source.html#l00034">mathlib.h:34</a></div></div>
<div class="ttc" id="anetconn_8h_html_a06ea659d8515a7837b0d743942d5b2ca"><div class="ttname"><a href="netconn_8h.html#a06ea659d8515a7837b0d743942d5b2ca">CCREP_SERVER_INFO</a></div><div class="ttdeci">#define CCREP_SERVER_INFO</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00127">netconn.h:127</a></div></div>
<div class="ttc" id="anetconn_8h_html_a292ee6efb14953f64ea03ddd1988b202"><div class="ttname"><a href="netconn_8h.html#a292ee6efb14953f64ea03ddd1988b202">NETFLAG_CTL</a></div><div class="ttdeci">#define NETFLAG_CTL</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00044">netconn.h:44</a></div></div>
<div class="ttc" id="anetconn_8h_html_a3bf085f22c8f4adbf3c06885f528ea82"><div class="ttname"><a href="netconn_8h.html#a3bf085f22c8f4adbf3c06885f528ea82">CCREP_PLAYER_INFO</a></div><div class="ttdeci">#define CCREP_PLAYER_INFO</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00128">netconn.h:128</a></div></div>
<div class="ttc" id="anetconn_8h_html_aa34599ce347c884f29a05f2040fcab24"><div class="ttname"><a href="netconn_8h.html#aa34599ce347c884f29a05f2040fcab24">CCREP_RULE_INFO</a></div><div class="ttdeci">#define CCREP_RULE_INFO</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00129">netconn.h:129</a></div></div>
<div class="ttc" id="aqdefs_8h_html_a119f8457078d7390fb45ea0838adb806"><div class="ttname"><a href="qdefs_8h.html#a119f8457078d7390fb45ea0838adb806">MAX_INPUTLINE</a></div><div class="ttdeci">#define MAX_INPUTLINE</div><div class="ttdoc">maximum size of console commandline, QuakeC strings, and many other text processing buffers</div><div class="ttdef"><b>Definition</b> <a href="qdefs_8h_source.html#l00094">qdefs.h:94</a></div></div>
<div class="ttc" id="astructclient__static__t_html_a2918ef8b215b79e8f7067feb116eb6b4"><div class="ttname"><a href="structclient__static__t.html#a2918ef8b215b79e8f7067feb116eb6b4">client_static_t::connect_trying</a></div><div class="ttdeci">qbool connect_trying</div><div class="ttdef"><b>Definition</b> <a href="client_8h_source.html#l00610">client.h:610</a></div></div>
<div class="ttc" id="astructclient__static__t_html_a6b1b21c226c99c9d1e972dc080ee1855"><div class="ttname"><a href="structclient__static__t.html#a6b1b21c226c99c9d1e972dc080ee1855">client_static_t::crypto</a></div><div class="ttdeci">crypto_t crypto</div><div class="ttdef"><b>Definition</b> <a href="client_8h_source.html#l00681">client.h:681</a></div></div>
<div class="ttc" id="astructclient__static__t_html_abdcdc5e6094eaabade817df1719c559a"><div class="ttname"><a href="structclient__static__t.html#abdcdc5e6094eaabade817df1719c559a">client_static_t::connect_nextsendtime</a></div><div class="ttdeci">double connect_nextsendtime</div><div class="ttdef"><b>Definition</b> <a href="client_8h_source.html#l00612">client.h:612</a></div></div>
<div class="ttc" id="astructclient__static__t_html_ac3fec2efadcad43aac413b686920dfb1"><div class="ttname"><a href="structclient__static__t.html#ac3fec2efadcad43aac413b686920dfb1">client_static_t::connect_address</a></div><div class="ttdeci">lhnetaddress_t connect_address</div><div class="ttdef"><b>Definition</b> <a href="client_8h_source.html#l00614">client.h:614</a></div></div>
<div class="ttc" id="astructcrypto__t_html"><div class="ttname"><a href="structcrypto__t.html">crypto_t</a></div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00041">crypto.h:42</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a318251b45f735d3bfddd12838c89cfc4"><div class="ttname"><a href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">crypto_t::server_keyfp</a></div><div class="ttdeci">char server_keyfp[FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00048">crypto.h:48</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a46738359a9a1d657faa7a94313d6aa1f"><div class="ttname"><a href="structcrypto__t.html#a46738359a9a1d657faa7a94313d6aa1f">crypto_t::server_issigned</a></div><div class="ttdeci">qbool server_issigned</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00049">crypto.h:49</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a60ee73f814f37cb03ca6337d2c714eb2"><div class="ttname"><a href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">crypto_t::client_idfp</a></div><div class="ttdeci">char client_idfp[FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00044">crypto.h:44</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a62712966bbfd7a3b7a32b14291aaaa1c"><div class="ttname"><a href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">crypto_t::dhkey</a></div><div class="ttdeci">unsigned char dhkey[DHKEY_SIZE]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00043">crypto.h:43</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a68057f781c7ef3efbb8dd9c2a3dbd816"><div class="ttname"><a href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">crypto_t::client_keyfp</a></div><div class="ttdeci">char client_keyfp[FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00045">crypto.h:45</a></div></div>
<div class="ttc" id="astructcrypto__t_html_a7f14ed53c5a1a67b9b2502b4662df228"><div class="ttname"><a href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">crypto_t::authenticated</a></div><div class="ttdeci">qbool authenticated</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00050">crypto.h:50</a></div></div>
<div class="ttc" id="astructcrypto__t_html_ad0f40ef405fc08dcc50822d8183a6d30"><div class="ttname"><a href="structcrypto__t.html#ad0f40ef405fc08dcc50822d8183a6d30">crypto_t::client_issigned</a></div><div class="ttdeci">qbool client_issigned</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00046">crypto.h:46</a></div></div>
<div class="ttc" id="astructcrypto__t_html_ad495ade07da51add51fdcfa3763866bd"><div class="ttname"><a href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">crypto_t::server_idfp</a></div><div class="ttdeci">char server_idfp[FP64_SIZE+1]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00047">crypto.h:47</a></div></div>
<div class="ttc" id="astructcrypto__t_html_affa2d958b3f1849e55ab9fd6a5f5c1b7"><div class="ttname"><a href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">crypto_t::use_aes</a></div><div class="ttdeci">qbool use_aes</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00051">crypto.h:51</a></div></div>
<div class="ttc" id="astructhost__static__t_html_ac38d937c03a5f5f973a77641c0ae1280"><div class="ttname"><a href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">host_static_t::realtime</a></div><div class="ttdeci">double realtime</div><div class="ttdef"><b>Definition</b> <a href="host_8h_source.html#l00037">host.h:37</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l02002">NetConn_ClientParsePacket()</a>.</p>

</div>
</div>
<a id="acdd38a734f1d86b5075d6d6a82c71b7b" name="acdd38a734f1d86b5075d6d6a82c71b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdd38a734f1d86b5075d6d6a82c71b7b">&#9670;&#160;</a></span>Crypto_CloseLibrary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_CloseLibrary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00306">306</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  307</span>{</div>
<div class="line"><span class="lineno">  308</span>    <a class="code hl_function" href="sys_8h.html#ae1bd207c941d95e0bd80aae8dab178f2">Sys_FreeLibrary</a> (&amp;<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>);</div>
<div class="line"><span class="lineno">  309</span>}</div>
<div class="ttc" id="asys_8h_html_ae1bd207c941d95e0bd80aae8dab178f2"><div class="ttname"><a href="sys_8h.html#ae1bd207c941d95e0bd80aae8dab178f2">Sys_FreeLibrary</a></div><div class="ttdeci">void Sys_FreeLibrary(dllhandle_t *handle)</div><div class="ttdef"><b>Definition</b> <a href="sys__shared_8c_source.html#l00242">sys_shared.c:242</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>, and <a class="el" href="crypto_8c_source.html#l01043">Crypto_Shutdown()</a>.</p>

</div>
</div>
<a id="aef1ead9aff323c67f6ea971213af9b87" name="aef1ead9aff323c67f6ea971213af9b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef1ead9aff323c67f6ea971213af9b87">&#9670;&#160;</a></span>Crypto_d0_createmutex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> * Crypto_d0_createmutex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01020">1020</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1021</span>{</div>
<div class="line"><span class="lineno"> 1022</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="thread_8h.html#a4fe4e5bb1feca332e6957d1c27a87b58">Thread_CreateMutex</a>();</div>
<div class="line"><span class="lineno"> 1023</span>}</div>
<div class="ttc" id="athread_8h_html_a4fe4e5bb1feca332e6957d1c27a87b58"><div class="ttname"><a href="thread_8h.html#a4fe4e5bb1feca332e6957d1c27a87b58">Thread_CreateMutex</a></div><div class="ttdeci">#define Thread_CreateMutex()</div><div class="ttdef"><b>Definition</b> <a href="thread_8h_source.html#l00015">thread.h:15</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="a2a246f3b70ce88542638a2e60c057921" name="a2a246f3b70ce88542638a2e60c057921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a246f3b70ce88542638a2e60c057921">&#9670;&#160;</a></span>Crypto_d0_destroymutex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_d0_destroymutex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01025">1025</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1026</span>{</div>
<div class="line"><span class="lineno"> 1027</span>    <a class="code hl_define" href="thread_8h.html#a269bbcbf27698a4ab30bede7c4feefa3">Thread_DestroyMutex</a>(m);</div>
<div class="line"><span class="lineno"> 1028</span>}</div>
<div class="ttc" id="athread_8h_html_a269bbcbf27698a4ab30bede7c4feefa3"><div class="ttname"><a href="thread_8h.html#a269bbcbf27698a4ab30bede7c4feefa3">Thread_DestroyMutex</a></div><div class="ttdeci">#define Thread_DestroyMutex(m)</div><div class="ttdef"><b>Definition</b> <a href="thread_8h_source.html#l00016">thread.h:16</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="a04461f04f135ed9168b3635769dfd3fb" name="a04461f04f135ed9168b3635769dfd3fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04461f04f135ed9168b3635769dfd3fb">&#9670;&#160;</a></span>Crypto_d0_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_d0_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01015">1015</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1016</span>{</div>
<div class="line"><span class="lineno"> 1017</span>    <a class="code hl_define" href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a>(p);</div>
<div class="line"><span class="lineno"> 1018</span>}</div>
<div class="ttc" id="azone_8h_html_a06bb588bb8d0406e051f04c1ca723d28"><div class="ttname"><a href="zone_8h.html#a06bb588bb8d0406e051f04c1ca723d28">Mem_Free</a></div><div class="ttdeci">#define Mem_Free(mem)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00096">zone.h:96</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="a451c6225535919e74dc187635381c137" name="a451c6225535919e74dc187635381c137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a451c6225535919e74dc187635381c137">&#9670;&#160;</a></span>Crypto_d0_lockmutex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_d0_lockmutex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01030">1030</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1031</span>{</div>
<div class="line"><span class="lineno"> 1032</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="thread_8h.html#a7f3f3ae74fd58a8277941afd6a271b43">Thread_LockMutex</a>(m);</div>
<div class="line"><span class="lineno"> 1033</span>}</div>
<div class="ttc" id="athread_8h_html_a7f3f3ae74fd58a8277941afd6a271b43"><div class="ttname"><a href="thread_8h.html#a7f3f3ae74fd58a8277941afd6a271b43">Thread_LockMutex</a></div><div class="ttdeci">#define Thread_LockMutex(m)</div><div class="ttdef"><b>Definition</b> <a href="thread_8h_source.html#l00017">thread.h:17</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="ad3e46b0be825db44980c41f18e4a27ea" name="ad3e46b0be825db44980c41f18e4a27ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3e46b0be825db44980c41f18e4a27ea">&#9670;&#160;</a></span>Crypto_d0_malloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> * Crypto_d0_malloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01010">1010</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1011</span>{</div>
<div class="line"><span class="lineno"> 1012</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="zone_8h.html#a1f8b0c54fe3d32858da2b13a4f7e5783">Mem_Alloc</a>(<a class="code hl_variable" href="crypto_8c.html#a473d64350b7902deaac13e21f96f11d8">cryptomempool</a>, len);</div>
<div class="line"><span class="lineno"> 1013</span>}</div>
<div class="ttc" id="acrypto_8c_html_a473d64350b7902deaac13e21f96f11d8"><div class="ttname"><a href="crypto_8c.html#a473d64350b7902deaac13e21f96f11d8">cryptomempool</a></div><div class="ttdeci">static mempool_t * cryptomempool</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01004">crypto.c:1004</a></div></div>
<div class="ttc" id="azone_8h_html_a1f8b0c54fe3d32858da2b13a4f7e5783"><div class="ttname"><a href="zone_8h.html#a1f8b0c54fe3d32858da2b13a4f7e5783">Mem_Alloc</a></div><div class="ttdeci">#define Mem_Alloc(pool, size)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00092">zone.h:92</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="abf9cffdca970c75960fb23d63552825b" name="abf9cffdca970c75960fb23d63552825b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf9cffdca970c75960fb23d63552825b">&#9670;&#160;</a></span>Crypto_d0_unlockmutex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_d0_unlockmutex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01035">1035</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1036</span>{</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="thread_8h.html#ada4fef8706961af60f0404fdbfa50be7">Thread_UnlockMutex</a>(m);</div>
<div class="line"><span class="lineno"> 1038</span>}</div>
<div class="ttc" id="athread_8h_html_ada4fef8706961af60f0404fdbfa50be7"><div class="ttname"><a href="thread_8h.html#ada4fef8706961af60f0404fdbfa50be7">Thread_UnlockMutex</a></div><div class="ttdeci">#define Thread_UnlockMutex(m)</div><div class="ttdef"><b>Definition</b> <a href="thread_8h_source.html#l00018">thread.h:18</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="a5edc59e776eb84e8d80fd7a1c83e7973" name="a5edc59e776eb84e8d80fd7a1c83e7973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5edc59e776eb84e8d80fd7a1c83e7973">&#9670;&#160;</a></span>Crypto_DecryptPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> * Crypto_DecryptPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td>
          <td class="paramname"><em>crypto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01584">1584</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1585</span>{</div>
<div class="line"><span class="lineno"> 1586</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> h[32];</div>
<div class="line"><span class="lineno"> 1587</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1588</span> </div>
<div class="line"><span class="lineno"> 1589</span>    <span class="comment">// silently handle non-crypto packets</span></div>
<div class="line"><span class="lineno"> 1590</span>    <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code hl_function" href="com__msg_8c.html#acd30e83205c1a8193744237c44ad0f01">BuffBigLong</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>);</div>
<div class="line"><span class="lineno"> 1591</span>    <span class="keywordflow">if</span>(</div>
<div class="line"><span class="lineno"> 1592</span>        (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0xFFFFFFFF) <span class="comment">// avoid QW control packet</span></div>
<div class="line"><span class="lineno"> 1593</span>        ||</div>
<div class="line"><span class="lineno"> 1594</span>        (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0x80000000 + (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>) <span class="comment">// avoid NQ control packet</span></div>
<div class="line"><span class="lineno"> 1595</span>    )</div>
<div class="line"><span class="lineno"> 1596</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1597</span> </div>
<div class="line"><span class="lineno"> 1598</span>    <span class="keywordflow">if</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a>)</div>
<div class="line"><span class="lineno"> 1599</span>    {</div>
<div class="line"><span class="lineno"> 1600</span>        <span class="keywordflow">if</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a>)</div>
<div class="line"><span class="lineno"> 1601</span>        {</div>
<div class="line"><span class="lineno"> 1602</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> &lt; 16 || ((<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> - 16) % 16))</div>
<div class="line"><span class="lineno"> 1603</span>            {</div>
<div class="line"><span class="lineno"> 1604</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_DecryptPacket failed (not enough space: %d bytes in, %d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1605</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1606</span>            }</div>
<div class="line"><span class="lineno"> 1607</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> - ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>)[0];</div>
<div class="line"><span class="lineno"> 1608</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len &lt; *len_dst || *len_dst &gt;</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> - 16)</div>
<div class="line"><span class="lineno"> 1609</span>            {</div>
<div class="line"><span class="lineno"> 1610</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_DecryptPacket failed (not enough space: %d bytes in, %d-&gt;%d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1611</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1612</span>            }</div>
<div class="line"><span class="lineno"> 1613</span>            <a class="code hl_function" href="crypto_8c.html#a65bcc30d6b1ebadfcec50ca06f7bfac5">seacpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, ((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>) + 16, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>);</div>
<div class="line"><span class="lineno"> 1614</span>            <span class="comment">//                    IV                          dst                         src                                      len</span></div>
<div class="line"><span class="lineno"> 1615</span>            <span class="keywordflow">if</span>(!<a class="code hl_define" href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a>(h, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, (<span class="keywordtype">int</span>)*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>))</div>
<div class="line"><span class="lineno"> 1616</span>            {</div>
<div class="line"><span class="lineno"> 1617</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC fail\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1618</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1619</span>            }</div>
<div class="line"><span class="lineno"> 1620</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>)+1, h, 15)) <span class="comment">// ignore first byte, used for length</span></div>
<div class="line"><span class="lineno"> 1621</span>            {</div>
<div class="line"><span class="lineno"> 1622</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC mismatch\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1623</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1624</span>            }</div>
<div class="line"><span class="lineno"> 1625</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="netconn_8c.html#a6ec6ab811f71ef2e66d3aa1710c0a095">developer_networking</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno"> 1626</span>            {</div>
<div class="line"><span class="lineno"> 1627</span>                <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;Decrypted:\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1628</span>                <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, (<span class="keywordtype">int</span>)*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>);</div>
<div class="line"><span class="lineno"> 1629</span>            }</div>
<div class="line"><span class="lineno"> 1630</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>; <span class="comment">// no need to copy</span></div>
<div class="line"><span class="lineno"> 1631</span>        }</div>
<div class="line"><span class="lineno"> 1632</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1633</span>        {</div>
<div class="line"><span class="lineno"> 1634</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> &lt; 16)</div>
<div class="line"><span class="lineno"> 1635</span>            {</div>
<div class="line"><span class="lineno"> 1636</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_DecryptPacket failed (not enough space: %d bytes in, %d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1637</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1638</span>            }</div>
<div class="line"><span class="lineno"> 1639</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> - 16;</div>
<div class="line"><span class="lineno"> 1640</span>            <span class="keywordflow">if</span>(len &lt; *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>)</div>
<div class="line"><span class="lineno"> 1641</span>            {</div>
<div class="line"><span class="lineno"> 1642</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_DecryptPacket failed (not enough space: %d bytes in, %d-&gt;%d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1643</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1644</span>            }</div>
<div class="line"><span class="lineno"> 1645</span>            <span class="comment">//memcpy(data_dst, data_src + 16, *len_dst);</span></div>
<div class="line"><span class="lineno"> 1646</span>            <span class="keywordflow">if</span>(!<a class="code hl_define" href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a>(h, ((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>) + 16, (<span class="keywordtype">int</span>)*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>))</div>
<div class="line"><span class="lineno"> 1647</span>            {</div>
<div class="line"><span class="lineno"> 1648</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC fail\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1649</span>                <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1650</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1651</span>            }</div>
<div class="line"><span class="lineno"> 1652</span> </div>
<div class="line"><span class="lineno"> 1653</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, h, 16)) <span class="comment">// ignore first byte, used for length</span></div>
<div class="line"><span class="lineno"> 1654</span>            {</div>
<div class="line"><span class="lineno"> 1655</span>                <span class="comment">// undo the &quot;avoid conditions&quot;</span></div>
<div class="line"><span class="lineno"> 1656</span>                <span class="keywordflow">if</span>(</div>
<div class="line"><span class="lineno"> 1657</span>                        (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0x7FFFFFFF) <span class="comment">// avoided QW control packet</span></div>
<div class="line"><span class="lineno"> 1658</span>                        ||</div>
<div class="line"><span class="lineno"> 1659</span>                        (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0x00000000 + (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>) <span class="comment">// avoided NQ control packet</span></div>
<div class="line"><span class="lineno"> 1660</span>                  )</div>
<div class="line"><span class="lineno"> 1661</span>                {</div>
<div class="line"><span class="lineno"> 1662</span>                    <span class="comment">// do the avoidance on the hash too</span></div>
<div class="line"><span class="lineno"> 1663</span>                    h[0] ^= 0x80;</div>
<div class="line"><span class="lineno"> 1664</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, h, 16)) <span class="comment">// ignore first byte, used for length</span></div>
<div class="line"><span class="lineno"> 1665</span>                    {</div>
<div class="line"><span class="lineno"> 1666</span>                        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC mismatch\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1667</span>                        <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1668</span>                        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1669</span>                    }</div>
<div class="line"><span class="lineno"> 1670</span>                }</div>
<div class="line"><span class="lineno"> 1671</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1672</span>                {</div>
<div class="line"><span class="lineno"> 1673</span>                    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;HMAC mismatch\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1674</span>                    <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1675</span>                    <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1676</span>                }</div>
<div class="line"><span class="lineno"> 1677</span>            }</div>
<div class="line"><span class="lineno"> 1678</span>            <span class="keywordflow">return</span> ((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>) + 16; <span class="comment">// no need to copy, so data_dst is not used</span></div>
<div class="line"><span class="lineno"> 1679</span>        }</div>
<div class="line"><span class="lineno"> 1680</span>    }</div>
<div class="line"><span class="lineno"> 1681</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1682</span>    {</div>
<div class="line"><span class="lineno"> 1683</span>        *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>;</div>
<div class="line"><span class="lineno"> 1684</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>;</div>
<div class="line"><span class="lineno"> 1685</span>    }</div>
<div class="line"><span class="lineno"> 1686</span>}</div>
<div class="ttc" id="acom__msg_8c_html_acd30e83205c1a8193744237c44ad0f01"><div class="ttname"><a href="com__msg_8c.html#acd30e83205c1a8193744237c44ad0f01">BuffBigLong</a></div><div class="ttdeci">int BuffBigLong(const unsigned char *buffer)</div><div class="ttdoc">Extract a big endian 32bit int from the given buffer.</div><div class="ttdef"><b>Definition</b> <a href="com__msg_8c_source.html#l00049">com_msg.c:49</a></div></div>
<div class="ttc" id="acommon_8c_html_a9913aa4c9e2d0acfc38638235bbe31ca"><div class="ttname"><a href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a></div><div class="ttdeci">void Com_HexDumpToConsole(const unsigned char *data, int size)</div><div class="ttdef"><b>Definition</b> <a href="common_8c_source.html#l00082">common.c:82</a></div></div>
<div class="ttc" id="aconsole_8c_html_a1cf9711475097b11dc41f743254ec77e"><div class="ttname"><a href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a></div><div class="ttdeci">void Con_Print(const char *msg)</div><div class="ttdoc">Prints to all appropriate console targets, and adds timestamps.</div><div class="ttdef"><b>Definition</b> <a href="console_8c_source.html#l01450">console.c:1450</a></div></div>
<div class="ttc" id="aconsole_8c_html_a49b71fe9a87e57a440e07af4a869a9f6"><div class="ttname"><a href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a></div><div class="ttdeci">void Con_Printf(const char *fmt,...)</div><div class="ttdoc">Prints to all appropriate console targets.</div><div class="ttdef"><b>Definition</b> <a href="console_8c_source.html#l01460">console.c:1460</a></div></div>
<div class="ttc" id="acrypto_8c_html_a65bcc30d6b1ebadfcec50ca06f7bfac5"><div class="ttname"><a href="crypto_8c.html#a65bcc30d6b1ebadfcec50ca06f7bfac5">seacpy</a></div><div class="ttdeci">static void seacpy(unsigned char *key, const unsigned char *iv, unsigned char *dst, const unsigned char *src, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01498">crypto.c:1498</a></div></div>
<div class="ttc" id="ahmac_8h_html_a3ea45fae63ebf2bb7feef10afe4505f2"><div class="ttname"><a href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a></div><div class="ttdeci">#define HMAC_SHA256_32BYTES(out, in, n, key, k)</div><div class="ttdef"><b>Definition</b> <a href="hmac_8h_source.html#l00015">hmac.h:15</a></div></div>
<div class="ttc" id="anetconn_8c_html_a6ec6ab811f71ef2e66d3aa1710c0a095"><div class="ttname"><a href="netconn_8c.html#a6ec6ab811f71ef2e66d3aa1710c0a095">developer_networking</a></div><div class="ttdeci">cvar_t developer_networking</div><div class="ttdef"><b>Definition</b> <a href="netconn_8c_source.html#l00085">netconn.c:85</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l01321">NetConn_ReceivedMessage()</a>.</p>

</div>
</div>
<a id="a31f0f56ef0e8867e2bae48ad0c12eb7c" name="a31f0f56ef0e8867e2bae48ad0c12eb7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31f0f56ef0e8867e2bae48ad0c12eb7c">&#9670;&#160;</a></span>Crypto_EncryptPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> * Crypto_EncryptPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td>
          <td class="paramname"><em>crypto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01527">1527</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1528</span>{</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> h[32];</div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordflow">if</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a>)</div>
<div class="line"><span class="lineno"> 1532</span>    {</div>
<div class="line"><span class="lineno"> 1533</span>        <span class="keywordflow">if</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a>)</div>
<div class="line"><span class="lineno"> 1534</span>        {</div>
<div class="line"><span class="lineno"> 1535</span>            <span class="comment">// AES packet = 1 byte length overhead, 15 bytes from HMAC-SHA-256, data, 0..15 bytes padding</span></div>
<div class="line"><span class="lineno"> 1536</span>            <span class="comment">// 15 bytes HMAC-SHA-256 (112bit) suffice as the attacker can&#39;t do more than forge a random-looking packet</span></div>
<div class="line"><span class="lineno"> 1537</span>            <span class="comment">// HMAC is needed to not leak information about packet content</span></div>
<div class="line"><span class="lineno"> 1538</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="netconn_8c.html#a6ec6ab811f71ef2e66d3aa1710c0a095">developer_networking</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno"> 1539</span>            {</div>
<div class="line"><span class="lineno"> 1540</span>                <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;To be encrypted:\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1541</span>                <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1542</span>            }</div>
<div class="line"><span class="lineno"> 1543</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> + 32 &gt; len || !<a class="code hl_define" href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a>(h, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>))</div>
<div class="line"><span class="lineno"> 1544</span>            {</div>
<div class="line"><span class="lineno"> 1545</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_EncryptPacket failed (not enough space: %d bytes in, %d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1546</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1547</span>            }</div>
<div class="line"><span class="lineno"> 1548</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = ((<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> + 15) / 16) * 16 + 16; <span class="comment">// add 16 for HMAC, then round to 16-size for AES</span></div>
<div class="line"><span class="lineno"> 1549</span>            ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>)[0] = (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>)(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1550</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>)+1, h, 15);</div>
<div class="line"><span class="lineno"> 1551</span>            <a class="code hl_function" href="crypto_8c.html#add3d6a3c0d2952e5dfdd43ad262d46dc">aescpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>) + 16, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1552</span>            <span class="comment">//                    IV                                dst                                src                               len</span></div>
<div class="line"><span class="lineno"> 1553</span>        }</div>
<div class="line"><span class="lineno"> 1554</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1555</span>        {</div>
<div class="line"><span class="lineno"> 1556</span>            <span class="comment">// HMAC packet = 16 bytes HMAC-SHA-256 (truncated to 128 bits), data</span></div>
<div class="line"><span class="lineno"> 1557</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> + 16 &gt; len || !<a class="code hl_define" href="hmac_8h.html#a3ea45fae63ebf2bb7feef10afe4505f2">HMAC_SHA256_32BYTES</a>(h, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>))</div>
<div class="line"><span class="lineno"> 1558</span>            {</div>
<div class="line"><span class="lineno"> 1559</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_EncryptPacket failed (not enough space: %d bytes in, %d bytes out)\n&quot;</span>, (<span class="keywordtype">int</span>) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>, (<span class="keywordtype">int</span>) len);</div>
<div class="line"><span class="lineno"> 1560</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1561</span>            }</div>
<div class="line"><span class="lineno"> 1562</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a> + 16;</div>
<div class="line"><span class="lineno"> 1563</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>, h, 16);</div>
<div class="line"><span class="lineno"> 1564</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>) + 16, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>);</div>
<div class="line"><span class="lineno"> 1565</span> </div>
<div class="line"><span class="lineno"> 1566</span>            <span class="comment">// handle the &quot;avoid&quot; conditions:</span></div>
<div class="line"><span class="lineno"> 1567</span>            <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code hl_function" href="com__msg_8c.html#acd30e83205c1a8193744237c44ad0f01">BuffBigLong</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>);</div>
<div class="line"><span class="lineno"> 1568</span>            <span class="keywordflow">if</span>(</div>
<div class="line"><span class="lineno"> 1569</span>                (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0xFFFFFFFF) <span class="comment">// avoid QW control packet</span></div>
<div class="line"><span class="lineno"> 1570</span>                ||</div>
<div class="line"><span class="lineno"> 1571</span>                (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == (<span class="keywordtype">int</span>)0x80000000 + (<span class="keywordtype">int</span>)*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a>) <span class="comment">// avoid NQ control packet</span></div>
<div class="line"><span class="lineno"> 1572</span>            )</div>
<div class="line"><span class="lineno"> 1573</span>                *(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a> ^= 0x80; <span class="comment">// this will ALWAYS fix it</span></div>
<div class="line"><span class="lineno"> 1574</span>        }</div>
<div class="line"><span class="lineno"> 1575</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_dst</a>;</div>
<div class="line"><span class="lineno"> 1576</span>    }</div>
<div class="line"><span class="lineno"> 1577</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1578</span>    {</div>
<div class="line"><span class="lineno"> 1579</span>        *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_dst</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_src</a>;</div>
<div class="line"><span class="lineno"> 1580</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_src</a>;</div>
<div class="line"><span class="lineno"> 1581</span>    }</div>
<div class="line"><span class="lineno"> 1582</span>}</div>
<div class="ttc" id="acrypto_8c_html_add3d6a3c0d2952e5dfdd43ad262d46dc"><div class="ttname"><a href="crypto_8c.html#add3d6a3c0d2952e5dfdd43ad262d46dc">aescpy</a></div><div class="ttdeci">static void aescpy(unsigned char *key, const unsigned char *iv, unsigned char *dst, const unsigned char *src, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01472">crypto.c:1472</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l01321">NetConn_ReceivedMessage()</a>, and <a class="el" href="netconn_8c_source.html#l00834">NetConn_SendUnreliableMessage()</a>.</p>

</div>
</div>
<a id="af5609d4a90ca33175311e3fceec6ff6d" name="af5609d4a90ca33175311e3fceec6ff6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5609d4a90ca33175311e3fceec6ff6d">&#9670;&#160;</a></span>Crypto_FinishInstance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_FinishInstance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__t.html">crypto_t</a> *&#160;</td>
          <td class="paramname"><em>crypto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00558">558</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  559</span>{</div>
<div class="line"><span class="lineno">  560</span>    <span class="comment">// no check needed here (returned pointers are only used in prefilled fields)</span></div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordflow">if</span>(!crypto || !crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a>)</div>
<div class="line"><span class="lineno">  562</span>    {</div>
<div class="line"><span class="lineno">  563</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Passed an invalid crypto connect instance\n&quot;</span>);</div>
<div class="line"><span class="lineno">  564</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, 0, <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>));</div>
<div class="line"><span class="lineno">  565</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  566</span>    }</div>
<div class="line"><span class="lineno">  567</span>    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno">  568</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, crypto, <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>));</div>
<div class="line"><span class="lineno">  569</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(crypto, 0, <span class="keyword">sizeof</span>(*crypto));</div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  571</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l01631">NetConn_ConnectionEstablished()</a>, and <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="ae0a13832c196fc6cb7e25fd6f55aa489" name="ae0a13832c196fc6cb7e25fd6f55aa489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0a13832c196fc6cb7e25fd6f55aa489">&#9670;&#160;</a></span>Crypto_GetInfoResponseDataString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> * Crypto_GetInfoResponseDataString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01689">1689</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1690</span>{</div>
<div class="line"><span class="lineno"> 1691</span>    <a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>[0] = <span class="charliteral">&#39;0&#39;</span> + <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>;</div>
<div class="line"><span class="lineno"> 1692</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a>;</div>
<div class="line"><span class="lineno"> 1693</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l02706">NetConn_BuildStatusResponse()</a>.</p>

</div>
</div>
<a id="ada3befbe537d810f7aaf3d498ec6823c" name="ada3befbe537d810f7aaf3d498ec6823c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada3befbe537d810f7aaf3d498ec6823c">&#9670;&#160;</a></span>Crypto_HostKey_Clear_f()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_HostKey_Clear_f </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmd__state__t.html">cmd_state_t</a> *&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01428">1428</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1429</span>{</div>
<div class="line"><span class="lineno"> 1430</span>    <a class="code hl_struct" href="structlhnetaddress__t.html">lhnetaddress_t</a> addr;</div>
<div class="line"><span class="lineno"> 1431</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1434</span>    {</div>
<div class="line"><span class="lineno"> 1435</span>        <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;libd0_blind_id DLL not found, this command is inactive.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1436</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1437</span>    }</div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_function" href="cmd_8h.html#ab070abb7f2ebb842c8e67bef4e317314">Cmd_Argc</a>(cmd); ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1440</span>    {</div>
<div class="line"><span class="lineno"> 1441</span>        <a class="code hl_function" href="lhnet_8c.html#a5dbacd69a7b0e891167efa403d24be29">LHNETADDRESS_FromString</a>(&amp;addr, <a class="code hl_function" href="cmd_8h.html#ab49017bdcb3104823452a9ed7597aaf5">Cmd_Argv</a>(cmd, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), 26000);</div>
<div class="line"><span class="lineno"> 1442</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="crypto_8c.html#aba58302060be72fb4652709fe63dcabf">Crypto_ClearHostKey</a>(&amp;addr))</div>
<div class="line"><span class="lineno"> 1443</span>        {</div>
<div class="line"><span class="lineno"> 1444</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;cleared host key for %s\n&quot;</span>, <a class="code hl_function" href="cmd_8h.html#ab49017bdcb3104823452a9ed7597aaf5">Cmd_Argv</a>(cmd, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><span class="lineno"> 1445</span>        }</div>
<div class="line"><span class="lineno"> 1446</span>    }</div>
<div class="line"><span class="lineno"> 1447</span>}</div>
<div class="ttc" id="acmd_8h_html_ab070abb7f2ebb842c8e67bef4e317314"><div class="ttname"><a href="cmd_8h.html#ab070abb7f2ebb842c8e67bef4e317314">Cmd_Argc</a></div><div class="ttdeci">static int Cmd_Argc(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00249">cmd.h:249</a></div></div>
<div class="ttc" id="acmd_8h_html_ab49017bdcb3104823452a9ed7597aaf5"><div class="ttname"><a href="cmd_8h.html#ab49017bdcb3104823452a9ed7597aaf5">Cmd_Argv</a></div><div class="ttdeci">static const char * Cmd_Argv(cmd_state_t *cmd, int arg)</div><div class="ttdoc">Cmd_Argv(cmd, ) will return an empty string (not a NULL) if arg &gt; argc, so string operations are alwa...</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00254">cmd.h:254</a></div></div>
<div class="ttc" id="acrypto_8c_html_aba58302060be72fb4652709fe63dcabf"><div class="ttname"><a href="crypto_8c.html#aba58302060be72fb4652709fe63dcabf">Crypto_ClearHostKey</a></div><div class="ttdeci">static qbool Crypto_ClearHostKey(lhnetaddress_t *peeraddress)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00613">crypto.c:613</a></div></div>
<div class="ttc" id="alhnet_8c_html_a5dbacd69a7b0e891167efa403d24be29"><div class="ttname"><a href="lhnet_8c.html#a5dbacd69a7b0e891167efa403d24be29">LHNETADDRESS_FromString</a></div><div class="ttdeci">int LHNETADDRESS_FromString(lhnetaddress_t *vaddress, const char *string, int defaultport)</div><div class="ttdef"><b>Definition</b> <a href="lhnet_8c_source.html#l00204">lhnet.c:204</a></div></div>
<div class="ttc" id="astructlhnetaddress__t_html"><div class="ttname"><a href="structlhnetaddress__t.html">lhnetaddress_t</a></div><div class="ttdef"><b>Definition</b> <a href="lhnet_8h_source.html#l00019">lhnet.h:20</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>.</p>

</div>
</div>
<a id="a9fb12a2be57fc3c4742ea681e22e7708" name="a9fb12a2be57fc3c4742ea681e22e7708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb12a2be57fc3c4742ea681e22e7708">&#9670;&#160;</a></span>Crypto_HostKeys_f()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_HostKeys_f </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmd__state__t.html">cmd_state_t</a> *&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01403">1403</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1404</span>{</div>
<div class="line"><span class="lineno"> 1405</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1406</span>    <a class="code hl_struct" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>;</div>
<div class="line"><span class="lineno"> 1407</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[128];</div>
<div class="line"><span class="lineno"> 1408</span> </div>
<div class="line"><span class="lineno"> 1409</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1410</span>    {</div>
<div class="line"><span class="lineno"> 1411</span>        <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;libd0_blind_id DLL not found, this command is inactive.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1412</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1413</span>    }</div>
<div class="line"><span class="lineno"> 1414</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1415</span>    {</div>
<div class="line"><span class="lineno"> 1416</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = <a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;<a class="code hl_variable" href="structcrypto__storedhostkey__t.html#af62d58040b87c90c543af4dd18900036">next</a>)</div>
<div class="line"><span class="lineno"> 1417</span>        {</div>
<div class="line"><span class="lineno"> 1418</span>            <a class="code hl_function" href="lhnet_8c.html#a191c91d25271eed39a5eb76e2d8e5dde">LHNETADDRESS_ToString</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;addr, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), 1);</div>
<div class="line"><span class="lineno"> 1419</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;%d %s@%.*s %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1420</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;aeslevel,</div>
<div class="line"><span class="lineno"> 1421</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;idfp,</div>
<div class="line"><span class="lineno"> 1422</span>                    <a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;keyid],</div>
<div class="line"><span class="lineno"> 1423</span>                    <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>);</div>
<div class="line"><span class="lineno"> 1424</span>        }</div>
<div class="line"><span class="lineno"> 1425</span>    }</div>
<div class="line"><span class="lineno"> 1426</span>}</div>
<div class="ttc" id="acrypto_8c_html_a28bce26dd18684379882653e173b0188"><div class="ttname"><a href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a></div><div class="ttdeci">int crypto_keyfp_recommended_length</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00041">crypto.c:41</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>.</p>

</div>
</div>
<a id="ac8e05ee4f38d1d5a579abfe2980e370f" name="ac8e05ee4f38d1d5a579abfe2980e370f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e05ee4f38d1d5a579abfe2980e370f">&#9670;&#160;</a></span>Crypto_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01072">1072</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1073</span>{</div>
<div class="line"><span class="lineno"> 1074</span>    <a class="code hl_variable" href="crypto_8c.html#a473d64350b7902deaac13e21f96f11d8">cryptomempool</a> = <a class="code hl_define" href="zone_8h.html#a7da6ffdd01b3d31cb7c89e68fad87d0d">Mem_AllocPool</a>(<span class="stringliteral">&quot;crypto&quot;</span>, 0, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1075</span> </div>
<div class="line"><span class="lineno"> 1076</span>    <span class="keywordflow">if</span>(!<a class="code hl_function" href="crypto_8c.html#a6cc7bf287af177afa9b29d2e79ef0559">Crypto_OpenLibrary</a>())</div>
<div class="line"><span class="lineno"> 1077</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>    <a class="code hl_variable" href="crypto_8c.html#a690b3fafb6357836766ea72705753a4f">qd0_blind_id_setmallocfuncs</a>(<a class="code hl_function" href="crypto_8c.html#ad3e46b0be825db44980c41f18e4a27ea">Crypto_d0_malloc</a>, <a class="code hl_function" href="crypto_8c.html#a04461f04f135ed9168b3635769dfd3fb">Crypto_d0_free</a>);</div>
<div class="line"><span class="lineno"> 1080</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="thread_8h.html#a4af21639b1ace74ffbc47e953f7a0970">Thread_HasThreads</a>())</div>
<div class="line"><span class="lineno"> 1081</span>        <a class="code hl_variable" href="crypto_8c.html#afed7aa781c8545c1333c525f437aa7fc">qd0_blind_id_setmutexfuncs</a>(<a class="code hl_function" href="crypto_8c.html#aef1ead9aff323c67f6ea971213af9b87">Crypto_d0_createmutex</a>, <a class="code hl_function" href="crypto_8c.html#a2a246f3b70ce88542638a2e60c057921">Crypto_d0_destroymutex</a>, <a class="code hl_function" href="crypto_8c.html#a451c6225535919e74dc187635381c137">Crypto_d0_lockmutex</a>, <a class="code hl_function" href="crypto_8c.html#abf9cffdca970c75960fb23d63552825b">Crypto_d0_unlockmutex</a>);</div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a769580f1e63f2603aa90bb8986ac3ef3">qd0_blind_id_INITIALIZE</a>())</div>
<div class="line"><span class="lineno"> 1084</span>    {</div>
<div class="line"><span class="lineno"> 1085</span>        <a class="code hl_function" href="crypto_8c.html#aad54f544f3250410db6aff02f795c322">Crypto_Rijndael_CloseLibrary</a>();</div>
<div class="line"><span class="lineno"> 1086</span>        <a class="code hl_function" href="crypto_8c.html#acdd38a734f1d86b5075d6d6a82c71b7b">Crypto_CloseLibrary</a>();</div>
<div class="line"><span class="lineno"> 1087</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;libd0_blind_id initialization FAILED, cryptography support has been disabled\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1088</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1089</span>    }</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>    (<a class="code hl_function" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>) <a class="code hl_function" href="crypto_8c.html#aa266b054915a179b802f7177d59e58e9">Crypto_Rijndael_OpenLibrary</a>(); <span class="comment">// if this fails, it&#39;s uncritical</span></div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    <a class="code hl_function" href="crypto_8c.html#a4c96b96431f5c4f965baa36a690a851e">Crypto_InitHostKeys</a>();</div>
<div class="line"><span class="lineno"> 1094</span>}</div>
<div class="ttc" id="acrypto_8c_html_a04461f04f135ed9168b3635769dfd3fb"><div class="ttname"><a href="crypto_8c.html#a04461f04f135ed9168b3635769dfd3fb">Crypto_d0_free</a></div><div class="ttdeci">static void Crypto_d0_free(void *p)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01015">crypto.c:1015</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2a246f3b70ce88542638a2e60c057921"><div class="ttname"><a href="crypto_8c.html#a2a246f3b70ce88542638a2e60c057921">Crypto_d0_destroymutex</a></div><div class="ttdeci">static void Crypto_d0_destroymutex(void *m)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01025">crypto.c:1025</a></div></div>
<div class="ttc" id="acrypto_8c_html_a451c6225535919e74dc187635381c137"><div class="ttname"><a href="crypto_8c.html#a451c6225535919e74dc187635381c137">Crypto_d0_lockmutex</a></div><div class="ttdeci">static int Crypto_d0_lockmutex(void *m)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01030">crypto.c:1030</a></div></div>
<div class="ttc" id="acrypto_8c_html_a4c96b96431f5c4f965baa36a690a851e"><div class="ttname"><a href="crypto_8c.html#a4c96b96431f5c4f965baa36a690a851e">Crypto_InitHostKeys</a></div><div class="ttdeci">static void Crypto_InitHostKeys(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00591">crypto.c:591</a></div></div>
<div class="ttc" id="acrypto_8c_html_a690b3fafb6357836766ea72705753a4f"><div class="ttname"><a href="crypto_8c.html#a690b3fafb6357836766ea72705753a4f">qd0_blind_id_setmallocfuncs</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_setmallocfuncs)(d0_malloc_t *m, d0_free_t *f)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00233">crypto.c:233</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6cc7bf287af177afa9b29d2e79ef0559"><div class="ttname"><a href="crypto_8c.html#a6cc7bf287af177afa9b29d2e79ef0559">Crypto_OpenLibrary</a></div><div class="ttdeci">static qbool Crypto_OpenLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00283">crypto.c:283</a></div></div>
<div class="ttc" id="acrypto_8c_html_a769580f1e63f2603aa90bb8986ac3ef3"><div class="ttname"><a href="crypto_8c.html#a769580f1e63f2603aa90bb8986ac3ef3">qd0_blind_id_INITIALIZE</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_INITIALIZE)(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00228">crypto.c:228</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa266b054915a179b802f7177d59e58e9"><div class="ttname"><a href="crypto_8c.html#aa266b054915a179b802f7177d59e58e9">Crypto_Rijndael_OpenLibrary</a></div><div class="ttdeci">static qbool Crypto_Rijndael_OpenLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00352">crypto.c:352</a></div></div>
<div class="ttc" id="acrypto_8c_html_aad54f544f3250410db6aff02f795c322"><div class="ttname"><a href="crypto_8c.html#aad54f544f3250410db6aff02f795c322">Crypto_Rijndael_CloseLibrary</a></div><div class="ttdeci">static void Crypto_Rijndael_CloseLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00375">crypto.c:375</a></div></div>
<div class="ttc" id="acrypto_8c_html_abf9cffdca970c75960fb23d63552825b"><div class="ttname"><a href="crypto_8c.html#abf9cffdca970c75960fb23d63552825b">Crypto_d0_unlockmutex</a></div><div class="ttdeci">static int Crypto_d0_unlockmutex(void *m)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01035">crypto.c:1035</a></div></div>
<div class="ttc" id="acrypto_8c_html_acdd38a734f1d86b5075d6d6a82c71b7b"><div class="ttname"><a href="crypto_8c.html#acdd38a734f1d86b5075d6d6a82c71b7b">Crypto_CloseLibrary</a></div><div class="ttdeci">static void Crypto_CloseLibrary(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00306">crypto.c:306</a></div></div>
<div class="ttc" id="acrypto_8c_html_ad3e46b0be825db44980c41f18e4a27ea"><div class="ttname"><a href="crypto_8c.html#ad3e46b0be825db44980c41f18e4a27ea">Crypto_d0_malloc</a></div><div class="ttdeci">static void * Crypto_d0_malloc(size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01010">crypto.c:1010</a></div></div>
<div class="ttc" id="acrypto_8c_html_aef1ead9aff323c67f6ea971213af9b87"><div class="ttname"><a href="crypto_8c.html#aef1ead9aff323c67f6ea971213af9b87">Crypto_d0_createmutex</a></div><div class="ttdeci">static void * Crypto_d0_createmutex(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01020">crypto.c:1020</a></div></div>
<div class="ttc" id="acrypto_8c_html_afed7aa781c8545c1333c525f437aa7fc"><div class="ttname"><a href="crypto_8c.html#afed7aa781c8545c1333c525f437aa7fc">qd0_blind_id_setmutexfuncs</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_setmutexfuncs)(d0_createmutex_t *c, d0_destroymutex_t *d, d0_lockmutex_t *l, d0_unlockmutex_t *u)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00234">crypto.c:234</a></div></div>
<div class="ttc" id="aglquake_8h_html_afa45fc0640b31002c1792c59eb062c59"><div class="ttname"><a href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a></div><div class="ttdeci">void(GLAPIENTRY *qglActiveTexture)(GLenum texture)</div></div>
<div class="ttc" id="athread_8h_html_a4af21639b1ace74ffbc47e953f7a0970"><div class="ttname"><a href="thread_8h.html#a4af21639b1ace74ffbc47e953f7a0970">Thread_HasThreads</a></div><div class="ttdeci">qbool Thread_HasThreads(void)</div><div class="ttdef"><b>Definition</b> <a href="thread__null_8c_source.html#l00013">thread_null.c:13</a></div></div>
<div class="ttc" id="azone_8h_html_a7da6ffdd01b3d31cb7c89e68fad87d0d"><div class="ttname"><a href="zone_8h.html#a7da6ffdd01b3d31cb7c89e68fad87d0d">Mem_AllocPool</a></div><div class="ttdeci">#define Mem_AllocPool(name, flags, parent)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00104">zone.h:104</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="host_8c_source.html#l00374">Host_Init()</a>.</p>

</div>
</div>
<a id="a2dc22d3a48652b22d43fb40e750e4cd4" name="a2dc22d3a48652b22d43fb40e750e4cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc22d3a48652b22d43fb40e750e4cd4">&#9670;&#160;</a></span>Crypto_Init_Commands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Init_Commands </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01449">1449</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1450</span>{</div>
<div class="line"><span class="lineno"> 1451</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1452</span>    {</div>
<div class="line"><span class="lineno"> 1453</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_reload&quot;</span>, <a class="code hl_function" href="crypto_8c.html#a2face099d8db579f04009cc115b4b7b2">Crypto_Reload_f</a>, <span class="stringliteral">&quot;reloads cryptographic keys&quot;</span>);</div>
<div class="line"><span class="lineno"> 1454</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_keygen&quot;</span>, <a class="code hl_function" href="crypto_8c.html#ad3f9b2a112d3766361cf97490ac6fb0e">Crypto_KeyGen_f</a>, <span class="stringliteral">&quot;generates and saves a cryptographic key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1455</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_keys&quot;</span>, <a class="code hl_function" href="crypto_8c.html#ada60652b956c044bd851cbc63d2b6b2c">Crypto_Keys_f</a>, <span class="stringliteral">&quot;lists the loaded keys&quot;</span>);</div>
<div class="line"><span class="lineno"> 1456</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_hostkeys&quot;</span>, <a class="code hl_function" href="crypto_8c.html#a9fb12a2be57fc3c4742ea681e22e7708">Crypto_HostKeys_f</a>, <span class="stringliteral">&quot;lists the cached host keys&quot;</span>);</div>
<div class="line"><span class="lineno"> 1457</span>        <a class="code hl_function" href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a>(<a class="code hl_define" href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a>, <span class="stringliteral">&quot;crypto_hostkey_clear&quot;</span>, <a class="code hl_function" href="crypto_8c.html#ada3befbe537d810f7aaf3d498ec6823c">Crypto_HostKey_Clear_f</a>, <span class="stringliteral">&quot;clears a cached host key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>        <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a6f3d29a8d2e8a24dc51d47cba14aef9e">crypto_developer</a>);</div>
<div class="line"><span class="lineno"> 1460</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>)</div>
<div class="line"><span class="lineno"> 1461</span>            <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>);</div>
<div class="line"><span class="lineno"> 1462</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1463</span>            <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> = 0; <span class="comment">// make sure</span></div>
<div class="line"><span class="lineno"> 1464</span>        <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a>);</div>
<div class="line"><span class="lineno"> 1465</span>        <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>);</div>
<div class="line"><span class="lineno"> 1466</span>        <a class="code hl_function" href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a>);</div>
<div class="line"><span class="lineno"> 1467</span>    }</div>
<div class="line"><span class="lineno"> 1468</span>}</div>
<div class="ttc" id="acmd_8c_html_a86fa905462db75436af48f27298204e5"><div class="ttname"><a href="cmd_8c.html#a86fa905462db75436af48f27298204e5">Cmd_AddCommand</a></div><div class="ttdeci">void Cmd_AddCommand(unsigned flags, const char *cmd_name, xcommand_t function, const char *description)</div><div class="ttdoc">called by the init functions of other parts of the program to register commands and functions to call...</div><div class="ttdef"><b>Definition</b> <a href="cmd_8c_source.html#l01643">cmd.c:1643</a></div></div>
<div class="ttc" id="acmd_8h_html_a28392de86e1ad57dd3fa7870a23367f2"><div class="ttname"><a href="cmd_8h.html#a28392de86e1ad57dd3fa7870a23367f2">CF_SHARED</a></div><div class="ttdeci">#define CF_SHARED</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00067">cmd.h:67</a></div></div>
<div class="ttc" id="acrypto_8c_html_a2face099d8db579f04009cc115b4b7b2"><div class="ttname"><a href="crypto_8c.html#a2face099d8db579f04009cc115b4b7b2">Crypto_Reload_f</a></div><div class="ttdeci">static void Crypto_Reload_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01373">crypto.c:1373</a></div></div>
<div class="ttc" id="acrypto_8c_html_a60a6b08ba933d05ae0ba07ba429fe03e"><div class="ttname"><a href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a></div><div class="ttdeci">cvar_t crypto_servercpupercent</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00033">crypto.c:33</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6f3d29a8d2e8a24dc51d47cba14aef9e"><div class="ttname"><a href="crypto_8c.html#a6f3d29a8d2e8a24dc51d47cba14aef9e">crypto_developer</a></div><div class="ttdeci">cvar_t crypto_developer</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00030">crypto.c:30</a></div></div>
<div class="ttc" id="acrypto_8c_html_a802583bf599735ca3f90741d55954864"><div class="ttname"><a href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a></div><div class="ttdeci">cvar_t crypto_servercpumaxtime</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00034">crypto.c:34</a></div></div>
<div class="ttc" id="acrypto_8c_html_a90ed817e2c4e40c2d34af9d37e7edd64"><div class="ttname"><a href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a></div><div class="ttdeci">cvar_t crypto_servercpudebug</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00035">crypto.c:35</a></div></div>
<div class="ttc" id="acrypto_8c_html_a9fb12a2be57fc3c4742ea681e22e7708"><div class="ttname"><a href="crypto_8c.html#a9fb12a2be57fc3c4742ea681e22e7708">Crypto_HostKeys_f</a></div><div class="ttdeci">static void Crypto_HostKeys_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01403">crypto.c:1403</a></div></div>
<div class="ttc" id="acrypto_8c_html_ad3f9b2a112d3766361cf97490ac6fb0e"><div class="ttname"><a href="crypto_8c.html#ad3f9b2a112d3766361cf97490ac6fb0e">Crypto_KeyGen_f</a></div><div class="ttdeci">static void Crypto_KeyGen_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01217">crypto.c:1217</a></div></div>
<div class="ttc" id="acrypto_8c_html_ada3befbe537d810f7aaf3d498ec6823c"><div class="ttname"><a href="crypto_8c.html#ada3befbe537d810f7aaf3d498ec6823c">Crypto_HostKey_Clear_f</a></div><div class="ttdeci">static void Crypto_HostKey_Clear_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01428">crypto.c:1428</a></div></div>
<div class="ttc" id="acrypto_8c_html_ada60652b956c044bd851cbc63d2b6b2c"><div class="ttname"><a href="crypto_8c.html#ada60652b956c044bd851cbc63d2b6b2c">Crypto_Keys_f</a></div><div class="ttdeci">static void Crypto_Keys_f(cmd_state_t *cmd)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01380">crypto.c:1380</a></div></div>
<div class="ttc" id="acvar_8c_html_a9bd27026ed325ffe5276549c11c7379d"><div class="ttname"><a href="cvar_8c.html#a9bd27026ed325ffe5276549c11c7379d">Cvar_RegisterVariable</a></div><div class="ttdeci">void Cvar_RegisterVariable(cvar_t *variable)</div><div class="ttdoc">registers a cvar that already has the name, string, and optionally the archive elements set.</div><div class="ttdef"><b>Definition</b> <a href="cvar_8c_source.html#l00599">cvar.c:599</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="host_8c_source.html#l00374">Host_Init()</a>.</p>

</div>
</div>
<a id="a4c96b96431f5c4f965baa36a690a851e" name="a4c96b96431f5c4f965baa36a690a851e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c96b96431f5c4f965baa36a690a851e">&#9670;&#160;</a></span>Crypto_InitHostKeys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_InitHostKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00591">591</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  592</span>{</div>
<div class="line"><span class="lineno">  593</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  595</span>        <a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  596</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="ad3f9b2a112d3766361cf97490ac6fb0e" name="ad3f9b2a112d3766361cf97490ac6fb0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3f9b2a112d3766361cf97490ac6fb0e">&#9670;&#160;</a></span>Crypto_KeyGen_f()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_KeyGen_f </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmd__state__t.html">cmd_state_t</a> *&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01217">1217</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1218</span>{</div>
<div class="line"><span class="lineno"> 1219</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1220</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *p[1];</div>
<div class="line"><span class="lineno"> 1221</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[1];</div>
<div class="line"><span class="lineno"> 1222</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[8192];</div>
<div class="line"><span class="lineno"> 1223</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> buf2[8192];</div>
<div class="line"><span class="lineno"> 1224</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2size</a>;</div>
<div class="line"><span class="lineno"> 1225</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2l</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2pos</a>;</div>
<div class="line"><span class="lineno"> 1226</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno"> 1227</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a>;</div>
<div class="line"><span class="lineno"> 1228</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">qfile_t</a> *<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1231</span>    {</div>
<div class="line"><span class="lineno"> 1232</span>        <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;libd0_blind_id DLL not found, this command is inactive.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1233</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1234</span>    }</div>
<div class="line"><span class="lineno"> 1235</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="cmd_8h.html#ab070abb7f2ebb842c8e67bef4e317314">Cmd_Argc</a>(cmd) != 3)</div>
<div class="line"><span class="lineno"> 1236</span>    {</div>
<div class="line"><span class="lineno"> 1237</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;usage:\n%s id url\n&quot;</span>, <a class="code hl_function" href="cmd_8h.html#ab49017bdcb3104823452a9ed7597aaf5">Cmd_Argv</a>(cmd, 0));</div>
<div class="line"><span class="lineno"> 1238</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1239</span>    }</div>
<div class="line"><span class="lineno"> 1240</span>    <a class="code hl_define" href="server_8h.html#a451b91ad4ba3a1d0fbd9f3fddf0d6f84">SV_LockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1241</span>    <a class="code hl_function" href="crypto_8c.html#a1e6cc26fc4d71eacae07453774cf06de">Crypto_LoadKeys</a>();</div>
<div class="line"><span class="lineno"> 1242</span>    <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_function" href="cmd_8h.html#ab49017bdcb3104823452a9ed7597aaf5">Cmd_Argv</a>(cmd, 1));</div>
<div class="line"><span class="lineno"> 1243</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 1244</span>    {</div>
<div class="line"><span class="lineno"> 1245</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;there is no public key %d\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><span class="lineno"> 1246</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1247</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1248</span>    }</div>
<div class="line"><span class="lineno"> 1249</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 1250</span>    {</div>
<div class="line"><span class="lineno"> 1251</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;there is already a keygen run on the way\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1252</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1253</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1254</span>    }</div>
<div class="line"><span class="lineno"> 1255</span>    <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>    <span class="comment">// how to START the keygenning...</span></div>
<div class="line"><span class="lineno"> 1258</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>])</div>
<div class="line"><span class="lineno"> 1259</span>    {</div>
<div class="line"><span class="lineno"> 1260</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>])</div>
<div class="line"><span class="lineno"> 1261</span>        {</div>
<div class="line"><span class="lineno"> 1262</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;there is already a signed private key for %d\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><span class="lineno"> 1263</span>            <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1264</span>            <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1265</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1266</span>        }</div>
<div class="line"><span class="lineno"> 1267</span>        <span class="comment">// if we get here, we only need a signature, no new keygen run needed</span></div>
<div class="line"><span class="lineno"> 1268</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Only need a signature for an existing key...\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1269</span>    }</div>
<div class="line"><span class="lineno"> 1270</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1271</span>    {</div>
<div class="line"><span class="lineno"> 1272</span>        <span class="comment">// we also need a new ID itself</span></div>
<div class="line"><span class="lineno"> 1273</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a879fdc43d8e4a297a1556f17504bf6e8">qd0_blind_id_generate_private_id_start</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>]))</div>
<div class="line"><span class="lineno"> 1274</span>        {</div>
<div class="line"><span class="lineno"> 1275</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_start failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1276</span>            <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1277</span>            <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1278</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1279</span>        }</div>
<div class="line"><span class="lineno"> 1280</span>        <span class="comment">// verify the key we just got (just in case)</span></div>
<div class="line"><span class="lineno"> 1281</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a5d43fdd72f73796e0dbd984eae9347f4">qd0_blind_id_verify_private_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>]))</div>
<div class="line"><span class="lineno"> 1282</span>        {</div>
<div class="line"><span class="lineno"> 1283</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_verify_private_id failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1284</span>            <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1285</span>            <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1286</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1287</span>        }</div>
<div class="line"><span class="lineno"> 1288</span>        <span class="comment">// we have a valid key now!</span></div>
<div class="line"><span class="lineno"> 1289</span>        <span class="comment">// make the rest of crypto.c know that</span></div>
<div class="line"><span class="lineno"> 1290</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a> = <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>;</div>
<div class="line"><span class="lineno"> 1291</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>], <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>], &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a>)) <span class="comment">// keeps final NUL</span></div>
<div class="line"><span class="lineno"> 1292</span>        {</div>
<div class="line"><span class="lineno"> 1293</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Generated private ID key_%d.d0pk (public key fingerprint: %s)\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>]);</div>
<div class="line"><span class="lineno"> 1294</span>            <a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1295</span>            <a class="code hl_define" href="common_8h.html#a48b55a981b8eb9cbcf455b613f62e6b3">dp_strlcat</a>(<a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot; %s@%s&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>], <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>]), <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>));</div>
<div class="line"><span class="lineno"> 1296</span>            <a class="code hl_variable" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a> = <a class="code hl_variable" href="crypto_8c.html#a63426ba3da78d70b38153267dbe74ccc">crypto_idstring_buf</a>;</div>
<div class="line"><span class="lineno"> 1297</span>            <a class="code hl_function" href="crypto_8c.html#af4ea4fbb85d42f0fe445c6853deb27e3">Crypto_BuildChallengeAppend</a>();</div>
<div class="line"><span class="lineno"> 1298</span>        }</div>
<div class="line"><span class="lineno"> 1299</span>        <span class="comment">// write the key to disk</span></div>
<div class="line"><span class="lineno"> 1300</span>        p[0] = <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>;</div>
<div class="line"><span class="lineno"> 1301</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0] = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>);</div>
<div class="line"><span class="lineno"> 1302</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a3e2a076dba69c5847aab34bf0bf54b54">qd0_blind_id_write_private_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>], <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0]))</div>
<div class="line"><span class="lineno"> 1303</span>        {</div>
<div class="line"><span class="lineno"> 1304</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_write_private_id failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1305</span>            <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1306</span>            <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1307</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1308</span>        }</div>
<div class="line"><span class="lineno"> 1309</span>        <span class="keywordflow">if</span>(!(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2size</a> = <a class="code hl_function" href="crypto_8c.html#a858dccc118582ddc67008845ede2a273">Crypto_UnParsePack</a>(buf2, <span class="keyword">sizeof</span>(buf2), <a class="code hl_define" href="crypto_8c.html#a6cfb14fb175de61c8f50eaf4ae8be02a">FOURCC_D0SI</a>, p, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>, 1)))</div>
<div class="line"><span class="lineno"> 1310</span>        {</div>
<div class="line"><span class="lineno"> 1311</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_UnParsePack failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1312</span>            <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1313</span>            <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1314</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1315</span>        }</div>
<div class="line"><span class="lineno"> 1316</span> </div>
<div class="line"><span class="lineno"> 1317</span>        <a class="code hl_function" href="fs_8c.html#acf6a6a671fddee50dbb3b0b1ec5d07ad">FS_CreatePath</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%skey_%d.d0si%s&quot;</span>, *<a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> ? <a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> : <a class="code hl_variable" href="fs_8c.html#ad14136292432bbbe329d4ab28ea04b37">fs_basedir</a>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="glquake_8h.html#ae79dfeea357422bd20dbcaa2afe88ac6">string</a>));</div>
<div class="line"><span class="lineno"> 1318</span>        <a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a> = <a class="code hl_function" href="fs_8c.html#a5098aecad23c311750ae649088f2d96d">FS_SysOpen</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%skey_%d.d0si%s&quot;</span>, *<a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> ? <a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> : <a class="code hl_variable" href="fs_8c.html#ad14136292432bbbe329d4ab28ea04b37">fs_basedir</a>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="glquake_8h.html#ae79dfeea357422bd20dbcaa2afe88ac6">string</a>), <span class="stringliteral">&quot;wb&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">false</a>);</div>
<div class="line"><span class="lineno"> 1319</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>)</div>
<div class="line"><span class="lineno"> 1320</span>        {</div>
<div class="line"><span class="lineno"> 1321</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Cannot open key_%d.d0si%s\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>);</div>
<div class="line"><span class="lineno"> 1322</span>            <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1323</span>            <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1324</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1325</span>        }</div>
<div class="line"><span class="lineno"> 1326</span>        <a class="code hl_function" href="fs_8c.html#a2ef891979f8e7a5158ab1ade82cd733f">FS_Write</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, buf2, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2size</a>);</div>
<div class="line"><span class="lineno"> 1327</span>        <a class="code hl_function" href="fs_8c.html#abcf26e98f08b7bbcc5645486294ebb5c">FS_Close</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>);</div>
<div class="line"><span class="lineno"> 1328</span> </div>
<div class="line"><span class="lineno"> 1329</span>        <a class="code hl_function" href="crypto_8c.html#ac8da1c183634a38674c81c765b2c8e42">Crypto_SavePubKeyTextFile</a>(<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>);</div>
<div class="line"><span class="lineno"> 1330</span> </div>
<div class="line"><span class="lineno"> 1331</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Saved unsigned key to key_%d.d0si%s\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>);</div>
<div class="line"><span class="lineno"> 1332</span>    }</div>
<div class="line"><span class="lineno"> 1333</span>    p[0] = <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>;</div>
<div class="line"><span class="lineno"> 1334</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0] = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>);</div>
<div class="line"><span class="lineno"> 1335</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a1142ed9b4b3a54d428fd4b3a046fdccf">qd0_blind_id_generate_private_id_request</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>], <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0]))</div>
<div class="line"><span class="lineno"> 1336</span>    {</div>
<div class="line"><span class="lineno"> 1337</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_generate_private_id_request failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1338</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1339</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1340</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1341</span>    }</div>
<div class="line"><span class="lineno"> 1342</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2pos</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strlen</a>(<a class="code hl_function" href="cmd_8h.html#ab49017bdcb3104823452a9ed7597aaf5">Cmd_Argv</a>(cmd, 2));</div>
<div class="line"><span class="lineno"> 1343</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(buf2, <a class="code hl_function" href="cmd_8h.html#ab49017bdcb3104823452a9ed7597aaf5">Cmd_Argv</a>(cmd, 2), <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2pos</a>);</div>
<div class="line"><span class="lineno"> 1344</span>    <span class="keywordflow">if</span>(!(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2l</a> = <a class="code hl_function" href="crypto_8c.html#a858dccc118582ddc67008845ede2a273">Crypto_UnParsePack</a>(buf2 + <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2pos</a>, <span class="keyword">sizeof</span>(buf2) - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2pos</a> - 1, <a class="code hl_define" href="crypto_8c.html#adfd3a4ea879edc599acb8ee0ff614d8e">FOURCC_D0IQ</a>, p, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>, 1)))</div>
<div class="line"><span class="lineno"> 1345</span>    {</div>
<div class="line"><span class="lineno"> 1346</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_UnParsePack failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1347</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1348</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1349</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1350</span>    }</div>
<div class="line"><span class="lineno"> 1351</span>    <span class="keywordflow">if</span>(!(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2l</a> = <a class="code hl_function" href="common_8c.html#aeb31ce50fd6041b40d17d048b70cb5b5">base64_encode</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) (buf2 + <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2pos</a>), <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2l</a>, <span class="keyword">sizeof</span>(buf2) - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2pos</a> - 1)))</div>
<div class="line"><span class="lineno"> 1352</span>    {</div>
<div class="line"><span class="lineno"> 1353</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;base64_encode failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1354</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1355</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1356</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1357</span>    }</div>
<div class="line"><span class="lineno"> 1358</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2l</a> += <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2pos</a>;</div>
<div class="line"><span class="lineno"> 1359</span>    buf2[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2l</a>] = 0;</div>
<div class="line"><span class="lineno"> 1360</span>    <span class="keywordflow">if</span>(!<a class="code hl_function" href="libcurl_8c.html#a9d3f1d33dfa7bf5a737895b9aaab2a80">Curl_Begin_ToMemory</a>(buf2, 0, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="crypto_8c.html#acef24f9adaa96877f886d9e102044538">keygen_buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#acef24f9adaa96877f886d9e102044538">keygen_buf</a>), <a class="code hl_function" href="crypto_8c.html#a974940e63001e09ee6d4b48d0e4de656">Crypto_KeyGen_Finished</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))</div>
<div class="line"><span class="lineno"> 1361</span>    {</div>
<div class="line"><span class="lineno"> 1362</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;curl failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1363</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1364</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1365</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1366</span>    }</div>
<div class="line"><span class="lineno"> 1367</span>    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Signature generation in progress...\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1368</span>    <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1369</span>}</div>
<div class="ttc" id="acommon_8c_html_aeb31ce50fd6041b40d17d048b70cb5b5"><div class="ttname"><a href="common_8c.html#aeb31ce50fd6041b40d17d048b70cb5b5">base64_encode</a></div><div class="ttdeci">size_t base64_encode(unsigned char *buf, size_t buflen, size_t outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="common_8c_source.html#l01487">common.c:1487</a></div></div>
<div class="ttc" id="acrypto_8c_html_a1142ed9b4b3a54d428fd4b3a046fdccf"><div class="ttname"><a href="crypto_8c.html#a1142ed9b4b3a54d428fd4b3a046fdccf">qd0_blind_id_generate_private_id_request</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_generate_private_id_request)(d0_blind_id_t *ctx, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00213">crypto.c:213</a></div></div>
<div class="ttc" id="acrypto_8c_html_a1e6cc26fc4d71eacae07453774cf06de"><div class="ttname"><a href="crypto_8c.html#a1e6cc26fc4d71eacae07453774cf06de">Crypto_LoadKeys</a></div><div class="ttdeci">void Crypto_LoadKeys(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00855">crypto.c:855</a></div></div>
<div class="ttc" id="acrypto_8c_html_a3e2a076dba69c5847aab34bf0bf54b54"><div class="ttname"><a href="crypto_8c.html#a3e2a076dba69c5847aab34bf0bf54b54">qd0_blind_id_write_private_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_write_private_id)(const d0_blind_id_t *ctx, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00220">crypto.c:220</a></div></div>
<div class="ttc" id="acrypto_8c_html_a5d43fdd72f73796e0dbd984eae9347f4"><div class="ttname"><a href="crypto_8c.html#a5d43fdd72f73796e0dbd984eae9347f4">qd0_blind_id_verify_private_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_verify_private_id)(const d0_blind_id_t *ctx)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00236">crypto.c:236</a></div></div>
<div class="ttc" id="acrypto_8c_html_a858dccc118582ddc67008845ede2a273"><div class="ttname"><a href="crypto_8c.html#a858dccc118582ddc67008845ede2a273">Crypto_UnParsePack</a></div><div class="ttdeci">static size_t Crypto_UnParsePack(char *buf, size_t len, unsigned long header, const char *const *lumps, const size_t *lumpsize, size_t nlumps)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00103">crypto.c:103</a></div></div>
<div class="ttc" id="acrypto_8c_html_a879fdc43d8e4a297a1556f17504bf6e8"><div class="ttname"><a href="crypto_8c.html#a879fdc43d8e4a297a1556f17504bf6e8">qd0_blind_id_generate_private_id_start</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_generate_private_id_start)(d0_blind_id_t *ctx)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00212">crypto.c:212</a></div></div>
<div class="ttc" id="acrypto_8c_html_a974940e63001e09ee6d4b48d0e4de656"><div class="ttname"><a href="crypto_8c.html#a974940e63001e09ee6d4b48d0e4de656">Crypto_KeyGen_Finished</a></div><div class="ttdeci">static void Crypto_KeyGen_Finished(int code, size_t length_received, unsigned char *buffer, void *cbdata)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01105">crypto.c:1105</a></div></div>
<div class="ttc" id="acrypto_8c_html_ac8da1c183634a38674c81c765b2c8e42"><div class="ttname"><a href="crypto_8c.html#ac8da1c183634a38674c81c765b2c8e42">Crypto_SavePubKeyTextFile</a></div><div class="ttdeci">static qbool Crypto_SavePubKeyTextFile(int i)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00814">crypto.c:814</a></div></div>
<div class="ttc" id="acrypto_8c_html_acef24f9adaa96877f886d9e102044538"><div class="ttname"><a href="crypto_8c.html#acef24f9adaa96877f886d9e102044538">keygen_buf</a></div><div class="ttdeci">static char keygen_buf[8192]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00491">crypto.c:491</a></div></div>
<div class="ttc" id="acrypto_8c_html_adfd3a4ea879edc599acb8ee0ff614d8e"><div class="ttname"><a href="crypto_8c.html#adfd3a4ea879edc599acb8ee0ff614d8e">FOURCC_D0IQ</a></div><div class="ttdeci">#define FOURCC_D0IQ</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00054">crypto.c:54</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae660e3db5e569c5c606531a62f889148"><div class="ttname"><a href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a></div><div class="ttdeci">static int keygen_i</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00490">crypto.c:490</a></div></div>
<div class="ttc" id="acrypto_8c_html_af4ea4fbb85d42f0fe445c6853deb27e3"><div class="ttname"><a href="crypto_8c.html#af4ea4fbb85d42f0fe445c6853deb27e3">Crypto_BuildChallengeAppend</a></div><div class="ttdeci">static void Crypto_BuildChallengeAppend(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00785">crypto.c:785</a></div></div>
<div class="ttc" id="afs_8c_html_a2ef891979f8e7a5158ab1ade82cd733f"><div class="ttname"><a href="fs_8c.html#a2ef891979f8e7a5158ab1ade82cd733f">FS_Write</a></div><div class="ttdeci">fs_offset_t FS_Write(qfile_t *file, const void *data, size_t datasize)</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l03015">fs.c:3015</a></div></div>
<div class="ttc" id="afs_8c_html_a5098aecad23c311750ae649088f2d96d"><div class="ttname"><a href="fs_8c.html#a5098aecad23c311750ae649088f2d96d">FS_SysOpen</a></div><div class="ttdeci">qfile_t * FS_SysOpen(const char *filepath, const char *mode, qbool nonblocking)</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l02480">fs.c:2480</a></div></div>
<div class="ttc" id="afs_8c_html_abcf26e98f08b7bbcc5645486294ebb5c"><div class="ttname"><a href="fs_8c.html#abcf26e98f08b7bbcc5645486294ebb5c">FS_Close</a></div><div class="ttdeci">int FS_Close(qfile_t *file)</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l02966">fs.c:2966</a></div></div>
<div class="ttc" id="afs_8c_html_acf6a6a671fddee50dbb3b0b1ec5d07ad"><div class="ttname"><a href="fs_8c.html#acf6a6a671fddee50dbb3b0b1ec5d07ad">FS_CreatePath</a></div><div class="ttdeci">void FS_CreatePath(char *path)</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l01035">fs.c:1035</a></div></div>
<div class="ttc" id="afs_8c_html_ad14136292432bbbe329d4ab28ea04b37"><div class="ttname"><a href="fs_8c.html#ad14136292432bbbe329d4ab28ea04b37">fs_basedir</a></div><div class="ttdeci">char fs_basedir[MAX_OSPATH]</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l00438">fs.c:438</a></div></div>
<div class="ttc" id="afs_8c_html_afffc20194b866aa9ea07bed3f2c5a30d"><div class="ttname"><a href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a></div><div class="ttdeci">char fs_userdir[MAX_OSPATH]</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l00436">fs.c:436</a></div></div>
<div class="ttc" id="aglquake_8h_html_ae79dfeea357422bd20dbcaa2afe88ac6"><div class="ttname"><a href="glquake_8h.html#ae79dfeea357422bd20dbcaa2afe88ac6">string</a></div><div class="ttdeci">GLsizei const GLchar ** string</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00727">glquake.h:727</a></div></div>
<div class="ttc" id="ahost_8c_html_a0ddc5c0baccb97e671b135bcf8d4e257"><div class="ttname"><a href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a></div><div class="ttdeci">cvar_t sessionid</div><div class="ttdef"><b>Definition</b> <a href="host_8c_source.html#l00058">host.c:58</a></div></div>
<div class="ttc" id="alibcurl_8c_html_a9d3f1d33dfa7bf5a737895b9aaab2a80"><div class="ttname"><a href="libcurl_8c.html#a9d3f1d33dfa7bf5a737895b9aaab2a80">Curl_Begin_ToMemory</a></div><div class="ttdeci">qbool Curl_Begin_ToMemory(const char *URL, double maxspeed, unsigned char *buf, size_t bufsize, curl_callback_t callback, void *cbdata)</div><div class="ttdef"><b>Definition</b> <a href="libcurl_8c_source.html#l01117">libcurl.c:1117</a></div></div>
<div class="ttc" id="aserver_8h_html_a451b91ad4ba3a1d0fbd9f3fddf0d6f84"><div class="ttname"><a href="server_8h.html#a451b91ad4ba3a1d0fbd9f3fddf0d6f84">SV_LockThreadMutex</a></div><div class="ttdeci">#define SV_LockThreadMutex()</div><div class="ttdef"><b>Definition</b> <a href="server_8h_source.html#l00611">server.h:611</a></div></div>
<div class="ttc" id="aserver_8h_html_aaab8b61921b35b19229b091879106e12"><div class="ttname"><a href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a></div><div class="ttdeci">#define SV_UnlockThreadMutex()</div><div class="ttdef"><b>Definition</b> <a href="server_8h_source.html#l00612">server.h:612</a></div></div>
<div class="ttc" id="ashader__glsl_8h_html_a731feb93da8dc28ee53e37b43daabd06"><div class="ttname"><a href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a></div><div class="ttdeci">float f</div><div class="ttdef"><b>Definition</b> <a href="shader__glsl_8h_source.html#l00586">shader_glsl.h:586</a></div></div>
<div class="ttc" id="astructcvar__t_html_aa8b859b9332810d238c09b51ea54a2f4"><div class="ttname"><a href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">cvar_t::string</a></div><div class="ttdeci">const char * string</div><div class="ttdef"><b>Definition</b> <a href="cvar_8h_source.html#l00071">cvar.h:71</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>.</p>

</div>
</div>
<a id="a974940e63001e09ee6d4b48d0e4de656" name="a974940e63001e09ee6d4b48d0e4de656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a974940e63001e09ee6d4b48d0e4de656">&#9670;&#160;</a></span>Crypto_KeyGen_Finished()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_KeyGen_Finished </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>length_received</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>cbdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01105">1105</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1106</span>{</div>
<div class="line"><span class="lineno"> 1107</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *p[1];</div>
<div class="line"><span class="lineno"> 1108</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[1];</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[8192];</div>
<div class="line"><span class="lineno"> 1110</span>    <span class="keyword">static</span> <span class="keywordtype">char</span> buf2[8192];</div>
<div class="line"><span class="lineno"> 1111</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2size</a>;</div>
<div class="line"><span class="lineno"> 1112</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">qfile_t</a> *<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1113</span>    <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno"> 1114</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>    <a class="code hl_define" href="server_8h.html#a451b91ad4ba3a1d0fbd9f3fddf0d6f84">SV_LockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1119</span>    {</div>
<div class="line"><span class="lineno"> 1120</span>        <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;libd0_blind_id DLL not found, this command is inactive.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1121</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1122</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1123</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1124</span>    }</div>
<div class="line"><span class="lineno"> 1125</span> </div>
<div class="line"><span class="lineno"> 1126</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 1127</span>    {</div>
<div class="line"><span class="lineno"> 1128</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Unexpected response from keygen server:\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1129</span>        <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>(<a class="code hl_variable" href="glquake_8h.html#a39774db434725e51f4ad4c04150ed6a1">buffer</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">length_received</a>);</div>
<div class="line"><span class="lineno"> 1130</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1131</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1132</span>    }</div>
<div class="line"><span class="lineno"> 1133</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> &gt;= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> || !<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>])</div>
<div class="line"><span class="lineno"> 1134</span>    {</div>
<div class="line"><span class="lineno"> 1135</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;overflow of keygen_i\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1136</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1137</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1138</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1139</span>    }</div>
<div class="line"><span class="lineno"> 1140</span>    <span class="keywordflow">if</span>(!<a class="code hl_function" href="crypto_8c.html#aad099246d8ff3e9be8f5f4c35bf14d5d">Crypto_ParsePack</a>((<span class="keyword">const</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#a39774db434725e51f4ad4c04150ed6a1">buffer</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">length_received</a>, <a class="code hl_define" href="crypto_8c.html#a952ca24af982e8a9dde40f9bfd860882">FOURCC_D0IR</a>, p, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>, 1))</div>
<div class="line"><span class="lineno"> 1141</span>    {</div>
<div class="line"><span class="lineno"> 1142</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">length_received</a> &gt;= 5 &amp;&amp; <a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>((<span class="keyword">const</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#a39774db434725e51f4ad4c04150ed6a1">buffer</a>) == <a class="code hl_define" href="crypto_8c.html#abef3a6061b8a9869eeba8ac100f10d4d">FOURCC_D0ER</a>)</div>
<div class="line"><span class="lineno"> 1143</span>        {</div>
<div class="line"><span class="lineno"> 1144</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<a class="code hl_define" href="console_8h.html#ae151ed35a905aff75d5f5dc32cd965bb">CON_ERROR</a> <span class="stringliteral">&quot;Error response from keygen server: %.*s\n&quot;</span>, (<span class="keywordtype">int</span>)(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">length_received</a> - 5), <a class="code hl_variable" href="glquake_8h.html#a39774db434725e51f4ad4c04150ed6a1">buffer</a> + 5);</div>
<div class="line"><span class="lineno"> 1145</span>        }</div>
<div class="line"><span class="lineno"> 1146</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1147</span>        {</div>
<div class="line"><span class="lineno"> 1148</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<a class="code hl_define" href="console_8h.html#ae151ed35a905aff75d5f5dc32cd965bb">CON_ERROR</a> <span class="stringliteral">&quot;Invalid response from keygen server:\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1149</span>            <a class="code hl_function" href="common_8c.html#a9913aa4c9e2d0acfc38638235bbe31ca">Com_HexDumpToConsole</a>(<a class="code hl_variable" href="glquake_8h.html#a39774db434725e51f4ad4c04150ed6a1">buffer</a>, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">length_received</a>);</div>
<div class="line"><span class="lineno"> 1150</span>        }</div>
<div class="line"><span class="lineno"> 1151</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1152</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1153</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1154</span>    }</div>
<div class="line"><span class="lineno"> 1155</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#ad3685a8b8407588f11204fab35bef81e">qd0_blind_id_finish_private_id_request</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>], p[0], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0]))</div>
<div class="line"><span class="lineno"> 1156</span>    {</div>
<div class="line"><span class="lineno"> 1157</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_finish_private_id_request failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1158</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1159</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1160</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1161</span>    }</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>    <span class="comment">// verify the key we just got (just in case)</span></div>
<div class="line"><span class="lineno"> 1164</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a099d4d32154ed82ff5431ab675945965">qd0_blind_id_verify_public_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>], &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>) || !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>)</div>
<div class="line"><span class="lineno"> 1165</span>    {</div>
<div class="line"><span class="lineno"> 1166</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_verify_public_id failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1167</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1168</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1169</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1170</span>    }</div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>    <span class="comment">// we have a valid key now!</span></div>
<div class="line"><span class="lineno"> 1173</span>    <span class="comment">// make the rest of crypto.c know that</span></div>
<div class="line"><span class="lineno"> 1174</span>    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Received signature for private ID key_%d.d0pk (public key fingerprint: %s)\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>]);</div>
<div class="line"><span class="lineno"> 1175</span>    <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1176</span> </div>
<div class="line"><span class="lineno"> 1177</span>    <span class="comment">// write the key to disk</span></div>
<div class="line"><span class="lineno"> 1178</span>    p[0] = <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>;</div>
<div class="line"><span class="lineno"> 1179</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0] = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>);</div>
<div class="line"><span class="lineno"> 1180</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a3e2a076dba69c5847aab34bf0bf54b54">qd0_blind_id_write_private_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>], <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0]))</div>
<div class="line"><span class="lineno"> 1181</span>    {</div>
<div class="line"><span class="lineno"> 1182</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_write_private_id failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1183</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1184</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1185</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1186</span>    }</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="keywordflow">if</span>(!(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2size</a> = <a class="code hl_function" href="crypto_8c.html#a858dccc118582ddc67008845ede2a273">Crypto_UnParsePack</a>(buf2, <span class="keyword">sizeof</span>(buf2), <a class="code hl_define" href="crypto_8c.html#a6cfb14fb175de61c8f50eaf4ae8be02a">FOURCC_D0SI</a>, p, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>, 1)))</div>
<div class="line"><span class="lineno"> 1188</span>    {</div>
<div class="line"><span class="lineno"> 1189</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Crypto_UnParsePack failed\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1190</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1191</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1192</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1193</span>    }</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>    <a class="code hl_function" href="fs_8c.html#acf6a6a671fddee50dbb3b0b1ec5d07ad">FS_CreatePath</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%skey_%d.d0si%s&quot;</span>, *<a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> ? <a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> : <a class="code hl_variable" href="fs_8c.html#ad14136292432bbbe329d4ab28ea04b37">fs_basedir</a>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="glquake_8h.html#ae79dfeea357422bd20dbcaa2afe88ac6">string</a>));</div>
<div class="line"><span class="lineno"> 1196</span>    <a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a> = <a class="code hl_function" href="fs_8c.html#a5098aecad23c311750ae649088f2d96d">FS_SysOpen</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%skey_%d.d0si%s&quot;</span>, *<a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> ? <a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> : <a class="code hl_variable" href="fs_8c.html#ad14136292432bbbe329d4ab28ea04b37">fs_basedir</a>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="glquake_8h.html#ae79dfeea357422bd20dbcaa2afe88ac6">string</a>), <span class="stringliteral">&quot;wb&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">false</a>);</div>
<div class="line"><span class="lineno"> 1197</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>)</div>
<div class="line"><span class="lineno"> 1198</span>    {</div>
<div class="line"><span class="lineno"> 1199</span>        <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Cannot open key_%d.d0si%s\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>);</div>
<div class="line"><span class="lineno"> 1200</span>        <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1201</span>        <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1202</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1203</span>    }</div>
<div class="line"><span class="lineno"> 1204</span>    <a class="code hl_function" href="fs_8c.html#a2ef891979f8e7a5158ab1ade82cd733f">FS_Write</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, buf2, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">buf2size</a>);</div>
<div class="line"><span class="lineno"> 1205</span>    <a class="code hl_function" href="fs_8c.html#abcf26e98f08b7bbcc5645486294ebb5c">FS_Close</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>);</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>    <a class="code hl_function" href="crypto_8c.html#ac8da1c183634a38674c81c765b2c8e42">Crypto_SavePubKeyTextFile</a>(<a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>);</div>
<div class="line"><span class="lineno"> 1208</span> </div>
<div class="line"><span class="lineno"> 1209</span>    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Saved to key_%d.d0si%s\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>);</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>    <a class="code hl_function" href="crypto_8c.html#a7b037eca70363845b5621daa59b81f93">Crypto_BuildIdString</a>();</div>
<div class="line"><span class="lineno"> 1212</span> </div>
<div class="line"><span class="lineno"> 1213</span>    <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno"> 1214</span>    <a class="code hl_define" href="server_8h.html#aaab8b61921b35b19229b091879106e12">SV_UnlockThreadMutex</a>();</div>
<div class="line"><span class="lineno"> 1215</span>}</div>
<div class="ttc" id="aconsole_8h_html_ae151ed35a905aff75d5f5dc32cd965bb"><div class="ttname"><a href="console_8h.html#ae151ed35a905aff75d5f5dc32cd965bb">CON_ERROR</a></div><div class="ttdeci">#define CON_ERROR</div><div class="ttdef"><b>Definition</b> <a href="console_8h_source.html#l00097">console.h:97</a></div></div>
<div class="ttc" id="acrypto_8c_html_a099d4d32154ed82ff5431ab675945965"><div class="ttname"><a href="crypto_8c.html#a099d4d32154ed82ff5431ab675945965">qd0_blind_id_verify_public_id</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_verify_public_id)(const d0_blind_id_t *ctx, D0_BOOL *status)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00235">crypto.c:235</a></div></div>
<div class="ttc" id="acrypto_8c_html_a7b037eca70363845b5621daa59b81f93"><div class="ttname"><a href="crypto_8c.html#a7b037eca70363845b5621daa59b81f93">Crypto_BuildIdString</a></div><div class="ttdeci">static void Crypto_BuildIdString(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00842">crypto.c:842</a></div></div>
<div class="ttc" id="acrypto_8c_html_a952ca24af982e8a9dde40f9bfd860882"><div class="ttname"><a href="crypto_8c.html#a952ca24af982e8a9dde40f9bfd860882">FOURCC_D0IR</a></div><div class="ttdeci">#define FOURCC_D0IR</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00055">crypto.c:55</a></div></div>
<div class="ttc" id="acrypto_8c_html_abef3a6061b8a9869eeba8ac100f10d4d"><div class="ttname"><a href="crypto_8c.html#abef3a6061b8a9869eeba8ac100f10d4d">FOURCC_D0ER</a></div><div class="ttdeci">#define FOURCC_D0ER</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00056">crypto.c:56</a></div></div>
<div class="ttc" id="acrypto_8c_html_ad3685a8b8407588f11204fab35bef81e"><div class="ttname"><a href="crypto_8c.html#ad3685a8b8407588f11204fab35bef81e">qd0_blind_id_finish_private_id_request</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_finish_private_id_request)(d0_blind_id_t *ctx, const char *inbuf, size_t inbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00215">crypto.c:215</a></div></div>
<div class="ttc" id="aglquake_8h_html_a39774db434725e51f4ad4c04150ed6a1"><div class="ttname"><a href="glquake_8h.html#a39774db434725e51f4ad4c04150ed6a1">buffer</a></div><div class="ttdeci">GLuint buffer</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00629">glquake.h:629</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>.</p>

</div>
</div>
<a id="ada60652b956c044bd851cbc63d2b6b2c" name="ada60652b956c044bd851cbc63d2b6b2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada60652b956c044bd851cbc63d2b6b2c">&#9670;&#160;</a></span>Crypto_Keys_f()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Keys_f </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmd__state__t.html">cmd_state_t</a> *&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01380">1380</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1381</span>{</div>
<div class="line"><span class="lineno"> 1382</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1383</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1384</span>    {</div>
<div class="line"><span class="lineno"> 1385</span>        <a class="code hl_function" href="console_8c.html#a1cf9711475097b11dc41f743254ec77e">Con_Print</a>(<span class="stringliteral">&quot;libd0_blind_id DLL not found, this command is inactive.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1386</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1387</span>    }</div>
<div class="line"><span class="lineno"> 1388</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1389</span>    {</div>
<div class="line"><span class="lineno"> 1390</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 1391</span>        {</div>
<div class="line"><span class="lineno"> 1392</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;%2d: public key key_%d.d0pk (fingerprint: %s)\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno"> 1393</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 1394</span>            {</div>
<div class="line"><span class="lineno"> 1395</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;    private ID key_%d.d0si%s (public key fingerprint: %s)\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno"> 1396</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 1397</span>                    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;    NOTE: this ID has not yet been signed!\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1398</span>            }</div>
<div class="line"><span class="lineno"> 1399</span>        }</div>
<div class="line"><span class="lineno"> 1400</span>    }</div>
<div class="line"><span class="lineno"> 1401</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>.</p>

</div>
</div>
<a id="ab680491cca435a1f84b2e9fa8a973061" name="ab680491cca435a1f84b2e9fa8a973061"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab680491cca435a1f84b2e9fa8a973061">&#9670;&#160;</a></span>Crypto_LittleLong()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> Crypto_LittleLong </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00059">59</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   60</span>{</div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">   62</span>        ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[0]) |</div>
<div class="line"><span class="lineno">   63</span>        (((<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>) <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[1]) &lt;&lt; 8) |</div>
<div class="line"><span class="lineno">   64</span>        (((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[2]) &lt;&lt; 16) |</div>
<div class="line"><span class="lineno">   65</span>        (((<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>) <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[3]) &lt;&lt; 24);</div>
<div class="line"><span class="lineno">   66</span>}</div>
<div class="ttc" id="aglquake_8h_html_a820662f5b80a48256e2503352e9f51b9"><div class="ttname"><a href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a></div><div class="ttdeci">GLsizeiptr const GLvoid * data</div><div class="ttdef"><b>Definition</b> <a href="glquake_8h_source.html#l00638">glquake.h:638</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, and <a class="el" href="crypto_8c_source.html#l00076">Crypto_ParsePack()</a>.</p>

</div>
</div>
<a id="a6c6ceb1adf55efb9bc29eea8ba64fdad" name="a6c6ceb1adf55efb9bc29eea8ba64fdad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6ceb1adf55efb9bc29eea8ba64fdad">&#9670;&#160;</a></span>Crypto_LoadFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> Crypto_LoadFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>nmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td>
          <td class="paramname"><em>inuserdir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00388">388</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  389</span>{</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno">  391</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">qfile_t</a> *<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  392</span>    <a class="code hl_typedef" href="fs_8h.html#a5bcbce6d6c29888adf596671d6acd44b">fs_offset_t</a> <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>;</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inuserdir</a>)</div>
<div class="line"><span class="lineno">  394</span>        <a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a> = <a class="code hl_function" href="fs_8c.html#a5098aecad23c311750ae649088f2d96d">FS_SysOpen</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%s%s&quot;</span>, *<a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> ? <a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> : <a class="code hl_variable" href="fs_8c.html#ad14136292432bbbe329d4ab28ea04b37">fs_basedir</a>, path), <span class="stringliteral">&quot;rb&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">false</a>);</div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  396</span>        <a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a> = <a class="code hl_function" href="fs_8c.html#a5098aecad23c311750ae649088f2d96d">FS_SysOpen</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%s%s&quot;</span>, <a class="code hl_variable" href="fs_8c.html#ad14136292432bbbe329d4ab28ea04b37">fs_basedir</a>, path), <span class="stringliteral">&quot;rb&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>)</div>
<div class="line"><span class="lineno">  398</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  399</span>    <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a> = <a class="code hl_function" href="fs_8c.html#a06be02d84167befd9817197abb0c2100">FS_Read</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nmax</a>);</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">if</span>(<a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a> &lt; 0)</div>
<div class="line"><span class="lineno">  401</span>        <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a> = 0;</div>
<div class="line"><span class="lineno">  402</span>    <a class="code hl_function" href="fs_8c.html#abcf26e98f08b7bbcc5645486294ebb5c">FS_Close</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>);</div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">return</span> (<span class="keywordtype">size_t</span>) <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>;</div>
<div class="line"><span class="lineno">  404</span>}</div>
<div class="ttc" id="afs_8c_html_a06be02d84167befd9817197abb0c2100"><div class="ttname"><a href="fs_8c.html#a06be02d84167befd9817197abb0c2100">FS_Read</a></div><div class="ttdeci">fs_offset_t FS_Read(qfile_t *file, void *buffer, size_t buffersize)</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l03062">fs.c:3062</a></div></div>
<div class="ttc" id="afs_8h_html_a5bcbce6d6c29888adf596671d6acd44b"><div class="ttname"><a href="fs_8h.html#a5bcbce6d6c29888adf596671d6acd44b">fs_offset_t</a></div><div class="ttdeci">int64_t fs_offset_t</div><div class="ttdef"><b>Definition</b> <a href="fs_8h_source.html#l00037">fs.h:37</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="a1e6cc26fc4d71eacae07453774cf06de" name="a1e6cc26fc4d71eacae07453774cf06de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6cc26fc4d71eacae07453774cf06de">&#9670;&#160;</a></span>Crypto_LoadKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_LoadKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00855">855</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  856</span>{</div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[8192];</div>
<div class="line"><span class="lineno">  858</span>    <span class="keywordtype">size_t</span> len, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a>;</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  860</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>) <span class="comment">// don&#39;t if we can&#39;t</span></div>
<div class="line"><span class="lineno">  863</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a>) <span class="comment">// already loaded? then not</span></div>
<div class="line"><span class="lineno">  866</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>    <a class="code hl_function" href="host_8c.html#a081ad1e5d6023d86cb59fe79737e16ae">Host_LockSession</a>(); <span class="comment">// we use the session ID here</span></div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>    <span class="comment">// load keys</span></div>
<div class="line"><span class="lineno">  871</span>    <span class="comment">// note: we are just a CLIENT</span></div>
<div class="line"><span class="lineno">  872</span>    <span class="comment">// so we load:</span></div>
<div class="line"><span class="lineno">  873</span>    <span class="comment">//   PUBLIC KEYS to accept (including modulus)</span></div>
<div class="line"><span class="lineno">  874</span>    <span class="comment">//   PRIVATE KEY of user</span></div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  877</span>    {</div>
<div class="line"><span class="lineno">  878</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><span class="lineno">  879</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><span class="lineno">  880</span>        <a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  881</span>        <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  882</span>        len = <a class="code hl_function" href="crypto_8c.html#a6c6ceb1adf55efb9bc29eea8ba64fdad">Crypto_LoadFile</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;key_%d.d0pk&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  883</span>        <span class="keywordflow">if</span>((<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_function" href="crypto_8c.html#a5cb4a9947263eef8d464f94959d0411d">Crypto_ReadPublicKey</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, len)))</div>
<div class="line"><span class="lineno">  884</span>        {</div>
<div class="line"><span class="lineno">  885</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a> = <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>;</div>
<div class="line"><span class="lineno">  886</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a2f64f786d757a09a4e8c73edf953a466">qd0_blind_id_fingerprint64_public_key</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a>)) <span class="comment">// keeps final NUL</span></div>
<div class="line"><span class="lineno">  887</span>            {</div>
<div class="line"><span class="lineno">  888</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Loaded public key key_%d.d0pk (fingerprint: %s)\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  889</span>                len = <a class="code hl_function" href="crypto_8c.html#a6c6ceb1adf55efb9bc29eea8ba64fdad">Crypto_LoadFile</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;key_%d.d0si%s&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>), <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  890</span>                <span class="keywordflow">if</span>(len)</div>
<div class="line"><span class="lineno">  891</span>                {</div>
<div class="line"><span class="lineno">  892</span>                    <span class="keywordflow">if</span>(<a class="code hl_function" href="crypto_8c.html#ae509f43bdccf26baf95b3ed68b24d750">Crypto_AddPrivateKey</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, len))</div>
<div class="line"><span class="lineno">  893</span>                    {</div>
<div class="line"><span class="lineno">  894</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a> = <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>;</div>
<div class="line"><span class="lineno">  895</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len2</a>)) <span class="comment">// keeps final NUL</span></div>
<div class="line"><span class="lineno">  896</span>                        {</div>
<div class="line"><span class="lineno">  897</span>                            <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a> = 0;</div>
<div class="line"><span class="lineno">  898</span> </div>
<div class="line"><span class="lineno">  899</span>                            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Loaded private ID key_%d.d0si%s for key_%d.d0pk (public key fingerprint: %s)\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>                            <span class="comment">// verify the key we just loaded (just in case)</span></div>
<div class="line"><span class="lineno">  902</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a5d43fdd72f73796e0dbd984eae9347f4">qd0_blind_id_verify_private_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]) &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#a099d4d32154ed82ff5431ab675945965">qd0_blind_id_verify_public_id</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno">  903</span>                            {</div>
<div class="line"><span class="lineno">  904</span>                                <a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  905</span>                                <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>                                <span class="comment">// verify the key we just got (just in case)</span></div>
<div class="line"><span class="lineno">  908</span>                                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>)</div>
<div class="line"><span class="lineno">  909</span>                                    <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;NOTE: this ID has not yet been signed!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>                                <a class="code hl_function" href="crypto_8c.html#ac8da1c183634a38674c81c765b2c8e42">Crypto_SavePubKeyTextFile</a>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><span class="lineno">  912</span>                            }</div>
<div class="line"><span class="lineno">  913</span>                            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  914</span>                            {</div>
<div class="line"><span class="lineno">  915</span>                                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_verify_private_id failed, this is not a valid key!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  916</span>                                <a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  917</span>                                <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  918</span>                            }</div>
<div class="line"><span class="lineno">  919</span>                        }</div>
<div class="line"><span class="lineno">  920</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  921</span>                        {</div>
<div class="line"><span class="lineno">  922</span>                            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;d0_blind_id_fingerprint64_public_id failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  923</span>                            <a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  924</span>                            <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  925</span>                        }</div>
<div class="line"><span class="lineno">  926</span>                    }</div>
<div class="line"><span class="lineno">  927</span>                }</div>
<div class="line"><span class="lineno">  928</span>            }</div>
<div class="line"><span class="lineno">  929</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  930</span>            {</div>
<div class="line"><span class="lineno">  931</span>                <span class="comment">// can&#39;t really happen</span></div>
<div class="line"><span class="lineno">  932</span>                <a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  933</span>                <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  934</span>            }</div>
<div class="line"><span class="lineno">  935</span>        }</div>
<div class="line"><span class="lineno">  936</span>    }</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>    <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno">  939</span>    <a class="code hl_function" href="crypto_8c.html#a7b037eca70363845b5621daa59b81f93">Crypto_BuildIdString</a>();</div>
<div class="line"><span class="lineno">  940</span>    <a class="code hl_function" href="crypto_8c.html#af4ea4fbb85d42f0fe445c6853deb27e3">Crypto_BuildChallengeAppend</a>();</div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>    <span class="comment">// find a good prefix length for all the keys we know (yes, algorithm is not perfect yet, may yield too long prefix length)</span></div>
<div class="line"><span class="lineno">  943</span>    <a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a> = 0;</div>
<div class="line"><span class="lineno">  944</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>+256, 0, <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>);</div>
<div class="line"><span class="lineno">  945</span>    <span class="keywordflow">while</span>(<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a> &lt; <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>)</div>
<div class="line"><span class="lineno">  946</span>    {</div>
<div class="line"><span class="lineno">  947</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, 0, 256);</div>
<div class="line"><span class="lineno">  948</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  949</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  950</span>            {</div>
<div class="line"><span class="lineno">  951</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  952</span>                    ++<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>) <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>]];</div>
<div class="line"><span class="lineno">  953</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  954</span>                    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  955</span>                        ++<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>) <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>]];</div>
<div class="line"><span class="lineno">  956</span>            }</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  958</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  959</span>            {</div>
<div class="line"><span class="lineno">  960</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  961</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>]] &lt; 2)</div>
<div class="line"><span class="lineno">  962</span>                        <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div>
<div class="line"><span class="lineno">  963</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  964</span>                    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  965</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>]] &lt; 2)</div>
<div class="line"><span class="lineno">  966</span>                            <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div>
<div class="line"><span class="lineno">  967</span>            }</div>
<div class="line"><span class="lineno">  968</span>        ++<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a>;</div>
<div class="line"><span class="lineno">  969</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  970</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  971</span>            {</div>
<div class="line"><span class="lineno">  972</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  973</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  974</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  975</span>                    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[256 + <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> + <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  976</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  977</span>            }</div>
<div class="line"><span class="lineno">  978</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>)</div>
<div class="line"><span class="lineno">  979</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  980</span>    }</div>
<div class="line"><span class="lineno">  981</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a> &lt; 7)</div>
<div class="line"><span class="lineno">  982</span>        <a class="code hl_variable" href="crypto_8c.html#a28bce26dd18684379882653e173b0188">crypto_keyfp_recommended_length</a> = 7;</div>
<div class="line"><span class="lineno">  983</span>}</div>
<div class="ttc" id="acrypto_8c_html_a2f64f786d757a09a4e8c73edf953a466"><div class="ttname"><a href="crypto_8c.html#a2f64f786d757a09a4e8c73edf953a466">qd0_blind_id_fingerprint64_public_key</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_fingerprint64_public_key)(const d0_blind_id_t *ctx, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00208">crypto.c:208</a></div></div>
<div class="ttc" id="acrypto_8c_html_a5cb4a9947263eef8d464f94959d0411d"><div class="ttname"><a href="crypto_8c.html#a5cb4a9947263eef8d464f94959d0411d">Crypto_ReadPublicKey</a></div><div class="ttdeci">static d0_blind_id_t * Crypto_ReadPublicKey(char *buf, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00450">crypto.c:450</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6aa92bfaaf0609b72efa4ee010523361"><div class="ttname"><a href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_free)(d0_blind_id_t *a)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00199">crypto.c:199</a></div></div>
<div class="ttc" id="acrypto_8c_html_a6c6ceb1adf55efb9bc29eea8ba64fdad"><div class="ttname"><a href="crypto_8c.html#a6c6ceb1adf55efb9bc29eea8ba64fdad">Crypto_LoadFile</a></div><div class="ttdeci">static size_t Crypto_LoadFile(const char *path, char *buf, size_t nmax, qbool inuserdir)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00388">crypto.c:388</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae509f43bdccf26baf95b3ed68b24d750"><div class="ttname"><a href="crypto_8c.html#ae509f43bdccf26baf95b3ed68b24d750">Crypto_AddPrivateKey</a></div><div class="ttdeci">static qbool Crypto_AddPrivateKey(d0_blind_id_t *pk, char *buf, size_t len)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00469">crypto.c:469</a></div></div>
<div class="ttc" id="ahost_8c_html_a081ad1e5d6023d86cb59fe79737e16ae"><div class="ttname"><a href="host_8c.html#a081ad1e5d6023d86cb59fe79737e16ae">Host_LockSession</a></div><div class="ttdeci">void Host_LockSession(void)</div><div class="ttdef"><b>Definition</b> <a href="host_8c_source.html#l00327">host.c:327</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01373">Crypto_Reload_f()</a>, <a class="el" href="netconn_8c_source.html#l01088">NetConn_OpenClientPorts()</a>, <a class="el" href="netconn_8c_source.html#l01158">NetConn_OpenServerPorts()</a>, and <a class="el" href="prvm__edict_8c_source.html#l02005">PRVM_Prog_Load()</a>.</p>

</div>
</div>
<a id="a6cc7bf287af177afa9b29d2e79ef0559" name="a6cc7bf287af177afa9b29d2e79ef0559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc7bf287af177afa9b29d2e79ef0559">&#9670;&#160;</a></span>Crypto_OpenLibrary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_OpenLibrary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00283">283</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  284</span>{</div>
<div class="line"><span class="lineno">  285</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dllnames</a> [] =</div>
<div class="line"><span class="lineno">  286</span>    {</div>
<div class="line"><span class="lineno">  287</span><span class="preprocessor">#if defined(WIN32)</span></div>
<div class="line"><span class="lineno">  288</span>        <span class="stringliteral">&quot;libd0_blind_id-0.dll&quot;</span>,</div>
<div class="line"><span class="lineno">  289</span><span class="preprocessor">#elif defined(MACOSX)</span></div>
<div class="line"><span class="lineno">  290</span>        <span class="stringliteral">&quot;libd0_blind_id.0.dylib&quot;</span>,</div>
<div class="line"><span class="lineno">  291</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  292</span>        <span class="stringliteral">&quot;libd0_blind_id.so.0&quot;</span>,</div>
<div class="line"><span class="lineno">  293</span>        <span class="stringliteral">&quot;libd0_blind_id.so&quot;</span>, <span class="comment">// FreeBSD</span></div>
<div class="line"><span class="lineno">  294</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  295</span>        <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div>
<div class="line"><span class="lineno">  296</span>    };</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    <span class="comment">// Already loaded?</span></div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="comment">// Load the DLL</span></div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="sys_8h.html#a7d5fb719236d753c6487958a306b51c6">Sys_LoadDependency</a> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dllnames</a>, &amp;<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>, <a class="code hl_variable" href="crypto_8c.html#a422626d9526190c4d1ab54321f94b463">d0_blind_id_funcs</a>);</div>
<div class="line"><span class="lineno">  304</span>}</div>
<div class="ttc" id="acrypto_8c_html_a422626d9526190c4d1ab54321f94b463"><div class="ttname"><a href="crypto_8c.html#a422626d9526190c4d1ab54321f94b463">d0_blind_id_funcs</a></div><div class="ttdeci">static dllfunction_t d0_blind_id_funcs[]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00237">crypto.c:237</a></div></div>
<div class="ttc" id="asys_8h_html_a7d5fb719236d753c6487958a306b51c6"><div class="ttname"><a href="sys_8h.html#a7d5fb719236d753c6487958a306b51c6">Sys_LoadDependency</a></div><div class="ttdeci">qbool Sys_LoadDependency(const char **dllnames, dllhandle_t *handle, const dllfunction_t *fcts)</div><div class="ttdef"><b>Definition</b> <a href="sys__shared_8c_source.html#l00128">sys_shared.c:128</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="aad099246d8ff3e9be8f5f4c35bf14d5d" name="aad099246d8ff3e9be8f5f4c35bf14d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad099246d8ff3e9be8f5f4c35bf14d5d">&#9670;&#160;</a></span>Crypto_ParsePack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> Crypto_ParsePack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a>&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> **&#160;</td>
          <td class="paramname"><em>lumps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>lumpsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>nlumps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00076">76</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   77</span>{</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordtype">size_t</span> pos;</div>
<div class="line"><span class="lineno">   80</span>    pos = 0;</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">if</span>(header)</div>
<div class="line"><span class="lineno">   82</span>    {</div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordflow">if</span>(len &lt; 4)</div>
<div class="line"><span class="lineno">   84</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>) != header)</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   87</span>        pos += 4;</div>
<div class="line"><span class="lineno">   88</span>    }</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nlumps</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">   90</span>    {</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">if</span>(pos + 4 &gt; len)</div>
<div class="line"><span class="lineno">   92</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   93</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_function" href="crypto_8c.html#ab680491cca435a1f84b2e9fa8a973061">Crypto_LittleLong</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[pos]);</div>
<div class="line"><span class="lineno">   94</span>        pos += 4;</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordflow">if</span>(pos + <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] &gt; len)</div>
<div class="line"><span class="lineno">   96</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   97</span>        lumps[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = &amp;<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[pos];</div>
<div class="line"><span class="lineno">   98</span>        pos += <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno">   99</span>    }</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">return</span> pos;</div>
<div class="line"><span class="lineno">  101</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00469">Crypto_AddPrivateKey()</a>, <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, and <a class="el" href="crypto_8c_source.html#l00450">Crypto_ReadPublicKey()</a>.</p>

</div>
</div>
<a id="a5cb4a9947263eef8d464f94959d0411d" name="a5cb4a9947263eef8d464f94959d0411d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cb4a9947263eef8d464f94959d0411d">&#9670;&#160;</a></span>Crypto_ReadPublicKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> * Crypto_ReadPublicKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00450">450</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  451</span>{</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_typedef" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  453</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *p[2];</div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[2];</div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="crypto_8c.html#aad099246d8ff3e9be8f5f4c35bf14d5d">Crypto_ParsePack</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, len, <a class="code hl_define" href="crypto_8c.html#a207294545e7e194a700239bd148de2ac">FOURCC_D0PK</a>, p, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>, 2))</div>
<div class="line"><span class="lineno">  456</span>    {</div>
<div class="line"><span class="lineno">  457</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a> = <a class="code hl_variable" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a>();</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a>)</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a0b9d3969f89aaf222970ed72c2fd09ca">qd0_blind_id_read_public_key</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a>, p[0], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[0]))</div>
<div class="line"><span class="lineno">  460</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aad8d6f9972282ff99b7ed54db5380368">qd0_blind_id_read_private_id_modulus</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a>, p[1], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>[1]))</div>
<div class="line"><span class="lineno">  461</span>                    <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a>;</div>
<div class="line"><span class="lineno">  462</span>    }</div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a>)</div>
<div class="line"><span class="lineno">  464</span>        <a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">pk</a>);</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  466</span>}</div>
<div class="ttc" id="acrypto_8c_html_a0b9d3969f89aaf222970ed72c2fd09ca"><div class="ttname"><a href="crypto_8c.html#a0b9d3969f89aaf222970ed72c2fd09ca">qd0_blind_id_read_public_key</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_read_public_key)(d0_blind_id_t *ctx, const char *inbuf, size_t inbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00205">crypto.c:205</a></div></div>
<div class="ttc" id="acrypto_8c_html_a207294545e7e194a700239bd148de2ac"><div class="ttname"><a href="crypto_8c.html#a207294545e7e194a700239bd148de2ac">FOURCC_D0PK</a></div><div class="ttdeci">#define FOURCC_D0PK</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00050">crypto.c:50</a></div></div>
<div class="ttc" id="acrypto_8c_html_aad8d6f9972282ff99b7ed54db5380368"><div class="ttname"><a href="crypto_8c.html#aad8d6f9972282ff99b7ed54db5380368">qd0_blind_id_read_private_id_modulus</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_read_private_id_modulus)(d0_blind_id_t *ctx, const char *inbuf, size_t inbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00210">crypto.c:210</a></div></div>
<div class="ttc" id="acrypto_8c_html_ab4e48fcb3e2bb84bb6d537bcdf564935"><div class="ttname"><a href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a></div><div class="ttdeci">struct d0_blind_id_s d0_blind_id_t</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00196">crypto.c:196</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="a2face099d8db579f04009cc115b4b7b2" name="a2face099d8db579f04009cc115b4b7b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2face099d8db579f04009cc115b4b7b2">&#9670;&#160;</a></span>Crypto_Reload_f()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Reload_f </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcmd__state__t.html">cmd_state_t</a> *&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01373">1373</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1374</span>{</div>
<div class="line"><span class="lineno"> 1375</span>    <a class="code hl_function" href="crypto_8c.html#a2531ce5eea2370af4ade686477c9e9f2">Crypto_ClearHostKeys</a>();</div>
<div class="line"><span class="lineno"> 1376</span>    <a class="code hl_function" href="crypto_8c.html#ab82a547776a3b80b6f0a2c04b428e49b">Crypto_UnloadKeys</a>();</div>
<div class="line"><span class="lineno"> 1377</span>    <a class="code hl_function" href="crypto_8c.html#a1e6cc26fc4d71eacae07453774cf06de">Crypto_LoadKeys</a>();</div>
<div class="line"><span class="lineno"> 1378</span>}</div>
<div class="ttc" id="acrypto_8c_html_a2531ce5eea2370af4ade686477c9e9f2"><div class="ttname"><a href="crypto_8c.html#a2531ce5eea2370af4ade686477c9e9f2">Crypto_ClearHostKeys</a></div><div class="ttdeci">static void Crypto_ClearHostKeys(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00598">crypto.c:598</a></div></div>
<div class="ttc" id="acrypto_8c_html_ab82a547776a3b80b6f0a2c04b428e49b"><div class="ttname"><a href="crypto_8c.html#ab82a547776a3b80b6f0a2c04b428e49b">Crypto_UnloadKeys</a></div><div class="ttdeci">static void Crypto_UnloadKeys(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00985">crypto.c:985</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>.</p>

</div>
</div>
<a id="a4addd0ad7e9030ba3719926ad25b11b4" name="a4addd0ad7e9030ba3719926ad25b11b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4addd0ad7e9030ba3719926ad25b11b4">&#9670;&#160;</a></span>Crypto_RetrieveHostKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_RetrieveHostKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>keyfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>keyfplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>idfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>idfplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> *&#160;</td>
          <td class="paramname"><em>aeslevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> *&#160;</td>
          <td class="paramname"><em>issigned</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00734">734</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  735</span>{</div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[128];</div>
<div class="line"><span class="lineno">  737</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a>;</div>
<div class="line"><span class="lineno">  738</span>    <a class="code hl_struct" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>;</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>    <a class="code hl_function" href="lhnet_8c.html#a191c91d25271eed39a5eb76e2d8e5dde">LHNETADDRESS_ToString</a>(peeraddress, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), 1);</div>
<div class="line"><span class="lineno">  744</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a> = <a class="code hl_function" href="com__crc16_8c.html#aa9ba811c20537ebd01898928be2de439">CRC_Block</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strlen</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>)) % <a class="code hl_define" href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a>;</div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = <a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a>]; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> &amp;&amp; <a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;addr, peeraddress); <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;next);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>)</div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    <span class="keywordflow">if</span>(keyid)</div>
<div class="line"><span class="lineno">  751</span>        *keyid = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;keyid;</div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>)</div>
<div class="line"><span class="lineno">  753</span>        <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;keyid], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfplen</a>);</div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordflow">if</span>(idfp)</div>
<div class="line"><span class="lineno">  755</span>        <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(idfp, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;idfp, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idfplen</a>);</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">if</span>(aeslevel)</div>
<div class="line"><span class="lineno">  757</span>        *aeslevel = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;aeslevel;</div>
<div class="line"><span class="lineno">  758</span>    <span class="keywordflow">if</span>(issigned)</div>
<div class="line"><span class="lineno">  759</span>        *issigned = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;issigned;</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  762</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="mvm__cmds_8c_source.html#l00849">VM_M_crypto_getencryptlevel()</a>, <a class="el" href="mvm__cmds_8c_source.html#l00817">VM_M_crypto_getidfp()</a>, <a class="el" href="mvm__cmds_8c_source.html#l00833">VM_M_crypto_getidstatus()</a>, and <a class="el" href="mvm__cmds_8c_source.html#l00801">VM_M_crypto_getkeyfp()</a>.</p>

</div>
</div>
<a id="a530db18ab03fe35200fa035277bc9b03" name="a530db18ab03fe35200fa035277bc9b03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530db18ab03fe35200fa035277bc9b03">&#9670;&#160;</a></span>Crypto_RetrieveLocalKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_RetrieveLocalKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>keyfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>keyfplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>idfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>idfplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> *&#160;</td>
          <td class="paramname"><em>issigned</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00763">763</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  764</span>{</div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyid &lt; 0 || keyid &gt;</a>= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>)</div>
<div class="line"><span class="lineno">  766</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>)</div>
<div class="line"><span class="lineno">  768</span>        *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a> = 0;</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">if</span>(idfp)</div>
<div class="line"><span class="lineno">  770</span>        *idfp = 0;</div>
<div class="line"><span class="lineno">  771</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[keyid])</div>
<div class="line"><span class="lineno">  772</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>)</div>
<div class="line"><span class="lineno">  774</span>        <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[keyid], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyfplen</a>);</div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">if</span>(idfp)</div>
<div class="line"><span class="lineno">  776</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[keyid])</div>
<div class="line"><span class="lineno">  777</span>            <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(idfp, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[keyid], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idfplen</a>);</div>
<div class="line"><span class="lineno">  778</span>    <span class="keywordflow">if</span>(issigned)</div>
<div class="line"><span class="lineno">  779</span>        *issigned = <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[keyid];</div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  781</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mvm__cmds_8c_source.html#l00896">VM_M_crypto_getmyidfp()</a>, <a class="el" href="mvm__cmds_8c_source.html#l00918">VM_M_crypto_getmyidstatus()</a>, and <a class="el" href="mvm__cmds_8c_source.html#l00874">VM_M_crypto_getmykeyfp()</a>.</p>

</div>
</div>
<a id="aad54f544f3250410db6aff02f795c322" name="aad54f544f3250410db6aff02f795c322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad54f544f3250410db6aff02f795c322">&#9670;&#160;</a></span>Crypto_Rijndael_CloseLibrary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Rijndael_CloseLibrary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00375">375</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  376</span>{</div>
<div class="line"><span class="lineno">  377</span>    <a class="code hl_function" href="sys_8h.html#ae1bd207c941d95e0bd80aae8dab178f2">Sys_FreeLibrary</a> (&amp;<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>);</div>
<div class="line"><span class="lineno">  378</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>, and <a class="el" href="crypto_8c_source.html#l01043">Crypto_Shutdown()</a>.</p>

</div>
</div>
<a id="aa266b054915a179b802f7177d59e58e9" name="aa266b054915a179b802f7177d59e58e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa266b054915a179b802f7177d59e58e9">&#9670;&#160;</a></span>Crypto_Rijndael_OpenLibrary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_Rijndael_OpenLibrary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00352">352</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  353</span>{</div>
<div class="line"><span class="lineno">  354</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dllnames</a> [] =</div>
<div class="line"><span class="lineno">  355</span>    {</div>
<div class="line"><span class="lineno">  356</span><span class="preprocessor">#if defined(WIN32)</span></div>
<div class="line"><span class="lineno">  357</span>        <span class="stringliteral">&quot;libd0_rijndael-0.dll&quot;</span>,</div>
<div class="line"><span class="lineno">  358</span><span class="preprocessor">#elif defined(MACOSX)</span></div>
<div class="line"><span class="lineno">  359</span>        <span class="stringliteral">&quot;libd0_rijndael.0.dylib&quot;</span>,</div>
<div class="line"><span class="lineno">  360</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  361</span>        <span class="stringliteral">&quot;libd0_rijndael.so.0&quot;</span>,</div>
<div class="line"><span class="lineno">  362</span>        <span class="stringliteral">&quot;libd0_rijndael.so&quot;</span>, <span class="comment">// FreeBSD</span></div>
<div class="line"><span class="lineno">  363</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  364</span>        <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div>
<div class="line"><span class="lineno">  365</span>    };</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    <span class="comment">// Already loaded?</span></div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>)</div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    <span class="comment">// Load the DLL</span></div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="sys_8h.html#a7d5fb719236d753c6487958a306b51c6">Sys_LoadDependency</a> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dllnames</a>, &amp;<a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a>, <a class="code hl_variable" href="crypto_8c.html#aa1189ee7ea90350778e8fdbe7ee9a9d2">d0_rijndael_funcs</a>);</div>
<div class="line"><span class="lineno">  373</span>}</div>
<div class="ttc" id="acrypto_8c_html_aa1189ee7ea90350778e8fdbe7ee9a9d2"><div class="ttname"><a href="crypto_8c.html#aa1189ee7ea90350778e8fdbe7ee9a9d2">d0_rijndael_funcs</a></div><div class="ttdeci">static dllfunction_t d0_rijndael_funcs[]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00341">crypto.c:341</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="ac8da1c183634a38674c81c765b2c8e42" name="ac8da1c183634a38674c81c765b2c8e42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8da1c183634a38674c81c765b2c8e42">&#9670;&#160;</a></span>Crypto_SavePubKeyTextFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_SavePubKeyTextFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00814">814</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  815</span>{</div>
<div class="line"><span class="lineno">  816</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">qfile_t</a> *<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>;</div>
<div class="line"><span class="lineno">  817</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  820</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  821</span>    <a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a> = <a class="code hl_function" href="fs_8c.html#a5098aecad23c311750ae649088f2d96d">FS_SysOpen</a>(<a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;%skey_%d-public-fp%s.txt&quot;</span>, *<a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> ? <a class="code hl_variable" href="fs_8c.html#afffc20194b866aa9ea07bed3f2c5a30d">fs_userdir</a> : <a class="code hl_variable" href="fs_8c.html#ad14136292432bbbe329d4ab28ea04b37">fs_basedir</a>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="glquake_8h.html#ae79dfeea357422bd20dbcaa2afe88ac6">string</a>), <span class="stringliteral">&quot;w&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">false</a>);</div>
<div class="line"><span class="lineno">  822</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>)</div>
<div class="line"><span class="lineno">  823</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>    <span class="comment">// we ignore errors for this file, as it&#39;s not necessary to have</span></div>
<div class="line"><span class="lineno">  826</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;ID-Fingerprint: %s\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  827</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;ID-Is-Signed: %s\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><span class="lineno">  828</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;ID-Is-For-Key: %s\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  829</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  830</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;This is a PUBLIC ID file for DarkPlaces.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  831</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;You are free to share this file or its contents.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  832</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  833</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;This file will be automatically generated again if deleted.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  834</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  835</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;However, NEVER share the accompanying SECRET ID file called\n&quot;</span>);</div>
<div class="line"><span class="lineno">  836</span>    <a class="code hl_function" href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>, <span class="stringliteral">&quot;key_%d.d0si%s, as doing so would compromise security!\n&quot;</span>, <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="host_8c.html#a0ddc5c0baccb97e671b135bcf8d4e257">sessionid</a>.<a class="code hl_variable" href="structcvar__t.html#aa8b859b9332810d238c09b51ea54a2f4">string</a>);</div>
<div class="line"><span class="lineno">  837</span>    <a class="code hl_function" href="fs_8c.html#abcf26e98f08b7bbcc5645486294ebb5c">FS_Close</a>(<a class="code hl_variable" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>);</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  840</span>}</div>
<div class="ttc" id="afs_8c_html_acb2f91e19bc9adfe48467c7ade9201ab"><div class="ttname"><a href="fs_8c.html#acb2f91e19bc9adfe48467c7ade9201ab">FS_Printf</a></div><div class="ttdeci">int FS_Printf(qfile_t *file, const char *format,...)</div><div class="ttdef"><b>Definition</b> <a href="fs_8c_source.html#l03269">fs.c:3269</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, and <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="af1d27aad50725635cef9445233a58e3f" name="af1d27aad50725635cef9445233a58e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1d27aad50725635cef9445233a58e3f">&#9670;&#160;</a></span>Crypto_ServerAppendToChallenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> Crypto_ServerAppendToChallenge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>maxlen_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01696">1696</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1697</span>{</div>
<div class="line"><span class="lineno"> 1698</span>    <span class="comment">// cheap op, all is precomputed</span></div>
<div class="line"><span class="lineno"> 1699</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1700</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no support</span></div>
<div class="line"><span class="lineno"> 1701</span>    <span class="comment">// append challenge</span></div>
<div class="line"><span class="lineno"> 1702</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">maxlen_out</a> &lt;= *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> + <a class="code hl_variable" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a>)</div>
<div class="line"><span class="lineno"> 1703</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1704</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a> + *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_variable" href="crypto_8c.html#a0a7166948fbca4aa370e98c8f64d139a">challenge_append</a>, <a class="code hl_variable" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a>);</div>
<div class="line"><span class="lineno"> 1705</span>    *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> += <a class="code hl_variable" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a>;</div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1707</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a47f01fa09e28a809c2bf17a9bf68fafb" name="a47f01fa09e28a809c2bf17a9bf68fafb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47f01fa09e28a809c2bf17a9bf68fafb">&#9670;&#160;</a></span>Crypto_ServerError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_ServerError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>msg_client</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01709">1709</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1710</span>{</div>
<div class="line"><span class="lineno"> 1711</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msg_client</a>)</div>
<div class="line"><span class="lineno"> 1712</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msg_client</a> = msg;</div>
<div class="line"><span class="lineno"> 1713</span>    <a class="code hl_function" href="console_8c.html#a2696300802453d9333e9f52e5fae15bc">Con_DPrintf</a>(<span class="stringliteral">&quot;rejecting client: %s\n&quot;</span>, msg);</div>
<div class="line"><span class="lineno"> 1714</span>    <span class="keywordflow">if</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msg_client</a>)</div>
<div class="line"><span class="lineno"> 1715</span>        <a class="code hl_function" href="common_8c.html#ae36050083f45e395189fee6aa45fbb0c">dpsnprintf</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;reject %s&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msg_client</a>);</div>
<div class="line"><span class="lineno"> 1716</span>    *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strlen</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>);</div>
<div class="line"><span class="lineno"> 1717</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 1718</span>}</div>
<div class="ttc" id="aconsole_8c_html_a2696300802453d9333e9f52e5fae15bc"><div class="ttname"><a href="console_8c.html#a2696300802453d9333e9f52e5fae15bc">Con_DPrintf</a></div><div class="ttdeci">void Con_DPrintf(const char *fmt,...)</div><div class="ttdoc">A Con_Printf that only shows up if the &quot;developer&quot; cvar is set.</div><div class="ttdef"><b>Definition</b> <a href="console_8c_source.html#l01490">console.c:1490</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="ae33a7c8f188fd12df9099e15fb7aa682" name="ae33a7c8f188fd12df9099e15fb7aa682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33a7c8f188fd12df9099e15fb7aa682">&#9670;&#160;</a></span>Crypto_ServerFindInstance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="structcrypto__t.html">crypto_t</a> * Crypto_ServerFindInstance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td>
          <td class="paramname"><em>allow_create</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00528">528</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  529</span>{</div>
<div class="line"><span class="lineno">  530</span>    <a class="code hl_struct" href="structcrypto__t.html">crypto_t</a> *crypto; </div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">best</a>;</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno">  534</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; <span class="comment">// no support</span></div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  537</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(peeraddress, &amp;<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].address))</div>
<div class="line"><span class="lineno">  538</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a> &amp;&amp; (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">allow_create</a> || <a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].crypto.<a class="code hl_variable" href="structcrypto__t.html#aec9864c6bec1d769d033ad9a57414d30">data</a>))</div>
<div class="line"><span class="lineno">  540</span>    {</div>
<div class="line"><span class="lineno">  541</span>        crypto = &amp;<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code hl_variable" href="structserver__cryptoconnect__t.html#a0619ecaf62b280776937a4125c543ad2">crypto</a>;</div>
<div class="line"><span class="lineno">  542</span>        <a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code hl_variable" href="structserver__cryptoconnect__t.html#ac48493c17d176335d70120dd1aaaf742">lasttime</a> = <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a>;</div>
<div class="line"><span class="lineno">  543</span>        <span class="keywordflow">return</span> crypto;</div>
<div class="line"><span class="lineno">  544</span>    }</div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">allow_create</a>)</div>
<div class="line"><span class="lineno">  546</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  547</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">best</a> = 0;</div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].lasttime &lt; <a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">best</a>].lasttime)</div>
<div class="line"><span class="lineno">  550</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">best</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  551</span>    crypto = &amp;<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">best</a>].<a class="code hl_variable" href="structserver__cryptoconnect__t.html#a0619ecaf62b280776937a4125c543ad2">crypto</a>;</div>
<div class="line"><span class="lineno">  552</span>    <a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">best</a>].<a class="code hl_variable" href="structserver__cryptoconnect__t.html#ac48493c17d176335d70120dd1aaaf742">lasttime</a> = <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a>;</div>
<div class="line"><span class="lineno">  553</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">best</a>].address, peeraddress, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">best</a>].address));</div>
<div class="line"><span class="lineno">  554</span>    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordflow">return</span> crypto;</div>
<div class="line"><span class="lineno">  556</span>}</div>
<div class="ttc" id="acrypto_8c_html_a0227d3cfd03cca7f1cb298e750152c61"><div class="ttname"><a href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a></div><div class="ttdeci">#define MAX_CRYPTOCONNECTS</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00493">crypto.c:493</a></div></div>
<div class="ttc" id="acrypto_8c_html_aa4630d2842fd947361b293e0102b7205"><div class="ttname"><a href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a></div><div class="ttdeci">static server_cryptoconnect_t cryptoconnects[MAX_CRYPTOCONNECTS]</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00507">crypto.c:507</a></div></div>
<div class="ttc" id="astructcrypto__t_html_aec9864c6bec1d769d033ad9a57414d30"><div class="ttname"><a href="structcrypto__t.html#aec9864c6bec1d769d033ad9a57414d30">crypto_t::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00052">crypto.h:52</a></div></div>
<div class="ttc" id="astructserver__cryptoconnect__t_html_a0619ecaf62b280776937a4125c543ad2"><div class="ttname"><a href="structserver__cryptoconnect__t.html#a0619ecaf62b280776937a4125c543ad2">server_cryptoconnect_t::crypto</a></div><div class="ttdeci">crypto_t crypto</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00503">crypto.c:503</a></div></div>
<div class="ttc" id="astructserver__cryptoconnect__t_html_ac48493c17d176335d70120dd1aaaf742"><div class="ttname"><a href="structserver__cryptoconnect__t.html#ac48493c17d176335d70120dd1aaaf742">server_cryptoconnect_t::lasttime</a></div><div class="ttdeci">double lasttime</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00501">crypto.c:501</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00573">Crypto_ServerGetInstance()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="a054ffa4cc3d4babef105c85cbb5f367f" name="a054ffa4cc3d4babef105c85cbb5f367f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a054ffa4cc3d4babef105c85cbb5f367f">&#9670;&#160;</a></span>Crypto_ServerGetInstance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcrypto__t.html">crypto_t</a> * Crypto_ServerGetInstance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00573">573</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  574</span>{</div>
<div class="line"><span class="lineno">  575</span>    <span class="comment">// no check needed here (returned pointers are only used in prefilled fields)</span></div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#ae33a7c8f188fd12df9099e15fb7aa682">Crypto_ServerFindInstance</a>(peeraddress, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  577</span>}</div>
<div class="ttc" id="acrypto_8c_html_ae33a7c8f188fd12df9099e15fb7aa682"><div class="ttname"><a href="crypto_8c.html#ae33a7c8f188fd12df9099e15fb7aa682">Crypto_ServerFindInstance</a></div><div class="ttdeci">static crypto_t * Crypto_ServerFindInstance(lhnetaddress_t *peeraddress, qbool allow_create)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00528">crypto.c:528</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="ace1b41f4cd5100f173da25da7f726a8f" name="ace1b41f4cd5100f173da25da7f726a8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace1b41f4cd5100f173da25da7f726a8f">&#9670;&#160;</a></span>Crypto_ServerParsePacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_ServerParsePacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02036">2036</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2037</span>{</div>
<div class="line"><span class="lineno"> 2038</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="shader__glsl_8h.html#a339672ff94e6199019102f50d317c3d7">ret</a>;</div>
<div class="line"><span class="lineno"> 2039</span>    <span class="keywordtype">double</span> t = 0;</div>
<div class="line"><span class="lineno"> 2040</span>    <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">complain_time</a> = 0;</div>
<div class="line"><span class="lineno"> 2041</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>;</div>
<div class="line"><span class="lineno"> 2042</span>    <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_time</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2043</span>    <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_reject</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2044</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>[<a class="code hl_define" href="qdefs_8h.html#a119f8457078d7390fb45ea0838adb806">MAX_INPUTLINE</a>];</div>
<div class="line"><span class="lineno"> 2045</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> &gt; 0 || <a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 2046</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt; 5 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <span class="stringliteral">&quot;d0pk\\&quot;</span>, 5))</div>
<div class="line"><span class="lineno"> 2047</span>        {</div>
<div class="line"><span class="lineno"> 2048</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_time</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2049</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a> = (<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a> + 4, <span class="stringliteral">&quot;cnt&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)) ? <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a> : <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2050</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>)</div>
<div class="line"><span class="lineno"> 2051</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;0&quot;</span>))</div>
<div class="line"><span class="lineno"> 2052</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_reject</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2053</span>        }</div>
<div class="line"><span class="lineno"> 2054</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_time</a>)</div>
<div class="line"><span class="lineno"> 2055</span>    {</div>
<div class="line"><span class="lineno"> 2056</span>        <span class="comment">// check if we may perform crypto...</span></div>
<div class="line"><span class="lineno"> 2057</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 2058</span>        {</div>
<div class="line"><span class="lineno"> 2059</span>            <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> += (<a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> - <a class="code hl_variable" href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a>) * <a class="code hl_variable" href="crypto_8c.html#a60a6b08ba933d05ae0ba07ba429fe03e">crypto_servercpupercent</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> * 0.01;</div>
<div class="line"><span class="lineno"> 2060</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a>)</div>
<div class="line"><span class="lineno"> 2061</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> &gt; <a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a>)</div>
<div class="line"><span class="lineno"> 2062</span>                    <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> = <a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a>;</div>
<div class="line"><span class="lineno"> 2063</span>        }</div>
<div class="line"><span class="lineno"> 2064</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2065</span>        {</div>
<div class="line"><span class="lineno"> 2066</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 2067</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> != <a class="code hl_variable" href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a>)</div>
<div class="line"><span class="lineno"> 2068</span>                    <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> = <a class="code hl_variable" href="crypto_8c.html#a802583bf599735ca3f90741d55954864">crypto_servercpumaxtime</a>.<a class="code hl_variable" href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">value</a>;</div>
<div class="line"><span class="lineno"> 2069</span>        }</div>
<div class="line"><span class="lineno"> 2070</span>        <a class="code hl_variable" href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a> = <a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a>;</div>
<div class="line"><span class="lineno"> 2071</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_reject</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 2072</span>        {</div>
<div class="line"><span class="lineno"> 2073</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="host_8c.html#a18cf3cec0ecbf5cc14125f494c49023d">host</a>.<a class="code hl_variable" href="structhost__static__t.html#ac38d937c03a5f5f973a77641c0ae1280">realtime</a> &gt; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">complain_time</a> + 5)</div>
<div class="line"><span class="lineno"> 2074</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;crypto: cannot perform requested crypto operations; denial service attack or crypto_servercpupercent/crypto_servercpumaxtime are too low\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 2075</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = 0;</div>
<div class="line"><span class="lineno"> 2076</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2077</span>        }</div>
<div class="line"><span class="lineno"> 2078</span>        t = <a class="code hl_function" href="sys_8h.html#aa0fbad346b8cec314ebf444c564ffa02">Sys_DirtyTime</a>();</div>
<div class="line"><span class="lineno"> 2079</span>    }</div>
<div class="line"><span class="lineno"> 2080</span>    <a class="code hl_variable" href="shader__glsl_8h.html#a339672ff94e6199019102f50d317c3d7">ret</a> = <a class="code hl_function" href="crypto_8c.html#a54bf4c38d481347e97316d106fb793f3">Crypto_ServerParsePacket_Internal</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, peeraddress);</div>
<div class="line"><span class="lineno"> 2081</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">do_time</a>)</div>
<div class="line"><span class="lineno"> 2082</span>    {</div>
<div class="line"><span class="lineno"> 2083</span>        t = <a class="code hl_function" href="sys_8h.html#aa0fbad346b8cec314ebf444c564ffa02">Sys_DirtyTime</a>() - t;<span class="keywordflow">if</span> (t &lt; 0.0) t = 0.0; <span class="comment">// dirtytime can step backwards</span></div>
<div class="line"><span class="lineno"> 2084</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno"> 2085</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;crypto: accumulator was %.1f ms, used %.1f ms for crypto, &quot;</span>, <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> * 1000, t * 1000);</div>
<div class="line"><span class="lineno"> 2086</span>        <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> -= t;</div>
<div class="line"><span class="lineno"> 2087</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a90ed817e2c4e40c2d34af9d37e7edd64">crypto_servercpudebug</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a>)</div>
<div class="line"><span class="lineno"> 2088</span>            <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;is %.1f ms\n&quot;</span>, <a class="code hl_variable" href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a> * 1000);</div>
<div class="line"><span class="lineno"> 2089</span>    }</div>
<div class="line"><span class="lineno"> 2090</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="shader__glsl_8h.html#a339672ff94e6199019102f50d317c3d7">ret</a>;</div>
<div class="line"><span class="lineno"> 2091</span>}</div>
<div class="ttc" id="acrypto_8c_html_a1310a98c3e1b982d484654a27f259671"><div class="ttname"><a href="crypto_8c.html#a1310a98c3e1b982d484654a27f259671">crypto_servercpu_accumulator</a></div><div class="ttdeci">static double crypto_servercpu_accumulator</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00036">crypto.c:36</a></div></div>
<div class="ttc" id="acrypto_8c_html_a481f329d6a8171607db23fb324302b70"><div class="ttname"><a href="crypto_8c.html#a481f329d6a8171607db23fb324302b70">crypto_servercpu_lastrealtime</a></div><div class="ttdeci">static double crypto_servercpu_lastrealtime</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00037">crypto.c:37</a></div></div>
<div class="ttc" id="acrypto_8c_html_a54bf4c38d481347e97316d106fb793f3"><div class="ttname"><a href="crypto_8c.html#a54bf4c38d481347e97316d106fb793f3">Crypto_ServerParsePacket_Internal</a></div><div class="ttdeci">static int Crypto_ServerParsePacket_Internal(const char *data_in, size_t len_in, char *data_out, size_t *len_out, lhnetaddress_t *peeraddress)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01727">crypto.c:1727</a></div></div>
<div class="ttc" id="ashader__glsl_8h_html_a339672ff94e6199019102f50d317c3d7"><div class="ttname"><a href="shader__glsl_8h.html#a339672ff94e6199019102f50d317c3d7">ret</a></div><div class="ttdeci">return ret</div><div class="ttdef"><b>Definition</b> <a href="shader__glsl_8h_source.html#l00297">shader_glsl.h:297</a></div></div>
<div class="ttc" id="astructcvar__t_html_a305faa0167494135297f1b8e6216d469"><div class="ttname"><a href="structcvar__t.html#a305faa0167494135297f1b8e6216d469">cvar_t::value</a></div><div class="ttdeci">float value</div><div class="ttdef"><b>Definition</b> <a href="cvar_8h_source.html#l00074">cvar.h:74</a></div></div>
<div class="ttc" id="asys_8h_html_aa0fbad346b8cec314ebf444c564ffa02"><div class="ttname"><a href="sys_8h.html#aa0fbad346b8cec314ebf444c564ffa02">Sys_DirtyTime</a></div><div class="ttdeci">double Sys_DirtyTime(void)</div><div class="ttdef"><b>Definition</b> <a href="sys__shared_8c_source.html#l00408">sys_shared.c:408</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a54bf4c38d481347e97316d106fb793f3" name="a54bf4c38d481347e97316d106fb793f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54bf4c38d481347e97316d106fb793f3">&#9670;&#160;</a></span>Crypto_ServerParsePacket_Internal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_ServerParsePacket_Internal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01727">1727</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1728</span>{</div>
<div class="line"><span class="lineno"> 1729</span>    <span class="comment">// if &quot;connect&quot;: reject if in the middle of crypto handshake</span></div>
<div class="line"><span class="lineno"> 1730</span>    <a class="code hl_struct" href="structcrypto__t.html">crypto_t</a> *crypto = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1731</span>    <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 1732</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>;</div>
<div class="line"><span class="lineno"> 1733</span>    <span class="keywordtype">int</span> aeslevel;</div>
<div class="line"><span class="lineno"> 1734</span>    <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a>;</div>
<div class="line"><span class="lineno"> 1735</span>    <a class="code hl_define" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno"> 1736</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>[<a class="code hl_define" href="qdefs_8h.html#a119f8457078d7390fb45ea0838adb806">MAX_INPUTLINE</a>];</div>
<div class="line"><span class="lineno"> 1737</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>[1024];</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1740</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>; <span class="comment">// no support</span></div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt; 8 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;connect\\&quot;</span>, 8) &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> &amp;&amp; <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt;= 3)</div>
<div class="line"><span class="lineno"> 1743</span>    {</div>
<div class="line"><span class="lineno"> 1744</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1745</span>        <span class="comment">// sorry, we have to verify the challenge here to not reflect network spam</span></div>
<div class="line"><span class="lineno"> 1746</span> </div>
<div class="line"><span class="lineno"> 1747</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;challenge&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 1748</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>; <span class="comment">// will be later accepted if encryption was set up</span></div>
<div class="line"><span class="lineno"> 1749</span>        <span class="comment">// validate the challenge</span></div>
<div class="line"><span class="lineno"> 1750</span>        <span class="keywordflow">for</span> (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="netconn_8h.html#afa0a30f86487a7fbb0a36853e4f6e104">MAX_CHALLENGES</a>;<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><span class="lineno"> 1751</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="netconn_8c.html#a5e54cf29fb37082e7ce4439cddc802fd">challenges</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].time &gt; 0)</div>
<div class="line"><span class="lineno"> 1752</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(peeraddress, &amp;<a class="code hl_variable" href="netconn_8c.html#a5e54cf29fb37082e7ce4439cddc802fd">challenges</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].address) &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="netconn_8c.html#a5e54cf29fb37082e7ce4439cddc802fd">challenges</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<span class="keywordtype">string</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>))</div>
<div class="line"><span class="lineno"> 1753</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1754</span>        <span class="comment">// if the challenge is not recognized, drop the packet</span></div>
<div class="line"><span class="lineno"> 1755</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == <a class="code hl_define" href="netconn_8h.html#afa0a30f86487a7fbb0a36853e4f6e104">MAX_CHALLENGES</a>) <span class="comment">// challenge mismatch is silent</span></div>
<div class="line"><span class="lineno"> 1756</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;missing challenge in connect&quot;</span>);</div>
<div class="line"><span class="lineno"> 1757</span> </div>
<div class="line"><span class="lineno"> 1758</span>        crypto = <a class="code hl_function" href="crypto_8c.html#ae33a7c8f188fd12df9099e15fb7aa682">Crypto_ServerFindInstance</a>(peeraddress, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1759</span>        <span class="keywordflow">if</span>(!crypto || !crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a>)</div>
<div class="line"><span class="lineno"> 1760</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires authentication and encryption to be supported by your client&quot;</span>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1761</span>    }</div>
<div class="line"><span class="lineno"> 1762</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a> &gt; 5 &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;d0pk\\&quot;</span>, 5) &amp;&amp; ((<a class="code hl_function" href="lhnet_8h.html#abc7dd16b78670fc52acefcd5df2b88e7">LHNETADDRESS_GetAddressType</a>(peeraddress) == <a class="code hl_enumvalue" href="lhnet_8h.html#aaf5f00c130fe2e819ddbe3e46cf84183afbc53a768575dbd36416369f993db8fe">LHNETADDRESSTYPE_LOOP</a>) || <a class="code hl_variable" href="netconn_8c.html#a19ac50fe68d1f3cd1f9cdd2d09349468">sv_public</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> &gt; -3))</div>
<div class="line"><span class="lineno"> 1763</span>    {</div>
<div class="line"><span class="lineno"> 1764</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, *p;</div>
<div class="line"><span class="lineno"> 1765</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a>;</div>
<div class="line"><span class="lineno"> 1766</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> = -1, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> = -1;</div>
<div class="line"><span class="lineno"> 1767</span>        <span class="keywordtype">id</span> = (<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;id&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)) ? <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>) : -1);</div>
<div class="line"><span class="lineno"> 1768</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a> = (<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;cnt&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)) ? <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a> : <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1769</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>)</div>
<div class="line"><span class="lineno"> 1770</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;missing cnt in d0pk&quot;</span>);</div>
<div class="line"><span class="lineno"> 1771</span>        <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 1772</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>)</div>
<div class="line"><span class="lineno"> 1773</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;missing appended data in d0pk&quot;</span>);</div>
<div class="line"><span class="lineno"> 1774</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;0&quot;</span>))</div>
<div class="line"><span class="lineno"> 1775</span>        {</div>
<div class="line"><span class="lineno"> 1776</span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1777</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;challenge&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 1778</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;missing challenge in d0pk\\0&quot;</span>);</div>
<div class="line"><span class="lineno"> 1779</span>            <span class="comment">// validate the challenge</span></div>
<div class="line"><span class="lineno"> 1780</span>            <span class="keywordflow">for</span> (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="netconn_8h.html#afa0a30f86487a7fbb0a36853e4f6e104">MAX_CHALLENGES</a>;<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><span class="lineno"> 1781</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="netconn_8c.html#a5e54cf29fb37082e7ce4439cddc802fd">challenges</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].time &gt; 0)</div>
<div class="line"><span class="lineno"> 1782</span>                    <span class="keywordflow">if</span> (!<a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(peeraddress, &amp;<a class="code hl_variable" href="netconn_8c.html#a5e54cf29fb37082e7ce4439cddc802fd">challenges</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].address) &amp;&amp; !<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="netconn_8c.html#a5e54cf29fb37082e7ce4439cddc802fd">challenges</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<span class="keywordtype">string</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>))</div>
<div class="line"><span class="lineno"> 1783</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1784</span>            <span class="comment">// if the challenge is not recognized, drop the packet</span></div>
<div class="line"><span class="lineno"> 1785</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> == <a class="code hl_define" href="netconn_8h.html#afa0a30f86487a7fbb0a36853e4f6e104">MAX_CHALLENGES</a>)</div>
<div class="line"><span class="lineno"> 1786</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;invalid challenge in d0pk\\0&quot;</span>);</div>
<div class="line"><span class="lineno"> 1787</span> </div>
<div class="line"><span class="lineno"> 1788</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="com__infostring_8c.html#aa001d512a0f3228d202a4c8b47aa7984">InfoString_GetValue</a>(<span class="keywordtype">string</span> + 4, <span class="stringliteral">&quot;aeslevel&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>)))</div>
<div class="line"><span class="lineno"> 1789</span>                aeslevel = 0; <span class="comment">// not supported</span></div>
<div class="line"><span class="lineno"> 1790</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1791</span>                aeslevel = <a class="code hl_define" href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a>(0, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">atoi</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">infostringvalue</a>), 3);</div>
<div class="line"><span class="lineno"> 1792</span>            <span class="keywordflow">switch</span>(<a class="code hl_define" href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a>(0, <a class="code hl_variable" href="crypto_8c.html#ac8f343ad0620ecc82d3eb9a52c3ecfb6">d0_rijndael_dll</a> ? <a class="code hl_variable" href="crypto_8c.html#aa6a8e5916e25ff44b9ed67996dba0068">crypto_aeslevel</a>.<a class="code hl_variable" href="structcvar__t.html#a376ca13f147f306d71edbe7670e138b0">integer</a> : 0, 3))</div>
<div class="line"><span class="lineno"> 1793</span>            {</div>
<div class="line"><span class="lineno"> 1794</span>                <span class="keywordflow">default</span>: <span class="comment">// dummy, never happens, but to make gcc happy...</span></div>
<div class="line"><span class="lineno"> 1795</span>                <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno"> 1796</span>                    <span class="keywordflow">if</span>(aeslevel &gt;= 3)</div>
<div class="line"><span class="lineno"> 1797</span>                        <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be not required (crypto_aeslevel &lt;= 2)&quot;</span>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1798</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1799</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1800</span>                <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno"> 1801</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = (aeslevel &gt;= 2);</div>
<div class="line"><span class="lineno"> 1802</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1803</span>                <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno"> 1804</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = (aeslevel &gt;= 1);</div>
<div class="line"><span class="lineno"> 1805</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1806</span>                <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno"> 1807</span>                    <span class="keywordflow">if</span>(aeslevel &lt;= 0)</div>
<div class="line"><span class="lineno"> 1808</span>                        <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;This server requires encryption to be supported (crypto_aeslevel &gt;= 1, and d0_rijndael library must be present)&quot;</span>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1809</span>                    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1810</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1811</span>            }</div>
<div class="line"><span class="lineno"> 1812</span> </div>
<div class="line"><span class="lineno"> 1813</span>            p = <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 1814</span>            <span class="keywordflow">if</span>(p &amp;&amp; *p)</div>
<div class="line"><span class="lineno"> 1815</span>            {</div>
<div class="line"><span class="lineno"> 1816</span>                <span class="comment">// Find the highest numbered matching key for p.</span></div>
<div class="line"><span class="lineno"> 1817</span>                <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1818</span>                {</div>
<div class="line"><span class="lineno"> 1819</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 1820</span>                        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(p, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><span class="lineno"> 1821</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 1822</span>                                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1823</span>                }</div>
<div class="line"><span class="lineno"> 1824</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 1825</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Invalid server key&quot;</span>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1826</span>            }</div>
<div class="line"><span class="lineno"> 1827</span>            p = <a class="code hl_function" href="crypto_8c.html#ae86e7e74ff72144661d72e3a6d347cdc">GetUntilNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>);</div>
<div class="line"><span class="lineno"> 1828</span>            <span class="keywordflow">if</span>(p &amp;&amp; *p)</div>
<div class="line"><span class="lineno"> 1829</span>            {</div>
<div class="line"><span class="lineno"> 1830</span>                <span class="comment">// Find the highest numbered matching key for p.</span></div>
<div class="line"><span class="lineno"> 1831</span>                <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1832</span>                {</div>
<div class="line"><span class="lineno"> 1833</span>                    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno"> 1834</span>                        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(p, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><span class="lineno"> 1835</span>                            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> = <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1836</span>                }</div>
<div class="line"><span class="lineno"> 1837</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 1838</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Invalid client key&quot;</span>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1839</span>            }</div>
<div class="line"><span class="lineno"> 1840</span> </div>
<div class="line"><span class="lineno"> 1841</span>            crypto = <a class="code hl_function" href="crypto_8c.html#ae33a7c8f188fd12df9099e15fb7aa682">Crypto_ServerFindInstance</a>(peeraddress, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1842</span>            <span class="keywordflow">if</span>(!crypto)</div>
<div class="line"><span class="lineno"> 1843</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Could not create a crypto connect instance&quot;</span>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1844</span>            <a class="code hl_define" href="crypto_8c.html#a9e2d859ffde566232fcd3e099be1acc9">MAKE_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1845</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id = <a class="code hl_variable" href="glquake_8h.html#a004e0b0e92ed2f6e1c9993f0271ebfb3">id</a>;</div>
<div class="line"><span class="lineno"> 1846</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">serverid</a>;</div>
<div class="line"><span class="lineno"> 1847</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">clientid</a>;</div>
<div class="line"><span class="lineno"> 1848</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, 0, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>));</div>
<div class="line"><span class="lineno"> 1849</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;challenge[0] = 0;</div>
<div class="line"><span class="lineno"> 1850</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 1851</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 1852</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 1853</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 1854</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">aes</a> != 0;</div>
<div class="line"><span class="lineno"> 1855</span> </div>
<div class="line"><span class="lineno"> 1856</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s &gt;= 0)</div>
<div class="line"><span class="lineno"> 1857</span>            {</div>
<div class="line"><span class="lineno"> 1858</span>                <span class="comment">// I am the server, and my key is ok... so let&#39;s set server_keyfp and server_idfp</span></div>
<div class="line"><span class="lineno"> 1859</span>                <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a318251b45f735d3bfddd12838c89cfc4">server_keyfp</a>));</div>
<div class="line"><span class="lineno"> 1860</span>                <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>, <a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad495ade07da51add51fdcfa3763866bd">server_idfp</a>));</div>
<div class="line"><span class="lineno"> 1861</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a46738359a9a1d657faa7a94313d6aa1f">server_issigned</a> = <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s];</div>
<div class="line"><span class="lineno"> 1862</span> </div>
<div class="line"><span class="lineno"> 1863</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 1864</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id = <a class="code hl_variable" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a>();</div>
<div class="line"><span class="lineno"> 1865</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 1866</span>                {</div>
<div class="line"><span class="lineno"> 1867</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1868</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_new failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1869</span>                }</div>
<div class="line"><span class="lineno"> 1870</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;s]))</div>
<div class="line"><span class="lineno"> 1871</span>                {</div>
<div class="line"><span class="lineno"> 1872</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1873</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1874</span>                }</div>
<div class="line"><span class="lineno"> 1875</span>                <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\1\\id\\%d\\aes\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a>));</div>
<div class="line"><span class="lineno"> 1876</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;XONOTIC&quot;</span>, 8, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>)) <span class="comment">// len_out receives used size by this op</span></div>
<div class="line"><span class="lineno"> 1877</span>                {</div>
<div class="line"><span class="lineno"> 1878</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1879</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_start failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1880</span>                }</div>
<div class="line"><span class="lineno"> 1881</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 2;</div>
<div class="line"><span class="lineno"> 1882</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 1883</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 1884</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 1885</span>            }</div>
<div class="line"><span class="lineno"> 1886</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c &gt;= 0)</div>
<div class="line"><span class="lineno"> 1887</span>            {</div>
<div class="line"><span class="lineno"> 1888</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 1889</span>                    <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id = <a class="code hl_variable" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a>();</div>
<div class="line"><span class="lineno"> 1890</span>                <span class="keywordflow">if</span>(!<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id)</div>
<div class="line"><span class="lineno"> 1891</span>                {</div>
<div class="line"><span class="lineno"> 1892</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1893</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_new failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1894</span>                }</div>
<div class="line"><span class="lineno"> 1895</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c]))</div>
<div class="line"><span class="lineno"> 1896</span>                {</div>
<div class="line"><span class="lineno"> 1897</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1898</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1899</span>                }</div>
<div class="line"><span class="lineno"> 1900</span>                <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\5\\id\\%d\\aes\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#affa2d958b3f1849e55ab9fd6a5f5c1b7">use_aes</a>));</div>
<div class="line"><span class="lineno"> 1901</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a238db7be954a2720b4646a56f416e7a5">qd0_blind_id_authenticate_with_private_id_challenge</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno"> 1902</span>                {</div>
<div class="line"><span class="lineno"> 1903</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1904</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_challenge failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1905</span>                }</div>
<div class="line"><span class="lineno"> 1906</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 6;</div>
<div class="line"><span class="lineno"> 1907</span>                <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 1908</span>                *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 1909</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 1910</span>            }</div>
<div class="line"><span class="lineno"> 1911</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1912</span>            {</div>
<div class="line"><span class="lineno"> 1913</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1914</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;Missing client and server key&quot;</span>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1915</span>            }</div>
<div class="line"><span class="lineno"> 1916</span>        }</div>
<div class="line"><span class="lineno"> 1917</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;2&quot;</span>))</div>
<div class="line"><span class="lineno"> 1918</span>        {</div>
<div class="line"><span class="lineno"> 1919</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>;</div>
<div class="line"><span class="lineno"> 1920</span>            crypto = <a class="code hl_function" href="crypto_8c.html#ae33a7c8f188fd12df9099e15fb7aa682">Crypto_ServerFindInstance</a>(peeraddress, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1921</span>            <span class="keywordflow">if</span>(!crypto)</div>
<div class="line"><span class="lineno"> 1922</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>; <span class="comment">// pre-challenge, rather be silent</span></div>
<div class="line"><span class="lineno"> 1923</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 1924</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 1925</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 1926</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 2)</div>
<div class="line"><span class="lineno"> 1927</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 1928</span> </div>
<div class="line"><span class="lineno"> 1929</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\3\\id\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 1930</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#aaf540674cda53b14bdd104f40759c386">qd0_blind_id_authenticate_with_private_id_response</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>))</div>
<div class="line"><span class="lineno"> 1931</span>            {</div>
<div class="line"><span class="lineno"> 1932</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1933</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_response failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1934</span>            }</div>
<div class="line"><span class="lineno"> 1935</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>;</div>
<div class="line"><span class="lineno"> 1936</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, (<span class="keywordtype">char</span> *) crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 1937</span>            {</div>
<div class="line"><span class="lineno"> 1938</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1939</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_sessionkey_public_id failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1940</span>            }</div>
<div class="line"><span class="lineno"> 1941</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c &gt;= 0)</div>
<div class="line"><span class="lineno"> 1942</span>            {</div>
<div class="line"><span class="lineno"> 1943</span>                <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c]))</div>
<div class="line"><span class="lineno"> 1944</span>                {</div>
<div class="line"><span class="lineno"> 1945</span>                    <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1946</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_copy failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1947</span>                }</div>
<div class="line"><span class="lineno"> 1948</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 4;</div>
<div class="line"><span class="lineno"> 1949</span>            }</div>
<div class="line"><span class="lineno"> 1950</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1951</span>            {</div>
<div class="line"><span class="lineno"> 1952</span>                <span class="comment">// session key is FINISHED (no server part is to be expected)! By this, all keys are set up</span></div>
<div class="line"><span class="lineno"> 1953</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1954</span>                <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 0;</div>
<div class="line"><span class="lineno"> 1955</span>            }</div>
<div class="line"><span class="lineno"> 1956</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 1957</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 1958</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 1959</span>        }</div>
<div class="line"><span class="lineno"> 1960</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;4&quot;</span>))</div>
<div class="line"><span class="lineno"> 1961</span>        {</div>
<div class="line"><span class="lineno"> 1962</span>            crypto = <a class="code hl_function" href="crypto_8c.html#ae33a7c8f188fd12df9099e15fb7aa682">Crypto_ServerFindInstance</a>(peeraddress, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1963</span>            <span class="keywordflow">if</span>(!crypto)</div>
<div class="line"><span class="lineno"> 1964</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>; <span class="comment">// pre-challenge, rather be silent</span></div>
<div class="line"><span class="lineno"> 1965</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 1966</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 1967</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 1968</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 4)</div>
<div class="line"><span class="lineno"> 1969</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 1970</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;d0pk\\cnt\\5\\id\\%d&quot;</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 1971</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a238db7be954a2720b4646a56f416e7a5">qd0_blind_id_authenticate_with_private_id_challenge</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno"> 1972</span>            {</div>
<div class="line"><span class="lineno"> 1973</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1974</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_challenge failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 1975</span>            }</div>
<div class="line"><span class="lineno"> 1976</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 6;</div>
<div class="line"><span class="lineno"> 1977</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> += *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>;</div>
<div class="line"><span class="lineno"> 1978</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 1979</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 1980</span>        }</div>
<div class="line"><span class="lineno"> 1981</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <span class="stringliteral">&quot;6&quot;</span>))</div>
<div class="line"><span class="lineno"> 1982</span>        {</div>
<div class="line"><span class="lineno"> 1983</span>            <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>[32];</div>
<div class="line"><span class="lineno"> 1984</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuflen</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>);</div>
<div class="line"><span class="lineno"> 1985</span>            <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>;</div>
<div class="line"><span class="lineno"> 1986</span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1987</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dhkey[<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>];</div>
<div class="line"><span class="lineno"> 1988</span>            crypto = <a class="code hl_function" href="crypto_8c.html#ae33a7c8f188fd12df9099e15fb7aa682">Crypto_ServerFindInstance</a>(peeraddress, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1989</span>            <span class="keywordflow">if</span>(!crypto)</div>
<div class="line"><span class="lineno"> 1990</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>; <span class="comment">// pre-challenge, rather be silent</span></div>
<div class="line"><span class="lineno"> 1991</span>            <span class="keywordflow">if</span>(<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><span class="lineno"> 1992</span>                <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id != <span class="keywordtype">id</span>)</div>
<div class="line"><span class="lineno"> 1993</span>                    <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\id\\%d when expecting %d&quot;</span>, <span class="keywordtype">id</span>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;cdata_id));</div>
<div class="line"><span class="lineno"> 1994</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step != 6)</div>
<div class="line"><span class="lineno"> 1995</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <a class="code hl_function" href="common_8c.html#a4a8220fa88226bf9cf39b12a051a20d7">va</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">vabuf</a>), <span class="stringliteral">&quot;Got d0pk\\cnt\\%s when expecting %d&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">cnt</a>, <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step));</div>
<div class="line"><span class="lineno"> 1996</span> </div>
<div class="line"><span class="lineno"> 1997</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#af57a05bc9b21589d745930acee39eb78">qd0_blind_id_authenticate_with_private_id_verify</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_in</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuf</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msgbuflen</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>))</div>
<div class="line"><span class="lineno"> 1998</span>            {</div>
<div class="line"><span class="lineno"> 1999</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2000</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_verify failed (authentication error)&quot;</span>, <span class="stringliteral">&quot;Authentication error&quot;</span>);</div>
<div class="line"><span class="lineno"> 2001</span>            }</div>
<div class="line"><span class="lineno"> 2002</span>            <a class="code hl_define" href="common_8h.html#aaef80d6b72e2476c82258733a8c4eced">dp_strlcpy</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>, <a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;c], <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a68057f781c7ef3efbb8dd9c2a3dbd816">client_keyfp</a>));</div>
<div class="line"><span class="lineno"> 2003</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#ad0f40ef405fc08dcc50822d8183a6d30">client_issigned</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>;</div>
<div class="line"><span class="lineno"> 2004</span> </div>
<div class="line"><span class="lineno"> 2005</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>, 0, <span class="keyword">sizeof</span>(crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>));</div>
<div class="line"><span class="lineno"> 2006</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>;</div>
<div class="line"><span class="lineno"> 2007</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a60ee73f814f37cb03ca6337d2c714eb2">client_idfp</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 2008</span>            {</div>
<div class="line"><span class="lineno"> 2009</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2010</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_fingerprint64_public_id failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 2011</span>            }</div>
<div class="line"><span class="lineno"> 2012</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a> = <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>;</div>
<div class="line"><span class="lineno"> 2013</span>            <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a>(<a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;id, (<span class="keywordtype">char</span> *) dhkey, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">fpbuflen</a>))</div>
<div class="line"><span class="lineno"> 2014</span>            {</div>
<div class="line"><span class="lineno"> 2015</span>                <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 2016</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;d0_blind_id_sessionkey_public_id failed&quot;</span>, <span class="stringliteral">&quot;Internal error&quot;</span>);</div>
<div class="line"><span class="lineno"> 2017</span>            }</div>
<div class="line"><span class="lineno"> 2018</span>            <span class="comment">// XOR the two DH keys together to make one</span></div>
<div class="line"><span class="lineno"> 2019</span>            <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 2020</span>                crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a62712966bbfd7a3b7a32b14291aaaa1c">dhkey</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^= dhkey[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno"> 2021</span> </div>
<div class="line"><span class="lineno"> 2022</span>            <span class="comment">// session key is FINISHED (no server part is to be expected)! By this, all keys are set up</span></div>
<div class="line"><span class="lineno"> 2023</span>            crypto-&gt;<a class="code hl_variable" href="structcrypto__t.html#a7f14ed53c5a1a67b9b2502b4662df228">authenticated</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2024</span>            <a class="code hl_define" href="crypto_8c.html#a72048b767e62a20b79bde41af5b4615c">CDATA</a>-&gt;next_step = 0;</div>
<div class="line"><span class="lineno"> 2025</span>            <span class="comment">// send a challenge-less challenge</span></div>
<div class="line"><span class="lineno"> 2026</span>            <a class="code hl_function" href="crypto_8c.html#a57d3d64d18e1c220988f7cff0053d630">PutWithNul</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>, <span class="stringliteral">&quot;challenge &quot;</span>);</div>
<div class="line"><span class="lineno"> 2027</span>            *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out_p</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_out</a>;</div>
<div class="line"><span class="lineno"> 2028</span>            --*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a>; <span class="comment">// remove NUL terminator</span></div>
<div class="line"><span class="lineno"> 2029</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a4bd8c06f696b570063fbead2f98c7c2c">CRYPTO_MATCH</a>;</div>
<div class="line"><span class="lineno"> 2030</span>        }</div>
<div class="line"><span class="lineno"> 2031</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>; <span class="comment">// pre-challenge, rather be silent</span></div>
<div class="line"><span class="lineno"> 2032</span>    }</div>
<div class="line"><span class="lineno"> 2033</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a8c7ff8f693d7a32873476640d01ecef3">CRYPTO_NOMATCH</a>;</div>
<div class="line"><span class="lineno"> 2034</span>}</div>
<div class="ttc" id="acrypto_8c_html_a47f01fa09e28a809c2bf17a9bf68fafb"><div class="ttname"><a href="crypto_8c.html#a47f01fa09e28a809c2bf17a9bf68fafb">Crypto_ServerError</a></div><div class="ttdeci">static int Crypto_ServerError(char *data_out, size_t *len_out, const char *msg, const char *msg_client)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01709">crypto.c:1709</a></div></div>
<div class="ttc" id="acrypto_8c_html_a93c0105d4befc97770091006feafb4d6"><div class="ttname"><a href="crypto_8c.html#a93c0105d4befc97770091006feafb4d6">Crypto_SoftServerError</a></div><div class="ttdeci">static int Crypto_SoftServerError(char *data_out, size_t *len_out, const char *msg)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l01720">crypto.c:1720</a></div></div>
<div class="ttc" id="acrypto_8h_html_a4bd8c06f696b570063fbead2f98c7c2c"><div class="ttname"><a href="crypto_8h.html#a4bd8c06f696b570063fbead2f98c7c2c">CRYPTO_MATCH</a></div><div class="ttdeci">#define CRYPTO_MATCH</div><div class="ttdef"><b>Definition</b> <a href="crypto_8h_source.html#l00065">crypto.h:65</a></div></div>
<div class="ttc" id="alhnet_8h_html_aaf5f00c130fe2e819ddbe3e46cf84183afbc53a768575dbd36416369f993db8fe"><div class="ttname"><a href="lhnet_8h.html#aaf5f00c130fe2e819ddbe3e46cf84183afbc53a768575dbd36416369f993db8fe">LHNETADDRESSTYPE_LOOP</a></div><div class="ttdeci">@ LHNETADDRESSTYPE_LOOP</div><div class="ttdef"><b>Definition</b> <a href="lhnet_8h_source.html#l00013">lhnet.h:13</a></div></div>
<div class="ttc" id="alhnet_8h_html_abc7dd16b78670fc52acefcd5df2b88e7"><div class="ttname"><a href="lhnet_8h.html#abc7dd16b78670fc52acefcd5df2b88e7">LHNETADDRESS_GetAddressType</a></div><div class="ttdeci">static lhnetaddresstype_t LHNETADDRESS_GetAddressType(const lhnetaddress_t *address)</div><div class="ttdef"><b>Definition</b> <a href="lhnet_8h_source.html#l00031">lhnet.h:31</a></div></div>
<div class="ttc" id="anetconn_8c_html_a19ac50fe68d1f3cd1f9cdd2d09349468"><div class="ttname"><a href="netconn_8c.html#a19ac50fe68d1f3cd1f9cdd2d09349468">sv_public</a></div><div class="ttdeci">cvar_t sv_public</div><div class="ttdef"><b>Definition</b> <a href="netconn_8c_source.html#l00036">netconn.c:36</a></div></div>
<div class="ttc" id="anetconn_8c_html_a5e54cf29fb37082e7ce4439cddc802fd"><div class="ttname"><a href="netconn_8c.html#a5e54cf29fb37082e7ce4439cddc802fd">challenges</a></div><div class="ttdeci">challenge_t challenges[MAX_CHALLENGES]</div><div class="ttdef"><b>Definition</b> <a href="netconn_8c_source.html#l00119">netconn.c:119</a></div></div>
<div class="ttc" id="anetconn_8h_html_afa0a30f86487a7fbb0a36853e4f6e104"><div class="ttname"><a href="netconn_8h.html#afa0a30f86487a7fbb0a36853e4f6e104">MAX_CHALLENGES</a></div><div class="ttdeci">#define MAX_CHALLENGES</div><div class="ttdef"><b>Definition</b> <a href="netconn_8h_source.html#l00476">netconn.h:476</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02036">Crypto_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="aa55a704ba907e52ab40b463e8dcdee49" name="aa55a704ba907e52ab40b463e8dcdee49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa55a704ba907e52ab40b463e8dcdee49">&#9670;&#160;</a></span>Crypto_Shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_Shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01043">1043</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1044</span>{</div>
<div class="line"><span class="lineno"> 1045</span>    <a class="code hl_struct" href="structcrypto__t.html">crypto_t</a> *crypto;</div>
<div class="line"><span class="lineno"> 1046</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>    <a class="code hl_function" href="crypto_8c.html#aad54f544f3250410db6aff02f795c322">Crypto_Rijndael_CloseLibrary</a>();</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno"> 1051</span>    {</div>
<div class="line"><span class="lineno"> 1052</span>        <span class="comment">// free memory</span></div>
<div class="line"><span class="lineno"> 1053</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1054</span>        {</div>
<div class="line"><span class="lineno"> 1055</span>            crypto = &amp;<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code hl_variable" href="structserver__cryptoconnect__t.html#a0619ecaf62b280776937a4125c543ad2">crypto</a>;</div>
<div class="line"><span class="lineno"> 1056</span>            <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1057</span>        }</div>
<div class="line"><span class="lineno"> 1058</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa4630d2842fd947361b293e0102b7205">cryptoconnects</a>));</div>
<div class="line"><span class="lineno"> 1059</span>        crypto = &amp;<a class="code hl_variable" href="cl__main_8c.html#ab4b4e0f12a72d330ee0869bdf1b372cd">cls</a>.<a class="code hl_variable" href="structclient__static__t.html#a6b1b21c226c99c9d1e972dc080ee1855">crypto</a>;</div>
<div class="line"><span class="lineno"> 1060</span>        <a class="code hl_define" href="crypto_8c.html#ae0749fdaf63ce66fa265a6eb1d352a36">CLEAR_CDATA</a>;</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>        <a class="code hl_function" href="crypto_8c.html#ab82a547776a3b80b6f0a2c04b428e49b">Crypto_UnloadKeys</a>();</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>        <a class="code hl_variable" href="crypto_8c.html#a71fc08325ecf3532fc19e05a46b2d295">qd0_blind_id_SHUTDOWN</a>();</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>        <a class="code hl_function" href="crypto_8c.html#acdd38a734f1d86b5075d6d6a82c71b7b">Crypto_CloseLibrary</a>();</div>
<div class="line"><span class="lineno"> 1067</span>    }</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>    <a class="code hl_define" href="zone_8h.html#a07374e605d328a588d2d738a56608ead">Mem_FreePool</a>(&amp;<a class="code hl_variable" href="crypto_8c.html#a473d64350b7902deaac13e21f96f11d8">cryptomempool</a>);</div>
<div class="line"><span class="lineno"> 1070</span>}</div>
<div class="ttc" id="acrypto_8c_html_a71fc08325ecf3532fc19e05a46b2d295"><div class="ttname"><a href="crypto_8c.html#a71fc08325ecf3532fc19e05a46b2d295">qd0_blind_id_SHUTDOWN</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_SHUTDOWN)(void)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00229">crypto.c:229</a></div></div>
<div class="ttc" id="azone_8h_html_a07374e605d328a588d2d738a56608ead"><div class="ttname"><a href="zone_8h.html#a07374e605d328a588d2d738a56608ead">Mem_FreePool</a></div><div class="ttdeci">#define Mem_FreePool(pool)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00105">zone.h:105</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="host_8c_source.html#l00573">Host_Shutdown()</a>.</p>

</div>
</div>
<a id="a3f6808cc09c495f2c6eb4bdf1eedbd68" name="a3f6808cc09c495f2c6eb4bdf1eedbd68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f6808cc09c495f2c6eb4bdf1eedbd68">&#9670;&#160;</a></span>Crypto_SignData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> Crypto_SignData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>datasize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>signed_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>signed_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02634">2634</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2635</span>{</div>
<div class="line"><span class="lineno"> 2636</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyid &lt; 0 || keyid &gt;</a>= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>)</div>
<div class="line"><span class="lineno"> 2637</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2638</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[keyid])</div>
<div class="line"><span class="lineno"> 2639</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2640</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#a053fe3ee2c82148ddb847da9f7e20f71">qd0_blind_id_sign_with_private_id_sign</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[keyid], <span class="keyword">true</span>, <span class="keyword">false</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">datasize</a>, (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_data</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>))</div>
<div class="line"><span class="lineno"> 2641</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>;</div>
<div class="line"><span class="lineno"> 2642</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2643</span>}</div>
<div class="ttc" id="acrypto_8c_html_a053fe3ee2c82148ddb847da9f7e20f71"><div class="ttname"><a href="crypto_8c.html#a053fe3ee2c82148ddb847da9f7e20f71">qd0_blind_id_sign_with_private_id_sign</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_sign_with_private_id_sign)(d0_blind_id_t *ctx, D0_BOOL is_first, D0_BOOL send_modulus, const char *message, size_t msglen, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00231">crypto.c:231</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad247271fff8b625706df45f83222d8ba" name="ad247271fff8b625706df45f83222d8ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad247271fff8b625706df45f83222d8ba">&#9670;&#160;</a></span>Crypto_SignDataDetached()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> Crypto_SignDataDetached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>datasize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>keyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> *&#160;</td>
          <td class="paramname"><em>signed_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>signed_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02645">2645</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2646</span>{</div>
<div class="line"><span class="lineno"> 2647</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyid &lt; 0 || keyid &gt;</a>= <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>)</div>
<div class="line"><span class="lineno"> 2648</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2649</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[keyid])</div>
<div class="line"><span class="lineno"> 2650</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2651</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#aa7ad86a0d8f95960c08726067fe9831e">qd0_blind_id_sign_with_private_id_sign_detached</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[keyid], <span class="keyword">true</span>, <span class="keyword">false</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">datasize</a>, (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_data</a>, &amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>))</div>
<div class="line"><span class="lineno"> 2652</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">signed_size</a>;</div>
<div class="line"><span class="lineno"> 2653</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2654</span>}</div>
<div class="ttc" id="acrypto_8c_html_aa7ad86a0d8f95960c08726067fe9831e"><div class="ttname"><a href="crypto_8c.html#aa7ad86a0d8f95960c08726067fe9831e">qd0_blind_id_sign_with_private_id_sign_detached</a></div><div class="ttdeci">static D0_EXPORT D0_WARN_UNUSED_RESULT D0_BOOL(* qd0_blind_id_sign_with_private_id_sign_detached)(d0_blind_id_t *ctx, D0_BOOL is_first, D0_BOOL send_modulus, const char *message, size_t msglen, char *outbuf, size_t *outbuflen)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00232">crypto.c:232</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="prvm__cmds_8c_source.html#l05427">VM_uri_get()</a>.</p>

</div>
</div>
<a id="aca5468ecb996a99a78f68985d23a085d" name="aca5468ecb996a99a78f68985d23a085d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca5468ecb996a99a78f68985d23a085d">&#9670;&#160;</a></span>Crypto_SoftClientError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_SoftClientError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l02100">2100</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2101</span>{</div>
<div class="line"><span class="lineno"> 2102</span>    *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = 0;</div>
<div class="line"><span class="lineno"> 2103</span>    <a class="code hl_function" href="console_8c.html#a2696300802453d9333e9f52e5fae15bc">Con_DPrintf</a>(<span class="stringliteral">&quot;%s\n&quot;</span>, msg);</div>
<div class="line"><span class="lineno"> 2104</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 2105</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>.</p>

</div>
</div>
<a id="a93c0105d4befc97770091006feafb4d6" name="a93c0105d4befc97770091006feafb4d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93c0105d4befc97770091006feafb4d6">&#9670;&#160;</a></span>Crypto_SoftServerError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> Crypto_SoftServerError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01720">1720</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1721</span>{</div>
<div class="line"><span class="lineno"> 1722</span>    *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">len_out</a> = 0;</div>
<div class="line"><span class="lineno"> 1723</span>    <a class="code hl_function" href="console_8c.html#a2696300802453d9333e9f52e5fae15bc">Con_DPrintf</a>(<span class="stringliteral">&quot;%s\n&quot;</span>, msg);</div>
<div class="line"><span class="lineno"> 1724</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="crypto_8h.html#a1efd20cc345410a8f68978ece41aac10">CRYPTO_DISCARD</a>;</div>
<div class="line"><span class="lineno"> 1725</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="aaf812a19119a94ac6d13e6c6f241e7ad" name="aaf812a19119a94ac6d13e6c6f241e7ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf812a19119a94ac6d13e6c6f241e7ad">&#9670;&#160;</a></span>Crypto_StoreHostKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_StoreHostKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlhnetaddress__t.html">lhnetaddress_t</a> *&#160;</td>
          <td class="paramname"><em>peeraddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>keystring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a>&#160;</td>
          <td class="paramname"><em>complain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00635">635</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  636</span>{</div>
<div class="line"><span class="lineno">  637</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[128];</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a>;</div>
<div class="line"><span class="lineno">  639</span>    <a class="code hl_struct" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>;</div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordtype">int</span> keyid;</div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordtype">char</span> idfp[<a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1];</div>
<div class="line"><span class="lineno">  642</span>    <span class="keywordtype">int</span> aeslevel;</div>
<div class="line"><span class="lineno">  643</span>    <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> issigned;</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="crypto_8c.html#a630ddbca1d559d1a461a73a5cf7851e0">d0_blind_id_dll</a>)</div>
<div class="line"><span class="lineno">  646</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  647</span>    </div>
<div class="line"><span class="lineno">  648</span>    <span class="comment">// syntax of keystring:</span></div>
<div class="line"><span class="lineno">  649</span>    <span class="comment">// aeslevel id@key id@key ...</span></div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    <span class="keywordflow">if</span>(!*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>)</div>
<div class="line"><span class="lineno">  652</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  653</span>    aeslevel = <a class="code hl_define" href="mathlib_8h.html#a553641b2aac0b2a7c43f9f74f8333fd5">bound</a>(0, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> - <span class="charliteral">&#39;0&#39;</span>, 3);</div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">while</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> &amp;&amp; *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> != <span class="charliteral">&#39; &#39;</span>)</div>
<div class="line"><span class="lineno">  655</span>        ++<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>;</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    keyid = -1;</div>
<div class="line"><span class="lineno">  658</span>    issigned = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordflow">while</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> &amp;&amp; keyid &lt; 0)</div>
<div class="line"><span class="lineno">  660</span>    {</div>
<div class="line"><span class="lineno">  661</span>        <span class="comment">// id@key</span></div>
<div class="line"><span class="lineno">  662</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idstart</a>, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idend</a>, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystart</a>, *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyend</a>;</div>
<div class="line"><span class="lineno">  663</span>        <a class="code hl_typedef" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thisissigned</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  664</span>        ++<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>; <span class="comment">// skip the space</span></div>
<div class="line"><span class="lineno">  665</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idstart</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>;</div>
<div class="line"><span class="lineno">  666</span>        <span class="keywordflow">while</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> &amp;&amp; *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> != <span class="charliteral">&#39; &#39;</span> &amp;&amp; *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> != <span class="charliteral">&#39;@&#39;</span>)</div>
<div class="line"><span class="lineno">  667</span>            ++<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>;</div>
<div class="line"><span class="lineno">  668</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idend</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>;</div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">if</span>(!*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>)</div>
<div class="line"><span class="lineno">  670</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  671</span>        ++<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>;</div>
<div class="line"><span class="lineno">  672</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystart</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>;</div>
<div class="line"><span class="lineno">  673</span>        <span class="keywordflow">while</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> &amp;&amp; *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a> != <span class="charliteral">&#39; &#39;</span>)</div>
<div class="line"><span class="lineno">  674</span>            ++<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>;</div>
<div class="line"><span class="lineno">  675</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyend</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystring</a>;</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystart</a>[0] == <span class="charliteral">&#39;~&#39;</span>)</div>
<div class="line"><span class="lineno">  678</span>        {</div>
<div class="line"><span class="lineno">  679</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thisissigned</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  680</span>            ++<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystart</a>;</div>
<div class="line"><span class="lineno">  681</span>        }</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idend</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idstart</a> == <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a> &amp;&amp; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keyend</a> - <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystart</a> == <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>)</div>
<div class="line"><span class="lineno">  684</span>        {</div>
<div class="line"><span class="lineno">  685</span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thiskeyid</a>;</div>
<div class="line"><span class="lineno">  686</span>            <span class="keywordflow">for</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thiskeyid</a> = <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a> - 1; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thiskeyid</a> &gt;= 0; --<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thiskeyid</a>)</div>
<div class="line"><span class="lineno">  687</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thiskeyid</a>])</div>
<div class="line"><span class="lineno">  688</span>                    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thiskeyid</a>], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keystart</a>, <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>))</div>
<div class="line"><span class="lineno">  689</span>                    {</div>
<div class="line"><span class="lineno">  690</span>                        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(idfp, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">idstart</a>, <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>);</div>
<div class="line"><span class="lineno">  691</span>                        idfp[<a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>] = 0;</div>
<div class="line"><span class="lineno">  692</span>                        keyid = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thiskeyid</a>;</div>
<div class="line"><span class="lineno">  693</span>                        issigned = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">thisissigned</a>;</div>
<div class="line"><span class="lineno">  694</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  695</span>                    }</div>
<div class="line"><span class="lineno">  696</span>            <span class="comment">// If this failed, keyid will be -1.</span></div>
<div class="line"><span class="lineno">  697</span>        }</div>
<div class="line"><span class="lineno">  698</span>    }</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>    <span class="keywordflow">if</span>(keyid &lt; 0)</div>
<div class="line"><span class="lineno">  701</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span>    <a class="code hl_function" href="lhnet_8c.html#a191c91d25271eed39a5eb76e2d8e5dde">LHNETADDRESS_ToString</a>(peeraddress, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>), 1);</div>
<div class="line"><span class="lineno">  704</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a> = <a class="code hl_function" href="com__crc16_8c.html#aa9ba811c20537ebd01898928be2de439">CRC_Block</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strlen</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>)) % <a class="code hl_define" href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a>;</div>
<div class="line"><span class="lineno">  705</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = <a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a>]; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> &amp;&amp; <a class="code hl_function" href="lhnet_8c.html#afcb50bceea3f2dc4d4c1663bb6d35e9e">LHNETADDRESS_Compare</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;addr, peeraddress); <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;next);</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>)</div>
<div class="line"><span class="lineno">  708</span>    {</div>
<div class="line"><span class="lineno">  709</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">complain</a>)</div>
<div class="line"><span class="lineno">  710</span>        {</div>
<div class="line"><span class="lineno">  711</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;keyid != keyid || <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcmp</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;idfp, idfp, <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1))</div>
<div class="line"><span class="lineno">  712</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Server %s tried to change the host key to a value not in the host cache. Connecting to it will fail. To accept the new host key, do crypto_hostkey_clear %s\n&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>);</div>
<div class="line"><span class="lineno">  713</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;aeslevel &gt; aeslevel)</div>
<div class="line"><span class="lineno">  714</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Server %s tried to reduce encryption status, not accepted. Connecting to it will fail. To accept, do crypto_hostkey_clear %s\n&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>);</div>
<div class="line"><span class="lineno">  715</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;issigned &gt; issigned)</div>
<div class="line"><span class="lineno">  716</span>                <a class="code hl_function" href="console_8c.html#a49b71fe9a87e57a440e07af4a869a9f6">Con_Printf</a>(<span class="stringliteral">&quot;Server %s tried to reduce signature status, not accepted. Connecting to it will fail. To accept, do crypto_hostkey_clear %s\n&quot;</span>, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, <a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>);</div>
<div class="line"><span class="lineno">  717</span>        }</div>
<div class="line"><span class="lineno">  718</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;aeslevel = <a class="code hl_define" href="mathlib_8h.html#a24e753bacac6be5f30e18f8a2bdefda4">max</a>(aeslevel, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;aeslevel);</div>
<div class="line"><span class="lineno">  719</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;issigned = issigned;</div>
<div class="line"><span class="lineno">  720</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  721</span>    }</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    <span class="comment">// great, we did NOT have it yet</span></div>
<div class="line"><span class="lineno">  724</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a> = (<a class="code hl_struct" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a> *) <a class="code hl_define" href="zone_8h.html#a35deb8ef816a08fb1bc8feac8db020c5">Z_Malloc</a>(<span class="keyword">sizeof</span>(*<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>));</div>
<div class="line"><span class="lineno">  725</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;addr, peeraddress, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;addr));</div>
<div class="line"><span class="lineno">  726</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;keyid = keyid;</div>
<div class="line"><span class="lineno">  727</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;idfp, idfp, <a class="code hl_define" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1);</div>
<div class="line"><span class="lineno">  728</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;next = <a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a>];</div>
<div class="line"><span class="lineno">  729</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;<a class="code hl_variable" href="structcrypto__storedhostkey__t.html#ad2b79a34bad9fe27f43de0b51e189c88">aeslevel</a> = aeslevel;</div>
<div class="line"><span class="lineno">  730</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>-&gt;issigned = issigned;</div>
<div class="line"><span class="lineno">  731</span>    <a class="code hl_variable" href="crypto_8c.html#ab8a64f8aefe35f96d148557fb2e090db">crypto_storedhostkey_hashtable</a>[<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hashindex</a>] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">hk</a>;</div>
<div class="line"><span class="lineno">  732</span>}</div>
<div class="ttc" id="astructcrypto__storedhostkey__t_html_ad2b79a34bad9fe27f43de0b51e189c88"><div class="ttname"><a href="structcrypto__storedhostkey__t.html#ad2b79a34bad9fe27f43de0b51e189c88">crypto_storedhostkey_t::aeslevel</a></div><div class="ttdeci">int aeslevel</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00585">crypto.c:585</a></div></div>
<div class="ttc" id="azone_8h_html_a35deb8ef816a08fb1bc8feac8db020c5"><div class="ttname"><a href="zone_8h.html#a35deb8ef816a08fb1bc8feac8db020c5">Z_Malloc</a></div><div class="ttdeci">#define Z_Malloc(size)</div><div class="ttdef"><b>Definition</b> <a href="zone_8h_source.html#l00161">zone.h:161</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>.</p>

</div>
</div>
<a id="ae7aaba47178e17c579b18b5d27b4bb83" name="ae7aaba47178e17c579b18b5d27b4bb83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7aaba47178e17c579b18b5d27b4bb83">&#9670;&#160;</a></span>Crypto_UnLittleLong()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_UnLittleLong </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a>&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00068">68</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>{</div>
<div class="line"><span class="lineno">   70</span>    <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[0] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a> &amp; 0xFF;</div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[1] = (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a> &gt;&gt; 8) &amp; 0xFF;</div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[2] = (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a> &gt;&gt; 16) &amp; 0xFF;</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>[3] = (<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a> &gt;&gt; 24) &amp; 0xFF;</div>
<div class="line"><span class="lineno">   74</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00785">Crypto_BuildChallengeAppend()</a>, and <a class="el" href="crypto_8c_source.html#l00103">Crypto_UnParsePack()</a>.</p>

</div>
</div>
<a id="ab82a547776a3b80b6f0a2c04b428e49b" name="ab82a547776a3b80b6f0a2c04b428e49b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab82a547776a3b80b6f0a2c04b428e49b">&#9670;&#160;</a></span>Crypto_UnloadKeys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> Crypto_UnloadKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00985">985</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  986</span>{</div>
<div class="line"><span class="lineno">  987</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>    <a class="code hl_variable" href="crypto_8c.html#ae660e3db5e569c5c606531a62f889148">keygen_i</a> = -1;</div>
<div class="line"><span class="lineno">  990</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_define" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  991</span>    {</div>
<div class="line"><span class="lineno">  992</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><span class="lineno">  993</span>            <a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>(<a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  994</span>        <a class="code hl_variable" href="crypto_8c.html#ad209fec4c56eb4b0966702b7452bd7db">pubkeys</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  995</span>        <a class="code hl_variable" href="crypto_8c.html#a97b4731bcda09762498f4c4ab8950eee">pubkeys_havepriv</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  996</span>        <a class="code hl_variable" href="crypto_8c.html#a95d40b2f3505629533c24fcfc912854c">pubkeys_havesig</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  997</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><span class="lineno">  998</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memset</a>(<a class="code hl_variable" href="crypto_8c.html#a48cd47ff384a225c07aae1505db8c269">pubkeys_priv_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="crypto_8c.html#aa88008abe3af1f6fb6c5596928082e4e">pubkeys_fp64</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><span class="lineno">  999</span>        <a class="code hl_variable" href="crypto_8c.html#a5d332095b22ac949589bca1293869cb2">challenge_append_length</a> = 0;</div>
<div class="line"><span class="lineno"> 1000</span>    }</div>
<div class="line"><span class="lineno"> 1001</span>    <a class="code hl_variable" href="crypto_8c.html#a9e167138d96bd0023ba86e401f27253a">crypto_idstring</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1002</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01373">Crypto_Reload_f()</a>, and <a class="el" href="crypto_8c_source.html#l01043">Crypto_Shutdown()</a>.</p>

</div>
</div>
<a id="a858dccc118582ddc67008845ede2a273" name="a858dccc118582ddc67008845ede2a273"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858dccc118582ddc67008845ede2a273">&#9670;&#160;</a></span>Crypto_UnParsePack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> Crypto_UnParsePack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a>&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> *&#160;</td>
          <td class="paramname"><em>lumps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>lumpsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>nlumps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00103">103</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  104</span>{</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordtype">size_t</span> pos;</div>
<div class="line"><span class="lineno">  107</span>    pos = 0;</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span>(header)</div>
<div class="line"><span class="lineno">  109</span>    {</div>
<div class="line"><span class="lineno">  110</span>        <span class="keywordflow">if</span>(len &lt; 4)</div>
<div class="line"><span class="lineno">  111</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  112</span>        <a class="code hl_function" href="crypto_8c.html#ae7aaba47178e17c579b18b5d27b4bb83">Crypto_UnLittleLong</a>(<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>, header);</div>
<div class="line"><span class="lineno">  113</span>        pos += 4;</div>
<div class="line"><span class="lineno">  114</span>    }</div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nlumps</a>; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno">  116</span>    {</div>
<div class="line"><span class="lineno">  117</span>        <span class="keywordflow">if</span>(pos + 4 + <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] &gt; len)</div>
<div class="line"><span class="lineno">  118</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  119</span>        <a class="code hl_function" href="crypto_8c.html#ae7aaba47178e17c579b18b5d27b4bb83">Crypto_UnLittleLong</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[pos], (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  120</span>        pos += 4;</div>
<div class="line"><span class="lineno">  121</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(&amp;<a class="code hl_variable" href="glquake_8h.html#ac0759919bfcf4c7222738ba583673a9e">buf</a>[pos], lumps[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><span class="lineno">  122</span>        pos += <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">lumpsize</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno">  123</span>    }</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">return</span> pos;</div>
<div class="line"><span class="lineno">  125</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, and <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>.</p>

</div>
</div>
<a id="ae86e7e74ff72144661d72e3a6d347cdc" name="ae86e7e74ff72144661d72e3a6d347cdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae86e7e74ff72144661d72e3a6d347cdc">&#9670;&#160;</a></span>GetUntilNul()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> * GetUntilNul </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> **&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00418">418</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  419</span>{</div>
<div class="line"><span class="lineno">  420</span>    <span class="comment">// invariant: data points to next character to take</span></div>
<div class="line"><span class="lineno">  421</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_save</a> = *<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>;</div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordtype">size_t</span> <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>;</div>
<div class="line"><span class="lineno">  423</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">if</span>(!*<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>)</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">if</span>(!*len)</div>
<div class="line"><span class="lineno">  429</span>    {</div>
<div class="line"><span class="lineno">  430</span>        *<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  431</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  432</span>    }</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    p = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memchr</a>(*<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, 0, *len);</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">if</span>(!p) <span class="comment">// no terminating NUL</span></div>
<div class="line"><span class="lineno">  436</span>    {</div>
<div class="line"><span class="lineno">  437</span>        *<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  438</span>        *len = 0;</div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  440</span>    }</div>
<div class="line"><span class="lineno">  441</span>    <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a> = (p - *<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>) + 1;</div>
<div class="line"><span class="lineno">  442</span>    *len -= <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>;</div>
<div class="line"><span class="lineno">  443</span>    *<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> += <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>;</div>
<div class="line"><span class="lineno">  444</span>    <span class="keywordflow">if</span>(*len == 0)</div>
<div class="line"><span class="lineno">  445</span>        *<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> = <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordflow">return</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">data_save</a>;</div>
<div class="line"><span class="lineno">  447</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="a57d3d64d18e1c220988f7cff0053d630" name="a57d3d64d18e1c220988f7cff0053d630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d3d64d18e1c220988f7cff0053d630">&#9670;&#160;</a></span>PutWithNul()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> PutWithNul </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> **&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00406">406</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  407</span>{</div>
<div class="line"><span class="lineno">  408</span>    <span class="comment">// invariant: data points to insertion point</span></div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">strlen</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">str</a>);</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a> &gt;= *len)</div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">memcpy</a>(*<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">str</a>, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>+1);</div>
<div class="line"><span class="lineno">  413</span>    *<a class="code hl_variable" href="glquake_8h.html#a820662f5b80a48256e2503352e9f51b9">data</a> += <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>+1;</div>
<div class="line"><span class="lineno">  414</span>    *len -= <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>+1;</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  416</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00785">Crypto_BuildChallengeAppend()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="a65bcc30d6b1ebadfcec50ca06f7bfac5" name="a65bcc30d6b1ebadfcec50ca06f7bfac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65bcc30d6b1ebadfcec50ca06f7bfac5">&#9670;&#160;</a></span>seacpy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">static</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> seacpy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01498">1498</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1499</span>{</div>
<div class="line"><span class="lineno"> 1500</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a> = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">iv</a>;</div>
<div class="line"><span class="lineno"> 1501</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>[16];</div>
<div class="line"><span class="lineno"> 1502</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>[<a class="code hl_define" href="crypto_8c.html#ae40679674b1d1578562cb4e1d13c48bb">D0_RIJNDAEL_RKLENGTH</a>(<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a> * 8)];</div>
<div class="line"><span class="lineno"> 1503</span>    <span class="keywordtype">size_t</span> <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><span class="lineno"> 1504</span>    <a class="code hl_variable" href="crypto_8c.html#a5a0fc4737467183933f83921685e1492">qd0_rijndael_setup_decrypt</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, key, <a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a> * 8);</div>
<div class="line"><span class="lineno"> 1505</span>    <span class="keywordflow">while</span>(len &gt; 16)</div>
<div class="line"><span class="lineno"> 1506</span>    {</div>
<div class="line"><span class="lineno"> 1507</span>        <a class="code hl_variable" href="crypto_8c.html#ac3c2380c084a6b13af5345dd3f3d1938">qd0_rijndael_decrypt</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="code hl_define" href="crypto_8c.html#aae3fa2cd7b52a90123438b9b4ea38efb">D0_RIJNDAEL_NROUNDS</a>(<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a> * 8), src, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>);</div>
<div class="line"><span class="lineno"> 1508</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 16; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1509</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^ <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno"> 1510</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a> = src;</div>
<div class="line"><span class="lineno"> 1511</span>        len -= 16;</div>
<div class="line"><span class="lineno"> 1512</span>        src += 16;</div>
<div class="line"><span class="lineno"> 1513</span>        <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a> += 16;</div>
<div class="line"><span class="lineno"> 1514</span>    }</div>
<div class="line"><span class="lineno"> 1515</span>    <span class="keywordflow">if</span>(len &gt; 0)</div>
<div class="line"><span class="lineno"> 1516</span>    {</div>
<div class="line"><span class="lineno"> 1517</span>        <a class="code hl_variable" href="crypto_8c.html#ac3c2380c084a6b13af5345dd3f3d1938">qd0_rijndael_decrypt</a>(<a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="code hl_define" href="crypto_8c.html#aae3fa2cd7b52a90123438b9b4ea38efb">D0_RIJNDAEL_NROUNDS</a>(<a class="code hl_define" href="crypto_8h.html#ad9de82069262439e7e921069abb457c1">DHKEY_SIZE</a> * 8), src, <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>);</div>
<div class="line"><span class="lineno"> 1518</span>        <span class="keywordflow">for</span>(<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; len; ++<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><span class="lineno"> 1519</span>            <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">dst</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorbuf</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^ <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">xorpos</a>[<a class="code hl_variable" href="prvm__execprogram_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><span class="lineno"> 1520</span>    }</div>
<div class="line"><span class="lineno"> 1521</span>}</div>
<div class="ttc" id="acrypto_8c_html_a5a0fc4737467183933f83921685e1492"><div class="ttname"><a href="crypto_8c.html#a5a0fc4737467183933f83921685e1492">qd0_rijndael_setup_decrypt</a></div><div class="ttdeci">D0_EXPORT int(* qd0_rijndael_setup_decrypt)(unsigned long *rk, const unsigned char *key, int keybits)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00332">crypto.c:332</a></div></div>
<div class="ttc" id="acrypto_8c_html_ac3c2380c084a6b13af5345dd3f3d1938"><div class="ttname"><a href="crypto_8c.html#ac3c2380c084a6b13af5345dd3f3d1938">qd0_rijndael_decrypt</a></div><div class="ttdeci">D0_EXPORT void(* qd0_rijndael_decrypt)(const unsigned long *rk, int nrounds, const unsigned char ciphertext[16], unsigned char plaintext[16])</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00336">crypto.c:336</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01584">Crypto_DecryptPacket()</a>.</p>

</div>
</div>
<a id="a61b0d8e49d857cf554e5db8c601c2be4" name="a61b0d8e49d857cf554e5db8c601c2be4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61b0d8e49d857cf554e5db8c601c2be4">&#9670;&#160;</a></span>sha256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a> sha256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00383">383</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  384</span>{</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_variable" href="crypto_8c.html#a62b44899185366951da0286b16f86f43">qd0_blind_id_util_sha256</a>((<span class="keywordtype">char</span> *) <a class="code hl_variable" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *) in, <a class="code hl_define" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>);</div>
<div class="line"><span class="lineno">  386</span>}</div>
<div class="ttc" id="acrypto_8c_html_a62b44899185366951da0286b16f86f43"><div class="ttname"><a href="crypto_8c.html#a62b44899185366951da0286b16f86f43">qd0_blind_id_util_sha256</a></div><div class="ttdeci">static D0_EXPORT void(* qd0_blind_id_util_sha256)(char *out, const char *in, size_t n)</div><div class="ttdef"><b>Definition</b> <a href="crypto_8c_source.html#l00230">crypto.c:230</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="prvm__cmds_8c_source.html#l05175">VM_digest_hex()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a09ddfceaa9b1578f414a3e3408ce7ea1" name="a09ddfceaa9b1578f414a3e3408ce7ea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09ddfceaa9b1578f414a3e3408ce7ea1">&#9670;&#160;</a></span>cdata_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> cdata_id = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00509">509</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>.</p>

</div>
</div>
<a id="a0a7166948fbca4aa370e98c8f64d139a" name="a0a7166948fbca4aa370e98c8f64d139a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a7166948fbca4aa370e98c8f64d139a">&#9670;&#160;</a></span>challenge_append</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> challenge_append[1400]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00487">487</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00785">Crypto_BuildChallengeAppend()</a>, and <a class="el" href="crypto_8c_source.html#l01696">Crypto_ServerAppendToChallenge()</a>.</p>

</div>
</div>
<a id="a5d332095b22ac949589bca1293869cb2" name="a5d332095b22ac949589bca1293869cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d332095b22ac949589bca1293869cb2">&#9670;&#160;</a></span>challenge_append_length</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> challenge_append_length</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00488">488</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00785">Crypto_BuildChallengeAppend()</a>, <a class="el" href="crypto_8c_source.html#l01696">Crypto_ServerAppendToChallenge()</a>, and <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>.</p>

</div>
</div>
<a id="aa6a8e5916e25ff44b9ed67996dba0068" name="aa6a8e5916e25ff44b9ed67996dba0068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6a8e5916e25ff44b9ed67996dba0068">&#9670;&#160;</a></span>crypto_aeslevel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcvar__t.html">cvar_t</a> crypto_aeslevel = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_aeslevel&quot;, &quot;1&quot;, &quot;whether to support <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">AES</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">encryption</a> in authenticated <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">connections</a> (0 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">no</a>, 1 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">supported</a>, 2 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">requested</a>, 3 = required)&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00031">31</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>{<a class="code hl_define" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="code hl_define" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="code hl_define" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, <span class="stringliteral">&quot;crypto_aeslevel&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;whether to support AES encryption in authenticated connections (0 = no, 1 = supported, 2 = requested, 3 = required)&quot;</span>};</div>
<div class="ttc" id="acmd_8h_html_aadf0879ce7511e76eeea9da766b31c6b"><div class="ttname"><a href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a></div><div class="ttdeci">#define CF_SERVER</div><div class="ttdoc">cvar/command that only the server can change/execute</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00049">cmd.h:49</a></div></div>
<div class="ttc" id="acmd_8h_html_abba64dce6a45541317c5508aa83436e5"><div class="ttname"><a href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a></div><div class="ttdeci">#define CF_CLIENT</div><div class="ttdoc">cvar/command that only the client can change/execute</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00048">cmd.h:48</a></div></div>
<div class="ttc" id="acmd_8h_html_aeeecb68995736ab90434173e64fd14e5"><div class="ttname"><a href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a></div><div class="ttdeci">#define CF_ARCHIVE</div><div class="ttdoc">cvar should have its set value saved to config.cfg and persist across sessions</div><div class="ttdef"><b>Definition</b> <a href="cmd_8h_source.html#l00053">cmd.h:53</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01689">Crypto_GetInfoResponseDataString()</a>, <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="a6f3d29a8d2e8a24dc51d47cba14aef9e" name="a6f3d29a8d2e8a24dc51d47cba14aef9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f3d29a8d2e8a24dc51d47cba14aef9e">&#9670;&#160;</a></span>crypto_developer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcvar__t.html">cvar_t</a> crypto_developer = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_developer&quot;, &quot;0&quot;, &quot;print <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">extra</a> info <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">about</a> crypto <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">handshake&quot;</a>}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00030">30</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   30</span>{<a class="code hl_define" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="code hl_define" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="code hl_define" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, <span class="stringliteral">&quot;crypto_developer&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <span class="stringliteral">&quot;print extra info about crypto handshake&quot;</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, and <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a9e167138d96bd0023ba86e401f27253a" name="a9e167138d96bd0023ba86e401f27253a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e167138d96bd0023ba86e401f27253a">&#9670;&#160;</a></span>crypto_idstring</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>* crypto_idstring = <a class="el" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00042">42</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l01689">Crypto_GetInfoResponseDataString()</a>, <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>, and <a class="el" href="netconn_8c_source.html#l02706">NetConn_BuildStatusResponse()</a>.</p>

</div>
</div>
<a id="a63426ba3da78d70b38153267dbe74ccc" name="a63426ba3da78d70b38153267dbe74ccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63426ba3da78d70b38153267dbe74ccc">&#9670;&#160;</a></span>crypto_idstring_buf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> crypto_idstring_buf[512]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00043">43</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l01689">Crypto_GetInfoResponseDataString()</a>, and <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>.</p>

</div>
</div>
<a id="a28bce26dd18684379882653e173b0188" name="a28bce26dd18684379882653e173b0188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28bce26dd18684379882653e173b0188">&#9670;&#160;</a></span>crypto_keyfp_recommended_length</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> crypto_keyfp_recommended_length</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00041">41</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01403">Crypto_HostKeys_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="netconn_8c_source.html#l01631">NetConn_ConnectionEstablished()</a>, <a class="el" href="netconn_8c_source.html#l03142">NetConn_ServerParsePacket()</a>, and <a class="el" href="sv__main_8c_source.html#l00926">SV_ConnectClient()</a>.</p>

</div>
</div>
<a id="a1310a98c3e1b982d484654a27f259671" name="a1310a98c3e1b982d484654a27f259671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1310a98c3e1b982d484654a27f259671">&#9670;&#160;</a></span>crypto_servercpu_accumulator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">double</a> crypto_servercpu_accumulator = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00036">36</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02036">Crypto_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a481f329d6a8171607db23fb324302b70" name="a481f329d6a8171607db23fb324302b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a481f329d6a8171607db23fb324302b70">&#9670;&#160;</a></span>crypto_servercpu_lastrealtime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">double</a> crypto_servercpu_lastrealtime = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00037">37</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02036">Crypto_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a90ed817e2c4e40c2d34af9d37e7edd64" name="a90ed817e2c4e40c2d34af9d37e7edd64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90ed817e2c4e40c2d34af9d37e7edd64">&#9670;&#160;</a></span>crypto_servercpudebug</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcvar__t.html">cvar_t</a> crypto_servercpudebug = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_servercpudebug&quot;, &quot;0&quot;, &quot;print <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">statistics</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">about</a> time <a class="el" href="glquake_8h.html#a32b0a8e61cbee081afd64f670a39d7cb">usage</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">by</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">crypto&quot;</a>}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00035">35</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>{<a class="code hl_define" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="code hl_define" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="code hl_define" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, <span class="stringliteral">&quot;crypto_servercpudebug&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>, <span class="stringliteral">&quot;print statistics about time usage by crypto&quot;</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, and <a class="el" href="crypto_8c_source.html#l02036">Crypto_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a802583bf599735ca3f90741d55954864" name="a802583bf599735ca3f90741d55954864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a802583bf599735ca3f90741d55954864">&#9670;&#160;</a></span>crypto_servercpumaxtime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcvar__t.html">cvar_t</a> crypto_servercpumaxtime = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_servercpumaxtime&quot;, &quot;0.01&quot;, &quot;maximum <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">allowed</a> crypto <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">CPU</a> time <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">per</a> frame (0 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">no</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">limit</a>)&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00034">34</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>{<a class="code hl_define" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="code hl_define" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="code hl_define" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, <span class="stringliteral">&quot;crypto_servercpumaxtime&quot;</span>, <span class="stringliteral">&quot;0.01&quot;</span>, <span class="stringliteral">&quot;maximum allowed crypto CPU time per frame (0 = no limit)&quot;</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, and <a class="el" href="crypto_8c_source.html#l02036">Crypto_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="a60a6b08ba933d05ae0ba07ba429fe03e" name="a60a6b08ba933d05ae0ba07ba429fe03e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60a6b08ba933d05ae0ba07ba429fe03e">&#9670;&#160;</a></span>crypto_servercpupercent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcvar__t.html">cvar_t</a> crypto_servercpupercent = {<a class="el" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="el" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="el" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, &quot;crypto_servercpupercent&quot;, &quot;10&quot;, &quot;allowed crypto <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">CPU</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">load</a> in percent <a class="el" href="shader__glsl_8h.html#a5b8048416847492c5588fff7fada734d">for</a> server <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">operation</a> (0 = <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">no</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">limit</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">faster</a>)&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00033">33</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>{<a class="code hl_define" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a> | <a class="code hl_define" href="cmd_8h.html#aadf0879ce7511e76eeea9da766b31c6b">CF_SERVER</a> | <a class="code hl_define" href="cmd_8h.html#aeeecb68995736ab90434173e64fd14e5">CF_ARCHIVE</a>, <span class="stringliteral">&quot;crypto_servercpupercent&quot;</span>, <span class="stringliteral">&quot;10&quot;</span>, <span class="stringliteral">&quot;allowed crypto CPU load in percent for server operation (0 = no limit, faster)&quot;</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, and <a class="el" href="crypto_8c_source.html#l02036">Crypto_ServerParsePacket()</a>.</p>

</div>
</div>
<a id="ab8a64f8aefe35f96d148557fb2e090db" name="ab8a64f8aefe35f96d148557fb2e090db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8a64f8aefe35f96d148557fb2e090db">&#9670;&#160;</a></span>crypto_storedhostkey_hashtable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcrypto__storedhostkey__t.html">crypto_storedhostkey_t</a>* crypto_storedhostkey_hashtable[<a class="el" href="qdefs_8h.html#a48e850626a1e9dd288fe4090c8619663">CRYPTO_HOSTKEY_HASHSIZE</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00589">589</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00613">Crypto_ClearHostKey()</a>, <a class="el" href="crypto_8c_source.html#l00598">Crypto_ClearHostKeys()</a>, <a class="el" href="crypto_8c_source.html#l01403">Crypto_HostKeys_f()</a>, <a class="el" href="crypto_8c_source.html#l00591">Crypto_InitHostKeys()</a>, <a class="el" href="crypto_8c_source.html#l00734">Crypto_RetrieveHostKey()</a>, and <a class="el" href="crypto_8c_source.html#l00635">Crypto_StoreHostKey()</a>.</p>

</div>
</div>
<a id="aa4630d2842fd947361b293e0102b7205" name="aa4630d2842fd947361b293e0102b7205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4630d2842fd947361b293e0102b7205">&#9670;&#160;</a></span>cryptoconnects</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structserver__cryptoconnect__t.html">server_cryptoconnect_t</a> cryptoconnects[<a class="el" href="crypto_8c.html#a0227d3cfd03cca7f1cb298e750152c61">MAX_CRYPTOCONNECTS</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00507">507</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00528">Crypto_ServerFindInstance()</a>, and <a class="el" href="crypto_8c_source.html#l01043">Crypto_Shutdown()</a>.</p>

</div>
</div>
<a id="a473d64350b7902deaac13e21f96f11d8" name="a473d64350b7902deaac13e21f96f11d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a473d64350b7902deaac13e21f96f11d8">&#9670;&#160;</a></span>cryptomempool</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmempool__t.html">mempool_t</a>* cryptomempool</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01004">1004</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01010">Crypto_d0_malloc()</a>, <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>, and <a class="el" href="crypto_8c_source.html#l01043">Crypto_Shutdown()</a>.</p>

</div>
</div>
<a id="a630ddbca1d559d1a461a73a5cf7851e0" name="a630ddbca1d559d1a461a73a5cf7851e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a630ddbca1d559d1a461a73a5cf7851e0">&#9670;&#160;</a></span>d0_blind_id_dll</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sys_8h.html#a6adb43a47c235f59ea1333f385eef73d">dllhandle_t</a> d0_blind_id_dll = <a class="el" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00282">282</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01097">Crypto_Available()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l00306">Crypto_CloseLibrary()</a>, <a class="el" href="crypto_8c_source.html#l01428">Crypto_HostKey_Clear_f()</a>, <a class="el" href="crypto_8c_source.html#l01403">Crypto_HostKeys_f()</a>, <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, <a class="el" href="crypto_8c_source.html#l01380">Crypto_Keys_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="crypto_8c_source.html#l00283">Crypto_OpenLibrary()</a>, <a class="el" href="crypto_8c_source.html#l00734">Crypto_RetrieveHostKey()</a>, <a class="el" href="crypto_8c_source.html#l01696">Crypto_ServerAppendToChallenge()</a>, <a class="el" href="crypto_8c_source.html#l00528">Crypto_ServerFindInstance()</a>, <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>, <a class="el" href="crypto_8c_source.html#l01043">Crypto_Shutdown()</a>, and <a class="el" href="crypto_8c_source.html#l00635">Crypto_StoreHostKey()</a>.</p>

</div>
</div>
<a id="a422626d9526190c4d1ab54321f94b463" name="a422626d9526190c4d1ab54321f94b463"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a422626d9526190c4d1ab54321f94b463">&#9670;&#160;</a></span>d0_blind_id_funcs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdllfunction__t.html">dllfunction_t</a> d0_blind_id_funcs[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00237">237</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  238</span>{</div>
<div class="line"><span class="lineno">  239</span>    {<span class="stringliteral">&quot;d0_blind_id_new&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a386a69f0199d722b7886d32cafe9d7dc">qd0_blind_id_new</a>},</div>
<div class="line"><span class="lineno">  240</span>    {<span class="stringliteral">&quot;d0_blind_id_free&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a6aa92bfaaf0609b72efa4ee010523361">qd0_blind_id_free</a>},</div>
<div class="line"><span class="lineno">  241</span>    <span class="comment">//{&quot;d0_blind_id_clear&quot;, (void **) &amp;qd0_blind_id_clear},</span></div>
<div class="line"><span class="lineno">  242</span>    {<span class="stringliteral">&quot;d0_blind_id_copy&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#acb17359f23753e70a2d100f311c83e9b">qd0_blind_id_copy</a>},</div>
<div class="line"><span class="lineno">  243</span>    <span class="comment">//{&quot;d0_blind_id_generate_private_key&quot;, (void **) &amp;qd0_blind_id_generate_private_key},</span></div>
<div class="line"><span class="lineno">  244</span>    <span class="comment">//{&quot;d0_blind_id_generate_private_key_fastreject&quot;, (void **) &amp;qd0_blind_id_generate_private_key_fastreject},</span></div>
<div class="line"><span class="lineno">  245</span>    <span class="comment">//{&quot;d0_blind_id_read_private_key&quot;, (void **) &amp;qd0_blind_id_read_private_key},</span></div>
<div class="line"><span class="lineno">  246</span>    {<span class="stringliteral">&quot;d0_blind_id_read_public_key&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a0b9d3969f89aaf222970ed72c2fd09ca">qd0_blind_id_read_public_key</a>},</div>
<div class="line"><span class="lineno">  247</span>    <span class="comment">//{&quot;d0_blind_id_write_private_key&quot;, (void **) &amp;qd0_blind_id_write_private_key},</span></div>
<div class="line"><span class="lineno">  248</span>    <span class="comment">//{&quot;d0_blind_id_write_public_key&quot;, (void **) &amp;qd0_blind_id_write_public_key},</span></div>
<div class="line"><span class="lineno">  249</span>    {<span class="stringliteral">&quot;d0_blind_id_fingerprint64_public_key&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a2f64f786d757a09a4e8c73edf953a466">qd0_blind_id_fingerprint64_public_key</a>},</div>
<div class="line"><span class="lineno">  250</span>    <span class="comment">//{&quot;d0_blind_id_generate_private_id_modulus&quot;, (void **) &amp;qd0_blind_id_generate_private_id_modulus},</span></div>
<div class="line"><span class="lineno">  251</span>    {<span class="stringliteral">&quot;d0_blind_id_read_private_id_modulus&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#aad8d6f9972282ff99b7ed54db5380368">qd0_blind_id_read_private_id_modulus</a>},</div>
<div class="line"><span class="lineno">  252</span>    <span class="comment">//{&quot;d0_blind_id_write_private_id_modulus&quot;, (void **) &amp;qd0_blind_id_write_private_id_modulus},</span></div>
<div class="line"><span class="lineno">  253</span>    {<span class="stringliteral">&quot;d0_blind_id_generate_private_id_start&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a879fdc43d8e4a297a1556f17504bf6e8">qd0_blind_id_generate_private_id_start</a>},</div>
<div class="line"><span class="lineno">  254</span>    {<span class="stringliteral">&quot;d0_blind_id_generate_private_id_request&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a1142ed9b4b3a54d428fd4b3a046fdccf">qd0_blind_id_generate_private_id_request</a>},</div>
<div class="line"><span class="lineno">  255</span>    <span class="comment">//{&quot;d0_blind_id_answer_private_id_request&quot;, (void **) &amp;qd0_blind_id_answer_private_id_request},</span></div>
<div class="line"><span class="lineno">  256</span>    {<span class="stringliteral">&quot;d0_blind_id_finish_private_id_request&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#ad3685a8b8407588f11204fab35bef81e">qd0_blind_id_finish_private_id_request</a>},</div>
<div class="line"><span class="lineno">  257</span>    <span class="comment">//{&quot;d0_blind_id_read_private_id_request_camouflage&quot;, (void **) &amp;qd0_blind_id_read_private_id_request_camouflage},</span></div>
<div class="line"><span class="lineno">  258</span>    <span class="comment">//{&quot;d0_blind_id_write_private_id_request_camouflage&quot;, (void **) &amp;qd0_blind_id_write_private_id_request_camouflage},</span></div>
<div class="line"><span class="lineno">  259</span>    {<span class="stringliteral">&quot;d0_blind_id_read_private_id&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a282255c5456bd132c907e62ff5e26846">qd0_blind_id_read_private_id</a>},</div>
<div class="line"><span class="lineno">  260</span>    <span class="comment">//{&quot;d0_blind_id_read_public_id&quot;, (void **) &amp;qd0_blind_id_read_public_id},</span></div>
<div class="line"><span class="lineno">  261</span>    {<span class="stringliteral">&quot;d0_blind_id_write_private_id&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a3e2a076dba69c5847aab34bf0bf54b54">qd0_blind_id_write_private_id</a>},</div>
<div class="line"><span class="lineno">  262</span>    <span class="comment">//{&quot;d0_blind_id_write_public_id&quot;, (void **) &amp;qd0_blind_id_write_public_id},</span></div>
<div class="line"><span class="lineno">  263</span>    {<span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_start&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#aa09cfb5d32dc22ee93c5f88bb883084e">qd0_blind_id_authenticate_with_private_id_start</a>},</div>
<div class="line"><span class="lineno">  264</span>    {<span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_challenge&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a238db7be954a2720b4646a56f416e7a5">qd0_blind_id_authenticate_with_private_id_challenge</a>},</div>
<div class="line"><span class="lineno">  265</span>    {<span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_response&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#aaf540674cda53b14bdd104f40759c386">qd0_blind_id_authenticate_with_private_id_response</a>},</div>
<div class="line"><span class="lineno">  266</span>    {<span class="stringliteral">&quot;d0_blind_id_authenticate_with_private_id_verify&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#af57a05bc9b21589d745930acee39eb78">qd0_blind_id_authenticate_with_private_id_verify</a>},</div>
<div class="line"><span class="lineno">  267</span>    {<span class="stringliteral">&quot;d0_blind_id_fingerprint64_public_id&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a9cb23abf4b1a78be4ffa5d5f8842faa0">qd0_blind_id_fingerprint64_public_id</a>},</div>
<div class="line"><span class="lineno">  268</span>    {<span class="stringliteral">&quot;d0_blind_id_sessionkey_public_id&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a4cbfb270eaaeb2f550ad978be861d129">qd0_blind_id_sessionkey_public_id</a>},</div>
<div class="line"><span class="lineno">  269</span>    {<span class="stringliteral">&quot;d0_blind_id_INITIALIZE&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a769580f1e63f2603aa90bb8986ac3ef3">qd0_blind_id_INITIALIZE</a>},</div>
<div class="line"><span class="lineno">  270</span>    {<span class="stringliteral">&quot;d0_blind_id_SHUTDOWN&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a71fc08325ecf3532fc19e05a46b2d295">qd0_blind_id_SHUTDOWN</a>},</div>
<div class="line"><span class="lineno">  271</span>    {<span class="stringliteral">&quot;d0_blind_id_util_sha256&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a62b44899185366951da0286b16f86f43">qd0_blind_id_util_sha256</a>},</div>
<div class="line"><span class="lineno">  272</span>    {<span class="stringliteral">&quot;d0_blind_id_sign_with_private_id_sign&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a053fe3ee2c82148ddb847da9f7e20f71">qd0_blind_id_sign_with_private_id_sign</a>},</div>
<div class="line"><span class="lineno">  273</span>    {<span class="stringliteral">&quot;d0_blind_id_sign_with_private_id_sign_detached&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#aa7ad86a0d8f95960c08726067fe9831e">qd0_blind_id_sign_with_private_id_sign_detached</a>},</div>
<div class="line"><span class="lineno">  274</span>    {<span class="stringliteral">&quot;d0_blind_id_setmallocfuncs&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a690b3fafb6357836766ea72705753a4f">qd0_blind_id_setmallocfuncs</a>},</div>
<div class="line"><span class="lineno">  275</span>    {<span class="stringliteral">&quot;d0_blind_id_setmutexfuncs&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#afed7aa781c8545c1333c525f437aa7fc">qd0_blind_id_setmutexfuncs</a>},</div>
<div class="line"><span class="lineno">  276</span>    {<span class="stringliteral">&quot;d0_blind_id_verify_public_id&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a099d4d32154ed82ff5431ab675945965">qd0_blind_id_verify_public_id</a>},</div>
<div class="line"><span class="lineno">  277</span>    {<span class="stringliteral">&quot;d0_blind_id_verify_private_id&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a5d43fdd72f73796e0dbd984eae9347f4">qd0_blind_id_verify_private_id</a>},</div>
<div class="line"><span class="lineno">  278</span>    {<a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>}</div>
<div class="line"><span class="lineno">  279</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00283">Crypto_OpenLibrary()</a>.</p>

</div>
</div>
<a id="ac8f343ad0620ecc82d3eb9a52c3ecfb6" name="ac8f343ad0620ecc82d3eb9a52c3ecfb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8f343ad0620ecc82d3eb9a52c3ecfb6">&#9670;&#160;</a></span>d0_rijndael_dll</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sys_8h.html#a6adb43a47c235f59ea1333f385eef73d">dllhandle_t</a> d0_rijndael_dll = <a class="el" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00351">351</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01449">Crypto_Init_Commands()</a>, <a class="el" href="crypto_8c_source.html#l00375">Crypto_Rijndael_CloseLibrary()</a>, <a class="el" href="crypto_8c_source.html#l00352">Crypto_Rijndael_OpenLibrary()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="aa1189ee7ea90350778e8fdbe7ee9a9d2" name="aa1189ee7ea90350778e8fdbe7ee9a9d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1189ee7ea90350778e8fdbe7ee9a9d2">&#9670;&#160;</a></span>d0_rijndael_funcs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdllfunction__t.html">dllfunction_t</a> d0_rijndael_funcs[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">{</div>
<div class="line">    {<span class="stringliteral">&quot;d0_rijndael_setup_decrypt&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a5a0fc4737467183933f83921685e1492">qd0_rijndael_setup_decrypt</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;d0_rijndael_setup_encrypt&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a43a2774cae8b42a7f02b79fe450bab4e">qd0_rijndael_setup_encrypt</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;d0_rijndael_decrypt&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#ac3c2380c084a6b13af5345dd3f3d1938">qd0_rijndael_decrypt</a>},</div>
<div class="line">    {<span class="stringliteral">&quot;d0_rijndael_encrypt&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a8fa7c805b800d7f78c68a7b925b318bc">qd0_rijndael_encrypt</a>},</div>
<div class="line">    {<a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>}</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00341">341</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  342</span>{</div>
<div class="line"><span class="lineno">  343</span>    {<span class="stringliteral">&quot;d0_rijndael_setup_decrypt&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a5a0fc4737467183933f83921685e1492">qd0_rijndael_setup_decrypt</a>},</div>
<div class="line"><span class="lineno">  344</span>    {<span class="stringliteral">&quot;d0_rijndael_setup_encrypt&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a43a2774cae8b42a7f02b79fe450bab4e">qd0_rijndael_setup_encrypt</a>},</div>
<div class="line"><span class="lineno">  345</span>    {<span class="stringliteral">&quot;d0_rijndael_decrypt&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#ac3c2380c084a6b13af5345dd3f3d1938">qd0_rijndael_decrypt</a>},</div>
<div class="line"><span class="lineno">  346</span>    {<span class="stringliteral">&quot;d0_rijndael_encrypt&quot;</span>, (<span class="keywordtype">void</span> **) &amp;<a class="code hl_variable" href="crypto_8c.html#a8fa7c805b800d7f78c68a7b925b318bc">qd0_rijndael_encrypt</a>},</div>
<div class="line"><span class="lineno">  347</span>    {<a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="qtypes_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>}</div>
<div class="line"><span class="lineno">  348</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00352">Crypto_Rijndael_OpenLibrary()</a>.</p>

</div>
</div>
<a id="acef24f9adaa96877f886d9e102044538" name="acef24f9adaa96877f886d9e102044538"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acef24f9adaa96877f886d9e102044538">&#9670;&#160;</a></span>keygen_buf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> keygen_buf[8192]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00491">491</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>.</p>

</div>
</div>
<a id="ae660e3db5e569c5c606531a62f889148" name="ae660e3db5e569c5c606531a62f889148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae660e3db5e569c5c606531a62f889148">&#9670;&#160;</a></span>keygen_i</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> keygen_i = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00490">490</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, and <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>.</p>

</div>
</div>
<a id="ae5918471d5570f5ecf0da17ecf0a253b" name="ae5918471d5570f5ecf0da17ecf0a253b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5918471d5570f5ecf0da17ecf0a253b">&#9670;&#160;</a></span>net_sourceaddresscheck</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcvar__t.html">cvar_t</a> net_sourceaddresscheck</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="netconn_8c_source.html#l00083">83</a> of file <a class="el" href="netconn_8c_source.html">netconn.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   83</span>{<a class="code hl_define" href="cmd_8h.html#abba64dce6a45541317c5508aa83436e5">CF_CLIENT</a>, <span class="stringliteral">&quot;net_sourceaddresscheck&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;compare the source IP address for replies (more secure, may break some bad multihoming setups&quot;</span>};</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="netconn_8c_source.html#l02002">NetConn_ClientParsePacket()</a>, and <a class="el" href="netconn_8c_source.html#l04039">NetConn_Init()</a>.</p>

</div>
</div>
<a id="ad209fec4c56eb4b0966702b7452bd7db" name="ad209fec4c56eb4b0966702b7452bd7db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad209fec4c56eb4b0966702b7452bd7db">&#9670;&#160;</a></span>pubkeys</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a>* pubkeys[<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00482">482</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00785">Crypto_BuildChallengeAppend()</a>, <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, <a class="el" href="crypto_8c_source.html#l01380">Crypto_Keys_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="crypto_8c_source.html#l00763">Crypto_RetrieveLocalKey()</a>, <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>, <a class="el" href="crypto_8c_source.html#l02634">Crypto_SignData()</a>, <a class="el" href="crypto_8c_source.html#l02645">Crypto_SignDataDetached()</a>, <a class="el" href="crypto_8c_source.html#l00635">Crypto_StoreHostKey()</a>, and <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>.</p>

</div>
</div>
<a id="aa88008abe3af1f6fb6c5596928082e4e" name="aa88008abe3af1f6fb6c5596928082e4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa88008abe3af1f6fb6c5596928082e4e">&#9670;&#160;</a></span>pubkeys_fp64</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> pubkeys_fp64[<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>][<a class="el" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00483">483</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00785">Crypto_BuildChallengeAppend()</a>, <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01403">Crypto_HostKeys_f()</a>, <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01380">Crypto_Keys_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="crypto_8c_source.html#l00734">Crypto_RetrieveHostKey()</a>, <a class="el" href="crypto_8c_source.html#l00763">Crypto_RetrieveLocalKey()</a>, <a class="el" href="crypto_8c_source.html#l00814">Crypto_SavePubKeyTextFile()</a>, <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>, <a class="el" href="crypto_8c_source.html#l00635">Crypto_StoreHostKey()</a>, and <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>.</p>

</div>
</div>
<a id="a97b4731bcda09762498f4c4ab8950eee" name="a97b4731bcda09762498f4c4ab8950eee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97b4731bcda09762498f4c4ab8950eee">&#9670;&#160;</a></span>pubkeys_havepriv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> pubkeys_havepriv[<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00484">484</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00785">Crypto_BuildChallengeAppend()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01380">Crypto_Keys_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="crypto_8c_source.html#l00763">Crypto_RetrieveLocalKey()</a>, <a class="el" href="crypto_8c_source.html#l00814">Crypto_SavePubKeyTextFile()</a>, <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>, <a class="el" href="crypto_8c_source.html#l02634">Crypto_SignData()</a>, <a class="el" href="crypto_8c_source.html#l02645">Crypto_SignDataDetached()</a>, and <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>.</p>

</div>
</div>
<a id="a95d40b2f3505629533c24fcfc912854c" name="a95d40b2f3505629533c24fcfc912854c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d40b2f3505629533c24fcfc912854c">&#9670;&#160;</a></span>pubkeys_havesig</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qtypes_8h.html#aa250998bce2dc350e4f644297bb579c3">qbool</a> pubkeys_havesig[<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00485">485</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, <a class="el" href="crypto_8c_source.html#l01380">Crypto_Keys_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="crypto_8c_source.html#l00763">Crypto_RetrieveLocalKey()</a>, <a class="el" href="crypto_8c_source.html#l00814">Crypto_SavePubKeyTextFile()</a>, <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>, and <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>.</p>

</div>
</div>
<a id="a48cd47ff384a225c07aae1505db8c269" name="a48cd47ff384a225c07aae1505db8c269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48cd47ff384a225c07aae1505db8c269">&#9670;&#160;</a></span>pubkeys_priv_fp64</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> pubkeys_priv_fp64[<a class="el" href="crypto_8c.html#a81517c37964da8773c8a85b39cbe62ef">MAX_PUBKEYS</a>][<a class="el" href="crypto_8h.html#a5b284ff4c80ff5aa9f0b4ee842a33d44">FP64_SIZE</a>+1]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00486">486</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00842">Crypto_BuildIdString()</a>, <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, <a class="el" href="crypto_8c_source.html#l01380">Crypto_Keys_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="crypto_8c_source.html#l00763">Crypto_RetrieveLocalKey()</a>, <a class="el" href="crypto_8c_source.html#l00814">Crypto_SavePubKeyTextFile()</a>, <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>, and <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>.</p>

</div>
</div>
<a id="a238db7be954a2720b4646a56f416e7a5" name="a238db7be954a2720b4646a56f416e7a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a238db7be954a2720b4646a56f416e7a5">&#9670;&#160;</a></span>qd0_blind_id_authenticate_with_private_id_challenge</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_authenticate_with_private_id_challenge) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">is_first</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">recv_modulus</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;</td>
          <td class="paramname"><em>is_first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;</td>
          <td class="paramname"><em>recv_modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>inbuflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00223">223</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="aaf540674cda53b14bdd104f40759c386" name="aaf540674cda53b14bdd104f40759c386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf540674cda53b14bdd104f40759c386">&#9670;&#160;</a></span>qd0_blind_id_authenticate_with_private_id_response</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_authenticate_with_private_id_response) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>inbuflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00224">224</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="aa09cfb5d32dc22ee93c5f88bb883084e" name="aa09cfb5d32dc22ee93c5f88bb883084e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa09cfb5d32dc22ee93c5f88bb883084e">&#9670;&#160;</a></span>qd0_blind_id_authenticate_with_private_id_start</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_authenticate_with_private_id_start) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">is_first</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">send_modulus</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *message, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msglen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;</td>
          <td class="paramname"><em>is_first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;</td>
          <td class="paramname"><em>send_modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>msglen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00222">222</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="af57a05bc9b21589d745930acee39eb78" name="af57a05bc9b21589d745930acee39eb78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af57a05bc9b21589d745930acee39eb78">&#9670;&#160;</a></span>qd0_blind_id_authenticate_with_private_id_verify</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_authenticate_with_private_id_verify) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *msg, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msglen</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>inbuflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>msglen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00225">225</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="acb17359f23753e70a2d100f311c83e9b" name="acb17359f23753e70a2d100f311c83e9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb17359f23753e70a2d100f311c83e9b">&#9670;&#160;</a></span>qd0_blind_id_copy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_copy) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *src) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00201">201</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="a9cb23abf4b1a78be4ffa5d5f8842faa0" name="a9cb23abf4b1a78be4ffa5d5f8842faa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cb23abf4b1a78be4ffa5d5f8842faa0">&#9670;&#160;</a></span>qd0_blind_id_fingerprint64_public_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_fingerprint64_public_id) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00226">226</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="a2f64f786d757a09a4e8c73edf953a466" name="a2f64f786d757a09a4e8c73edf953a466"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f64f786d757a09a4e8c73edf953a466">&#9670;&#160;</a></span>qd0_blind_id_fingerprint64_public_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_fingerprint64_public_key) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00208">208</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="ad3685a8b8407588f11204fab35bef81e" name="ad3685a8b8407588f11204fab35bef81e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3685a8b8407588f11204fab35bef81e">&#9670;&#160;</a></span>qd0_blind_id_finish_private_id_request</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_finish_private_id_request) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>inbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00215">215</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>.</p>

</div>
</div>
<a id="a6aa92bfaaf0609b72efa4ee010523361" name="a6aa92bfaaf0609b72efa4ee010523361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aa92bfaaf0609b72efa4ee010523361">&#9670;&#160;</a></span>qd0_blind_id_free</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(* qd0_blind_id_free) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="shader__glsl_8h.html#ada7daae51ef1e670767c18b83ea78044">a</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00199">199</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>, <a class="el" href="crypto_8c_source.html#l00450">Crypto_ReadPublicKey()</a>, and <a class="el" href="crypto_8c_source.html#l00985">Crypto_UnloadKeys()</a>.</p>

</div>
</div>
<a id="a1142ed9b4b3a54d428fd4b3a046fdccf" name="a1142ed9b4b3a54d428fd4b3a046fdccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1142ed9b4b3a54d428fd4b3a046fdccf">&#9670;&#160;</a></span>qd0_blind_id_generate_private_id_request</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_generate_private_id_request) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00213">213</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>.</p>

</div>
</div>
<a id="a879fdc43d8e4a297a1556f17504bf6e8" name="a879fdc43d8e4a297a1556f17504bf6e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a879fdc43d8e4a297a1556f17504bf6e8">&#9670;&#160;</a></span>qd0_blind_id_generate_private_id_start</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_generate_private_id_start) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00212">212</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>.</p>

</div>
</div>
<a id="a769580f1e63f2603aa90bb8986ac3ef3" name="a769580f1e63f2603aa90bb8986ac3ef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a769580f1e63f2603aa90bb8986ac3ef3">&#9670;&#160;</a></span>qd0_blind_id_INITIALIZE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_INITIALIZE) (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00228">228</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="a386a69f0199d722b7886d32cafe9d7dc" name="a386a69f0199d722b7886d32cafe9d7dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a386a69f0199d722b7886d32cafe9d7dc">&#9670;&#160;</a></span>qd0_blind_id_new</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *(* qd0_blind_id_new) (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00198">198</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, <a class="el" href="crypto_8c_source.html#l00450">Crypto_ReadPublicKey()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="a282255c5456bd132c907e62ff5e26846" name="a282255c5456bd132c907e62ff5e26846"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a282255c5456bd132c907e62ff5e26846">&#9670;&#160;</a></span>qd0_blind_id_read_private_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_read_private_id) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>inbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00218">218</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00469">Crypto_AddPrivateKey()</a>.</p>

</div>
</div>
<a id="aad8d6f9972282ff99b7ed54db5380368" name="aad8d6f9972282ff99b7ed54db5380368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad8d6f9972282ff99b7ed54db5380368">&#9670;&#160;</a></span>qd0_blind_id_read_private_id_modulus</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_read_private_id_modulus) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>inbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00210">210</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00450">Crypto_ReadPublicKey()</a>.</p>

</div>
</div>
<a id="a0b9d3969f89aaf222970ed72c2fd09ca" name="a0b9d3969f89aaf222970ed72c2fd09ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b9d3969f89aaf222970ed72c2fd09ca">&#9670;&#160;</a></span>qd0_blind_id_read_public_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_read_public_key) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">inbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>inbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>inbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00205">205</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00450">Crypto_ReadPublicKey()</a>.</p>

</div>
</div>
<a id="a4cbfb270eaaeb2f550ad978be861d129" name="a4cbfb270eaaeb2f550ad978be861d129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cbfb270eaaeb2f550ad978be861d129">&#9670;&#160;</a></span>qd0_blind_id_sessionkey_public_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_sessionkey_public_id) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00227">227</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02107">Crypto_ClientParsePacket()</a>, and <a class="el" href="crypto_8c_source.html#l01727">Crypto_ServerParsePacket_Internal()</a>.</p>

</div>
</div>
<a id="a690b3fafb6357836766ea72705753a4f" name="a690b3fafb6357836766ea72705753a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a690b3fafb6357836766ea72705753a4f">&#9670;&#160;</a></span>qd0_blind_id_setmallocfuncs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(* qd0_blind_id_setmallocfuncs) (<a class="el" href="crypto_8c.html#abb3ae89a45f60de77f1dd02d6c2a5328">d0_malloc_t</a> *m, <a class="el" href="crypto_8c.html#a2efe40262b15742cbcd54501782639e5">d0_free_t</a> *<a class="el" href="shader__glsl_8h.html#a731feb93da8dc28ee53e37b43daabd06">f</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#abb3ae89a45f60de77f1dd02d6c2a5328">d0_malloc_t</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2efe40262b15742cbcd54501782639e5">d0_free_t</a> *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00233">233</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="afed7aa781c8545c1333c525f437aa7fc" name="afed7aa781c8545c1333c525f437aa7fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afed7aa781c8545c1333c525f437aa7fc">&#9670;&#160;</a></span>qd0_blind_id_setmutexfuncs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(* qd0_blind_id_setmutexfuncs) (<a class="el" href="crypto_8c.html#a15bf368c6c65ee2efeb72b13e8390298">d0_createmutex_t</a> *c, <a class="el" href="crypto_8c.html#a17c84d33e1ae7fabefa009ded492313f">d0_destroymutex_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">d</a>, <a class="el" href="crypto_8c.html#a03c8d295a5d00c9b704eeaf9cdc2c554">d0_lockmutex_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">l</a>, <a class="el" href="crypto_8c.html#abd63a13cc35cc9a1f783b8d383342c00">d0_unlockmutex_t</a> *u) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a15bf368c6c65ee2efeb72b13e8390298">d0_createmutex_t</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a17c84d33e1ae7fabefa009ded492313f">d0_destroymutex_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a03c8d295a5d00c9b704eeaf9cdc2c554">d0_lockmutex_t</a> *&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#abd63a13cc35cc9a1f783b8d383342c00">d0_unlockmutex_t</a> *&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00234">234</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01072">Crypto_Init()</a>.</p>

</div>
</div>
<a id="a71fc08325ecf3532fc19e05a46b2d295" name="a71fc08325ecf3532fc19e05a46b2d295"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71fc08325ecf3532fc19e05a46b2d295">&#9670;&#160;</a></span>qd0_blind_id_SHUTDOWN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(* qd0_blind_id_SHUTDOWN) (<a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00229">229</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01043">Crypto_Shutdown()</a>.</p>

</div>
</div>
<a id="a053fe3ee2c82148ddb847da9f7e20f71" name="a053fe3ee2c82148ddb847da9f7e20f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a053fe3ee2c82148ddb847da9f7e20f71">&#9670;&#160;</a></span>qd0_blind_id_sign_with_private_id_sign</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_sign_with_private_id_sign) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">is_first</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">send_modulus</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *message, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msglen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;</td>
          <td class="paramname"><em>is_first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;</td>
          <td class="paramname"><em>send_modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>msglen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00231">231</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02634">Crypto_SignData()</a>.</p>

</div>
</div>
<a id="aa7ad86a0d8f95960c08726067fe9831e" name="aa7ad86a0d8f95960c08726067fe9831e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7ad86a0d8f95960c08726067fe9831e">&#9670;&#160;</a></span>qd0_blind_id_sign_with_private_id_sign_detached</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_sign_with_private_id_sign_detached) (<a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">is_first</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">send_modulus</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *message, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">msglen</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;</td>
          <td class="paramname"><em>is_first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>&#160;</td>
          <td class="paramname"><em>send_modulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>msglen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00232">232</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l02645">Crypto_SignDataDetached()</a>.</p>

</div>
</div>
<a id="a62b44899185366951da0286b16f86f43" name="a62b44899185366951da0286b16f86f43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b44899185366951da0286b16f86f43">&#9670;&#160;</a></span>qd0_blind_id_util_sha256</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(* qd0_blind_id_util_sha256) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">out</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *in, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> <a class="el" href="fractalnoise_8c.html#a86fdeed0593c5e3b95d1f2447350ca96">n</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a>&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00230">230</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00383">sha256()</a>.</p>

</div>
</div>
<a id="a5d43fdd72f73796e0dbd984eae9347f4" name="a5d43fdd72f73796e0dbd984eae9347f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d43fdd72f73796e0dbd984eae9347f4">&#9670;&#160;</a></span>qd0_blind_id_verify_private_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_verify_private_id) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00236">236</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, and <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="a099d4d32154ed82ff5431ab675945965" name="a099d4d32154ed82ff5431ab675945965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a099d4d32154ed82ff5431ab675945965">&#9670;&#160;</a></span>qd0_blind_id_verify_public_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_verify_public_id) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">status</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a> *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00235">235</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>, and <a class="el" href="crypto_8c_source.html#l00855">Crypto_LoadKeys()</a>.</p>

</div>
</div>
<a id="a3e2a076dba69c5847aab34bf0bf54b54" name="a3e2a076dba69c5847aab34bf0bf54b54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e2a076dba69c5847aab34bf0bf54b54">&#9670;&#160;</a></span>qd0_blind_id_write_private_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="crypto_8c.html#a0621e91f6f7f0e31c054018cffff852e">D0_WARN_UNUSED_RESULT</a> <a class="el" href="crypto_8c.html#a2cc28a754edbe5c9184d04bb4a6ad76a">D0_BOOL</a>(* qd0_blind_id_write_private_id) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ctx</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuf</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">outbuflen</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="crypto_8c.html#ab4e48fcb3e2bb84bb6d537bcdf564935">d0_blind_id_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">size_t</a> *&#160;</td>
          <td class="paramname"><em>outbuflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00220">220</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01217">Crypto_KeyGen_f()</a>, and <a class="el" href="crypto_8c_source.html#l01105">Crypto_KeyGen_Finished()</a>.</p>

</div>
</div>
<a id="ac3c2380c084a6b13af5345dd3f3d1938" name="ac3c2380c084a6b13af5345dd3f3d1938"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3c2380c084a6b13af5345dd3f3d1938">&#9670;&#160;</a></span>qd0_rijndael_decrypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(* qd0_rijndael_decrypt) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nrounds</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ciphertext</a>[16], <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">plaintext</a>[16]) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *&#160;</td>
          <td class="paramname"><em>rk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>nrounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td>
          <td class="paramname"><em>ciphertext</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td>
          <td class="paramname"><em>plaintext</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00336">336</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01498">seacpy()</a>.</p>

</div>
</div>
<a id="a8fa7c805b800d7f78c68a7b925b318bc" name="a8fa7c805b800d7f78c68a7b925b318bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fa7c805b800d7f78c68a7b925b318bc">&#9670;&#160;</a></span>qd0_rijndael_encrypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="glquake_8h.html#afa45fc0640b31002c1792c59eb062c59">void</a>(* qd0_rijndael_encrypt) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">nrounds</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">plaintext</a>[16], <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">ciphertext</a>[16]) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *&#160;</td>
          <td class="paramname"><em>rk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>nrounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td>
          <td class="paramname"><em>plaintext</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a>&#160;</td>
          <td class="paramname"><em>ciphertext</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00334">334</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01472">aescpy()</a>.</p>

</div>
</div>
<a id="a5a0fc4737467183933f83921685e1492" name="a5a0fc4737467183933f83921685e1492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a0fc4737467183933f83921685e1492">&#9670;&#160;</a></span>qd0_rijndael_setup_decrypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>(* qd0_rijndael_setup_decrypt) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *key, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *&#160;</td>
          <td class="paramname"><em>rk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>keybits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00332">332</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01498">seacpy()</a>.</p>

</div>
</div>
<a id="a43a2774cae8b42a7f02b79fe450bab4e" name="a43a2774cae8b42a7f02b79fe450bab4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43a2774cae8b42a7f02b79fe450bab4e">&#9670;&#160;</a></span>qd0_rijndael_setup_encrypt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8c.html#a60d4582b2e05d234358e37f6357d26bd">D0_EXPORT</a> <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>(* qd0_rijndael_setup_encrypt) (<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *<a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">rk</a>, <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *key, <a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">keybits</a>) </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">long</a> *&#160;</td>
          <td class="paramname"><em>rk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">const</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">unsigned</a> <a class="el" href="glquake_8h.html#af7ca775b6d9354291c4d7d01b8b2a8bc">char</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fs_8c.html#a93257bedba32e45fc3f07bea139c0604">int</a>&#160;</td>
          <td class="paramname"><em>keybits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00330">330</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01472">aescpy()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="crypto_8c.html">crypto.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
